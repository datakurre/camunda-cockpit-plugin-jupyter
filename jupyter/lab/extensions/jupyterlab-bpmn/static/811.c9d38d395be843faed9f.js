"use strict";(self.webpackChunkjupyterlab_bpmn=self.webpackChunkjupyterlab_bpmn||[]).push([[811],{720:(e,t,n)=>{n.d(t,{Z:()=>Fe});var i,o=n(717),r=n.n(o),a=n(670),c=n(858),s=n(517),u=n(635),l=n(252),p=n(230),h=n(312),d=n(674),f=n(487),m=n(168),v=(function(e){var t=e.exports=function(e,n){if(n||(n=16),void 0===e&&(e=128),e<=0)return"0";for(var i=Math.log(Math.pow(2,e))/Math.log(n),o=2;i===1/0;o*=2)i=Math.log(Math.pow(2,e/o))/Math.log(n)*o;var r=i-Math.floor(i),a="";for(o=0;o<Math.floor(i);o++)a=Math.floor(Math.random()*n).toString(n)+a;if(r){var c=Math.pow(n,r);a=Math.floor(Math.random()*c).toString(n)+a}var s=parseInt(a,n);return s!==1/0&&s>=Math.pow(2,e)?t(e,n):a};t.rack=function(e,n,i){var o=function(o){var a=0;do{if(a++>10){if(!i)throw new Error("too many ID collisions, use more bits");e+=i}var c=t(e,n)}while(Object.hasOwnProperty.call(r,c));return r[c]=o,c},r=o.hats={};return o.get=function(e){return o.hats[e]},o.set=function(e,t){return o.hats[e]=t,o},o.bits=e||128,o.base=n||16,o}}(i={exports:{}}),i.exports);function y(e){if(!(this instanceof y))return new y(e);e=e||[128,36,1],this._seed=e.length?v.rack(e[0],e[1],e[2]):e}y.prototype.next=function(e){return this._seed(e||!0)},y.prototype.nextPrefixed=function(e,t){var n;do{n=e+this.next(!0)}while(this.assigned(n));return this.claim(n,t),n},y.prototype.claim=function(e,t){this._seed.set(e,t||!0)},y.prototype.assigned=function(e){return this._seed.get(e)||!1},y.prototype.unclaim=function(e){delete this._seed.hats[e]},y.prototype.clear=function(){var e,t=this._seed.hats;for(e in t)this.unclaim(e)};var g=new y,x=.95;function b(e,t,n,i,o,r,l){c.Z.call(this,t,l);var v=e&&e.defaultFillColor,y=e&&e.defaultStrokeColor,b=e&&e.defaultLabelColor,E=g.next(),w={},_=n.computeStyle;function S(e,t){var n=(0,a.f0)({fill:"black",strokeWidth:1,strokeLinecap:"round",strokeDasharray:"none"},t.attrs),i=t.ref||{x:0,y:0},r=t.scale||1;"none"===n.strokeDasharray&&(n.strokeDasharray=[1e4,1]);var c=(0,f.Ue)("marker");(0,f.Lj)(t.element,n),(0,f.R3)(c,t.element),(0,f.Lj)(c,{id:e,viewBox:"0 0 20 20",refX:i.x,refY:i.y,markerWidth:20*r,markerHeight:20*r,orient:"auto"});var s=(0,d.IO)("defs",o._svg);s||(s=(0,f.Ue)("defs"),(0,f.R3)(o._svg,s)),(0,f.R3)(s,c),w[e]=c}function k(e){return e.replace(/[^0-9a-zA-z]+/g,"_")}function R(e,t,n){var i=e+"-"+k(t)+"-"+k(n)+"-"+E;return w[i]||function(e,t,n,i){if("sequenceflow-end"===t){var o=(0,f.Ue)("path");(0,f.Lj)(o,{d:"M 1 5 L 11 10 L 1 15 Z"}),S(e,{element:o,ref:{x:11,y:10},scale:.5,attrs:{fill:i,stroke:i}})}if("messageflow-start"===t){var r=(0,f.Ue)("circle");(0,f.Lj)(r,{cx:6,cy:6,r:3.5}),S(e,{element:r,attrs:{fill:n,stroke:i},ref:{x:6,y:6}})}if("messageflow-end"===t){var a=(0,f.Ue)("path");(0,f.Lj)(a,{d:"m 1 5 l 0 -3 l 7 3 l -7 3 z"}),S(e,{element:a,attrs:{fill:n,stroke:i,strokeLinecap:"butt"},ref:{x:8.5,y:5}})}if("association-start"===t){var c=(0,f.Ue)("path");(0,f.Lj)(c,{d:"M 11 5 L 1 10 L 11 15"}),S(e,{element:c,attrs:{fill:"none",stroke:i,strokeWidth:1.5},ref:{x:1,y:10},scale:.5})}if("association-end"===t){var s=(0,f.Ue)("path");(0,f.Lj)(s,{d:"M 1 5 L 11 10 L 1 15"}),S(e,{element:s,attrs:{fill:"none",stroke:i,strokeWidth:1.5},ref:{x:12,y:10},scale:.5})}if("conditional-flow-marker"===t){var u=(0,f.Ue)("path");(0,f.Lj)(u,{d:"M 0 10 L 8 6 L 16 10 L 8 14 Z"}),S(e,{element:u,attrs:{fill:n,stroke:i},ref:{x:-1,y:10},scale:.5})}if("conditional-default-flow-marker"===t){var l=(0,f.Ue)("path");(0,f.Lj)(l,{d:"M 6 4 L 10 16"}),S(e,{element:l,attrs:{stroke:i},ref:{x:0,y:10},scale:.5})}}(i,e,t,n),"url(#"+i+")"}function j(e,t,n,i,o){(0,a.Kn)(i)&&(o=i,i=0),i=i||0,"none"===(o=_(o,{stroke:"black",strokeWidth:2,fill:"white"})).fill&&delete o.fillOpacity;var r=t/2,c=n/2,s=(0,f.Ue)("circle");return(0,f.Lj)(s,{cx:r,cy:c,r:Math.round((t+n)/4-i)}),(0,f.Lj)(s,o),(0,f.R3)(e,s),s}function P(e,t,n,i,o,r){(0,a.Kn)(o)&&(r=o,o=0),o=o||0,r=_(r,{stroke:"black",strokeWidth:2,fill:"white"});var c=(0,f.Ue)("rect");return(0,f.Lj)(c,{x:o,y:o,width:t-2*o,height:n-2*o,rx:i,ry:i}),(0,f.Lj)(c,r),(0,f.R3)(e,c),c}function M(e,t,n){n=_(n,["no-fill"],{stroke:"black",strokeWidth:2,fill:"none"});var i=(0,p.W5)(t,n);return(0,f.R3)(e,i),i}function B(e,t,n){n=_(n,["no-fill"],{strokeWidth:2,stroke:"black"});var i=(0,f.Ue)("path");return(0,f.Lj)(i,{d:t}),(0,f.Lj)(i,n),(0,f.R3)(e,i),i}function T(e,t,n,i){return B(t,n,(0,a.f0)({"data-marker":e},i))}function D(e){return function(t,n){return F[e](t,n)}}function C(e){return F[e]}function A(e,t){var n=(0,h.nr)(e),i=(0,h.gT)(n);return n.eventDefinitions&&n.eventDefinitions.length>1?n.parallelMultiple?C("bpmn:ParallelMultipleEventDefinition")(t,e,i):C("bpmn:MultipleEventDefinition")(t,e,i):(0,h.iY)(n,"bpmn:MessageEventDefinition")?C("bpmn:MessageEventDefinition")(t,e,i):(0,h.iY)(n,"bpmn:TimerEventDefinition")?C("bpmn:TimerEventDefinition")(t,e,i):(0,h.iY)(n,"bpmn:ConditionalEventDefinition")?C("bpmn:ConditionalEventDefinition")(t,e):(0,h.iY)(n,"bpmn:SignalEventDefinition")?C("bpmn:SignalEventDefinition")(t,e,i):(0,h.iY)(n,"bpmn:EscalationEventDefinition")?C("bpmn:EscalationEventDefinition")(t,e,i):(0,h.iY)(n,"bpmn:LinkEventDefinition")?C("bpmn:LinkEventDefinition")(t,e,i):(0,h.iY)(n,"bpmn:ErrorEventDefinition")?C("bpmn:ErrorEventDefinition")(t,e,i):(0,h.iY)(n,"bpmn:CancelEventDefinition")?C("bpmn:CancelEventDefinition")(t,e,i):(0,h.iY)(n,"bpmn:CompensateEventDefinition")?C("bpmn:CompensateEventDefinition")(t,e,i):(0,h.iY)(n,"bpmn:TerminateEventDefinition")?C("bpmn:TerminateEventDefinition")(t,e,i):null}function O(e,t,n){n=(0,a.f0)({size:{width:100}},n);var i=r.createText(t||"",n);return(0,f.Sh)(i).add("djs-label"),(0,f.R3)(e,i),i}function L(e,t,n){return O(e,(0,h.nr)(t).name,{box:t,align:n,padding:5,style:{fill:(0,h.Ou)(t,b,y)}})}function $(e,t,n){var i=O(e,t,{box:{height:30,width:n.height},align:"center-middle",style:{fill:(0,h.Ou)(n,b,y)}}),o=-1*n.height;(0,m.vs)(i,0,-o,270)}function I(e){for(var t=e.waypoints,n="m  "+t[0].x+","+t[0].y,i=1;i<t.length;i++)n+="L"+t[i].x+","+t[i].y+" ";return n}var F=this.handlers={"bpmn:Event":function(e,t,n){return"fillOpacity"in n||(n.fillOpacity=x),j(e,t.width,t.height,n)},"bpmn:StartEvent":function(e,t){var n={fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)};(0,h.nr)(t).isInterrupting||(n={strokeDasharray:"6",strokeLinecap:"round",fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)});var i=C("bpmn:Event")(e,t,n);return A(t,e),i},"bpmn:MessageEventDefinition":function(e,t,n){return B(e,i.getScaledPath("EVENT_MESSAGE",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:t.width,containerHeight:t.height,position:{mx:.235,my:.315}}),{strokeWidth:1,fill:n?(0,h.$Z)(t,y):(0,h.W7)(t,v),stroke:n?(0,h.W7)(t,v):(0,h.$Z)(t,y)})},"bpmn:TimerEventDefinition":function(e,t){var n=j(e,t.width,t.height,.2*t.height,{strokeWidth:2,fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)});B(e,i.getScaledPath("EVENT_TIMER_WH",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.5}}),{strokeWidth:2,strokeLinecap:"square",stroke:(0,h.$Z)(t,y)});for(var o=0;o<12;o++){var r=i.getScaledPath("EVENT_TIMER_LINE",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.5}}),a=t.width/2;B(e,r,{strokeWidth:1,strokeLinecap:"square",transform:"rotate("+30*o+","+t.height/2+","+a+")",stroke:(0,h.$Z)(t,y)})}return n},"bpmn:EscalationEventDefinition":function(e,t,n){return B(e,i.getScaledPath("EVENT_ESCALATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.2}}),{strokeWidth:1,fill:n?(0,h.$Z)(t,y):"none",stroke:(0,h.$Z)(t,y)})},"bpmn:ConditionalEventDefinition":function(e,t){return B(e,i.getScaledPath("EVENT_CONDITIONAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.222}}),{strokeWidth:1,stroke:(0,h.$Z)(t,y)})},"bpmn:LinkEventDefinition":function(e,t,n){return B(e,i.getScaledPath("EVENT_LINK",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.57,my:.263}}),{strokeWidth:1,fill:n?(0,h.$Z)(t,y):"none",stroke:(0,h.$Z)(t,y)})},"bpmn:ErrorEventDefinition":function(e,t,n){return B(e,i.getScaledPath("EVENT_ERROR",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:t.width,containerHeight:t.height,position:{mx:.2,my:.722}}),{strokeWidth:1,fill:n?(0,h.$Z)(t,y):"none",stroke:(0,h.$Z)(t,y)})},"bpmn:CancelEventDefinition":function(e,t,n){var o=B(e,i.getScaledPath("EVENT_CANCEL_45",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.638,my:-.055}}),{strokeWidth:1,fill:n?(0,h.$Z)(t,y):"none",stroke:(0,h.$Z)(t,y)});return(0,m.U1)(o,45),o},"bpmn:CompensateEventDefinition":function(e,t,n){return B(e,i.getScaledPath("EVENT_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.22,my:.5}}),{strokeWidth:1,fill:n?(0,h.$Z)(t,y):"none",stroke:(0,h.$Z)(t,y)})},"bpmn:SignalEventDefinition":function(e,t,n){return B(e,i.getScaledPath("EVENT_SIGNAL",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.2}}),{strokeWidth:1,fill:n?(0,h.$Z)(t,y):"none",stroke:(0,h.$Z)(t,y)})},"bpmn:MultipleEventDefinition":function(e,t,n){return B(e,i.getScaledPath("EVENT_MULTIPLE",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:t.width,containerHeight:t.height,position:{mx:.222,my:.36}}),{strokeWidth:1,fill:n?(0,h.$Z)(t,y):"none"})},"bpmn:ParallelMultipleEventDefinition":function(e,t){return B(e,i.getScaledPath("EVENT_PARALLEL_MULTIPLE",{xScaleFactor:1.2,yScaleFactor:1.2,containerWidth:t.width,containerHeight:t.height,position:{mx:.458,my:.194}}),{strokeWidth:1,fill:(0,h.$Z)(t,y),stroke:(0,h.$Z)(t,y)})},"bpmn:EndEvent":function(e,t){var n=C("bpmn:Event")(e,t,{strokeWidth:4,fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)});return A(t,e),n},"bpmn:TerminateEventDefinition":function(e,t){return j(e,t.width,t.height,8,{strokeWidth:4,fill:(0,h.$Z)(t,y),stroke:(0,h.$Z)(t,y)})},"bpmn:IntermediateEvent":function(e,t){var n=C("bpmn:Event")(e,t,{strokeWidth:1,fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)});return j(e,t.width,t.height,3,{strokeWidth:1,fill:(0,h.W7)(t,"none"),stroke:(0,h.$Z)(t,y)}),A(t,e),n},"bpmn:IntermediateCatchEvent":D("bpmn:IntermediateEvent"),"bpmn:IntermediateThrowEvent":D("bpmn:IntermediateEvent"),"bpmn:Activity":function(e,t,n){return"fillOpacity"in(n=n||{})||(n.fillOpacity=x),P(e,t.width,t.height,10,n)},"bpmn:Task":function(e,t){var n={fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)},i=C("bpmn:Activity")(e,t,n);return L(e,t,"center-middle"),W(e,t),i},"bpmn:ServiceTask":function(e,t){var n=C("bpmn:Task")(e,t);return B(e,i.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:12,y:18}}),{strokeWidth:1,fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)}),B(e,i.getScaledPath("TASK_TYPE_SERVICE_FILL",{abspos:{x:17.2,y:18}}),{strokeWidth:0,fill:(0,h.W7)(t,v)}),B(e,i.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:17,y:22}}),{strokeWidth:1,fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)}),n},"bpmn:UserTask":function(e,t){var n=C("bpmn:Task")(e,t);return B(e,i.getScaledPath("TASK_TYPE_USER_1",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)}),B(e,i.getScaledPath("TASK_TYPE_USER_2",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)}),B(e,i.getScaledPath("TASK_TYPE_USER_3",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:(0,h.$Z)(t,y),stroke:(0,h.$Z)(t,y)}),n},"bpmn:ManualTask":function(e,t){var n=C("bpmn:Task")(e,t);return B(e,i.getScaledPath("TASK_TYPE_MANUAL",{abspos:{x:17,y:15}}),{strokeWidth:.5,fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)}),n},"bpmn:SendTask":function(e,t){var n=C("bpmn:Task")(e,t);return B(e,i.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:1,yScaleFactor:1,containerWidth:21,containerHeight:14,position:{mx:.285,my:.357}}),{strokeWidth:1,fill:(0,h.$Z)(t,y),stroke:(0,h.W7)(t,v)}),n},"bpmn:ReceiveTask":function(e,t){var n,o=(0,h.nr)(t),r=C("bpmn:Task")(e,t);return o.instantiate?(j(e,28,28,4.4,{strokeWidth:1}),n=i.getScaledPath("TASK_TYPE_INSTANTIATING_SEND",{abspos:{x:7.77,y:9.52}})):n=i.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:21,containerHeight:14,position:{mx:.3,my:.4}}),B(e,n,{strokeWidth:1,fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)}),r},"bpmn:ScriptTask":function(e,t){var n=C("bpmn:Task")(e,t);return B(e,i.getScaledPath("TASK_TYPE_SCRIPT",{abspos:{x:15,y:20}}),{strokeWidth:1,stroke:(0,h.$Z)(t,y)}),n},"bpmn:BusinessRuleTask":function(e,t){var n=C("bpmn:Task")(e,t),o=B(e,i.getScaledPath("TASK_TYPE_BUSINESS_RULE_HEADER",{abspos:{x:8,y:8}}));(0,f.Lj)(o,{strokeWidth:1,fill:(0,h.W7)(t,"#aaaaaa"),stroke:(0,h.$Z)(t,y)});var r=B(e,i.getScaledPath("TASK_TYPE_BUSINESS_RULE_MAIN",{abspos:{x:8,y:8}}));return(0,f.Lj)(r,{strokeWidth:1,stroke:(0,h.$Z)(t,y)}),n},"bpmn:SubProcess":function(e,t,n){n=(0,a.f0)({fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)},n);var i=C("bpmn:Activity")(e,t,n),o=(0,s.ul)(t);return(0,s.J5)(t)&&(0,f.Lj)(i,{strokeDasharray:"1,2"}),L(e,t,o?"center-top":"center-middle"),o?W(e,t):W(e,t,["SubProcessMarker"]),i},"bpmn:AdHocSubProcess":function(e,t){return C("bpmn:SubProcess")(e,t)},"bpmn:Transaction":function(e,t){var i=C("bpmn:SubProcess")(e,t),o=n.style(["no-fill","no-events"],{stroke:(0,h.$Z)(t,y)});return P(e,t.width,t.height,8,3,o),i},"bpmn:CallActivity":function(e,t){return C("bpmn:SubProcess")(e,t,{strokeWidth:5})},"bpmn:Participant":function(e,t){var n={fillOpacity:x,fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)},i=C("bpmn:Lane")(e,t,n);return(0,s.ul)(t)?(M(e,[{x:30,y:0},{x:30,y:t.height}],{stroke:(0,h.$Z)(t,y)}),$(e,(0,h.nr)(t).name,t)):O(e,(0,h.nr)(t).name,{box:t,align:"center-middle",style:{fill:(0,h.Ou)(t,b,y)}}),!!(0,h.nr)(t).participantMultiplicity&&C("ParticipantMultiplicityMarker")(e,t),i},"bpmn:Lane":function(e,t,n){var i=P(e,t.width,t.height,0,(0,a.f0)({fill:(0,h.W7)(t,v),fillOpacity:.35,stroke:(0,h.$Z)(t,y)},n)),o=(0,h.nr)(t);return"bpmn:Lane"===o.$type&&$(e,o.name,t),i},"bpmn:InclusiveGateway":function(e,t){var n=C("bpmn:Gateway")(e,t);return j(e,t.width,t.height,.24*t.height,{strokeWidth:2.5,fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)}),n},"bpmn:ExclusiveGateway":function(e,t){var n=C("bpmn:Gateway")(e,t),o=i.getScaledPath("GATEWAY_EXCLUSIVE",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:t.width,containerHeight:t.height,position:{mx:.32,my:.3}});return(0,h.DN)(t).isMarkerVisible&&B(e,o,{strokeWidth:1,fill:(0,h.$Z)(t,y),stroke:(0,h.$Z)(t,y)}),n},"bpmn:ComplexGateway":function(e,t){var n=C("bpmn:Gateway")(e,t);return B(e,i.getScaledPath("GATEWAY_COMPLEX",{xScaleFactor:.5,yScaleFactor:.5,containerWidth:t.width,containerHeight:t.height,position:{mx:.46,my:.26}}),{strokeWidth:1,fill:(0,h.$Z)(t,y),stroke:(0,h.$Z)(t,y)}),n},"bpmn:ParallelGateway":function(e,t){var n=C("bpmn:Gateway")(e,t);return B(e,i.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.6,yScaleFactor:.6,containerWidth:t.width,containerHeight:t.height,position:{mx:.46,my:.2}}),{strokeWidth:1,fill:(0,h.$Z)(t,y),stroke:(0,h.$Z)(t,y)}),n},"bpmn:EventBasedGateway":function(e,t){var n=(0,h.nr)(t),o=C("bpmn:Gateway")(e,t);j(e,t.width,t.height,.2*t.height,{strokeWidth:1,fill:"none",stroke:(0,h.$Z)(t,y)});var r=n.eventGatewayType,a=!!n.instantiate;if("Parallel"===r){var c=i.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:t.width,containerHeight:t.height,position:{mx:.474,my:.296}}),s=B(e,c);(0,f.Lj)(s,{strokeWidth:1,fill:"none"})}else if("Exclusive"===r){if(!a){var u=j(e,t.width,t.height,.26*t.height);(0,f.Lj)(u,{strokeWidth:1,fill:"none",stroke:(0,h.$Z)(t,y)})}!function(){var n=i.getScaledPath("GATEWAY_EVENT_BASED",{xScaleFactor:.18,yScaleFactor:.18,containerWidth:t.width,containerHeight:t.height,position:{mx:.36,my:.44}}),o={strokeWidth:2,fill:(0,h.W7)(t,"none"),stroke:(0,h.$Z)(t,y)};B(e,n,o)}()}return o},"bpmn:Gateway":function(e,t){var n={fill:(0,h.W7)(t,v),fillOpacity:x,stroke:(0,h.$Z)(t,y)};return function(e,t,n,i){var o=t/2,r=n/2,a=[{x:o,y:0},{x:t,y:r},{x:o,y:n},{x:0,y:r}].map((function(e){return e.x+","+e.y})).join(" ");i=_(i,{stroke:"black",strokeWidth:2,fill:"white"});var c=(0,f.Ue)("polygon");return(0,f.Lj)(c,{points:a}),(0,f.Lj)(c,i),(0,f.R3)(e,c),c}(e,t.width,t.height,n)},"bpmn:SequenceFlow":function(e,t){var n,i=I(t),o=(0,h.W7)(t,v),r=(0,h.$Z)(t,y),a=B(e,i,{strokeLinejoin:"round",markerEnd:R("sequenceflow-end",o,r),stroke:(0,h.$Z)(t,y)}),c=(0,h.nr)(t);return t.source&&(n=t.source.businessObject,c.conditionExpression&&n.$instanceOf("bpmn:Activity")&&(0,f.Lj)(a,{markerStart:R("conditional-flow-marker",o,r)}),n.default&&(n.$instanceOf("bpmn:Gateway")||n.$instanceOf("bpmn:Activity"))&&n.default===c&&(0,f.Lj)(a,{markerStart:R("conditional-default-flow-marker",o,r)})),a},"bpmn:Association":function(e,t,n){var i=(0,h.nr)(t),o=(0,h.W7)(t,v),r=(0,h.$Z)(t,y);return n=(0,a.f0)({strokeDasharray:"0.5, 5",strokeLinecap:"round",strokeLinejoin:"round",stroke:(0,h.$Z)(t,y)},n||{}),"One"!==i.associationDirection&&"Both"!==i.associationDirection||(n.markerEnd=R("association-end",o,r)),"Both"===i.associationDirection&&(n.markerStart=R("association-start",o,r)),M(e,t.waypoints,n)},"bpmn:DataInputAssociation":function(e,t){var n=(0,h.W7)(t,v),i=(0,h.$Z)(t,y);return C("bpmn:Association")(e,t,{markerEnd:R("association-end",n,i)})},"bpmn:DataOutputAssociation":function(e,t){var n=(0,h.W7)(t,v),i=(0,h.$Z)(t,y);return C("bpmn:Association")(e,t,{markerEnd:R("association-end",n,i)})},"bpmn:MessageFlow":function(e,t){var n=(0,h.nr)(t),o=(0,h.DN)(t),r=(0,h.W7)(t,v),a=(0,h.$Z)(t,y),c=B(e,I(t),{markerEnd:R("messageflow-end",r,a),markerStart:R("messageflow-start",r,a),strokeDasharray:"10, 12",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5px",stroke:(0,h.$Z)(t,y)});if(n.messageRef){var s=c.getPointAtLength(c.getTotalLength()/2),u=i.getScaledPath("MESSAGE_FLOW_MARKER",{abspos:{x:s.x,y:s.y}}),l={strokeWidth:1};"initiating"===o.messageVisibleKind?(l.fill="white",l.stroke="black"):(l.fill="#888",l.stroke="white");var p=B(e,u,l),d=O(e,n.messageRef.name,{align:"center-top",fitBox:!0,style:{fill:(0,h.$Z)(t,b,y)}}),f=p.getBBox(),g=d.getBBox(),x=s.x-g.width/2,E=s.y+f.height/2+10;(0,m.vs)(d,x,E,0)}return c},"bpmn:DataObject":function(e,t){var n=B(e,i.getScaledPath("DATA_OBJECT_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.474,my:.296}}),{fill:(0,h.W7)(t,v),fillOpacity:x,stroke:(0,h.$Z)(t,y)}),o=(0,h.nr)(t);return(0,h.uZ)(o)&&function(e,t){var n=(t.height-18)/t.height;B(e,i.getScaledPath("DATA_OBJECT_COLLECTION_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.33,my:n}}),{strokeWidth:2})}(e,t),n},"bpmn:DataObjectReference":D("bpmn:DataObject"),"bpmn:DataInput":function(e,t){var n=i.getRawPath("DATA_ARROW"),o=C("bpmn:DataObject")(e,t);return B(e,n,{strokeWidth:1}),o},"bpmn:DataOutput":function(e,t){var n=i.getRawPath("DATA_ARROW"),o=C("bpmn:DataObject")(e,t);return B(e,n,{strokeWidth:1,fill:"black"}),o},"bpmn:DataStoreReference":function(e,t){return B(e,i.getScaledPath("DATA_STORE",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:0,my:.133}}),{strokeWidth:2,fill:(0,h.W7)(t,v),fillOpacity:x,stroke:(0,h.$Z)(t,y)})},"bpmn:BoundaryEvent":function(e,t){var n=(0,h.nr)(t).cancelActivity,i={strokeWidth:1,fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)};n||(i.strokeDasharray="6",i.strokeLinecap="round");var o=(0,a.f0)({},i,{fillOpacity:1}),r=(0,a.f0)({},i,{fill:"none"}),c=C("bpmn:Event")(e,t,o);return j(e,t.width,t.height,3,r),A(t,e),c},"bpmn:Group":function(e,t){return P(e,t.width,t.height,10,{stroke:(0,h.$Z)(t,y),strokeWidth:1,strokeDasharray:"8,3,1,3",fill:"none",pointerEvents:"none"})},label:function(e,t){return function(e,t){var n={width:90,height:30,x:t.width/2+t.x,y:t.height/2+t.y};return O(e,(0,u.i)(t),{box:n,fitBox:!0,style:(0,a.f0)({},r.getExternalStyle(),{fill:(0,h.Ou)(t,b,y)})})}(e,t)},"bpmn:TextAnnotation":function(e,t){var n=P(e,t.width,t.height,0,0,{fill:"none",stroke:"none"});return B(e,i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:0,my:0}}),{stroke:(0,h.$Z)(t,y)}),O(e,(0,h.nr)(t).text||"",{box:t,align:"left-top",padding:5,style:{fill:(0,h.Ou)(t,b,y)}}),n},ParticipantMultiplicityMarker:function(e,t){T("participant-multiplicity",e,i.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:t.width/2/t.width,my:(t.height-15)/t.height}}),{strokeWidth:2,fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)})},SubProcessMarker:function(e,t){var n=P(e,14,14,0,{strokeWidth:1,fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)});(0,m.Iu)(n,t.width/2-7.5,t.height-20),T("sub-process",e,i.getScaledPath("MARKER_SUB_PROCESS",{xScaleFactor:1.5,yScaleFactor:1.5,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2-7.5)/t.width,my:(t.height-20)/t.height}}),{fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)})},ParallelMarker:function(e,t,n){T("parallel",e,i.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+n.parallel)/t.width,my:(t.height-20)/t.height}}),{fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)})},SequentialMarker:function(e,t,n){T("sequential",e,i.getScaledPath("MARKER_SEQUENTIAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+n.seq)/t.width,my:(t.height-19)/t.height}}),{fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)})},CompensationMarker:function(e,t,n){T("compensation",e,i.getScaledPath("MARKER_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+n.compensation)/t.width,my:(t.height-13)/t.height}}),{strokeWidth:1,fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y)})},LoopMarker:function(e,t,n){T("loop",e,i.getScaledPath("MARKER_LOOP",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+n.loop)/t.width,my:(t.height-7)/t.height}}),{strokeWidth:1,fill:(0,h.W7)(t,v),stroke:(0,h.$Z)(t,y),strokeLinecap:"round",strokeMiterlimit:.5})},AdhocMarker:function(e,t,n){T("adhoc",e,i.getScaledPath("MARKER_ADHOC",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+n.adhoc)/t.width,my:(t.height-15)/t.height}}),{strokeWidth:1,fill:(0,h.$Z)(t,y),stroke:(0,h.$Z)(t,y)})}};function W(e,t,n){var i,o=(0,h.nr)(t),r=n&&-1!==n.indexOf("SubProcessMarker");i=r?{seq:-21,parallel:-22,compensation:-42,loop:-18,adhoc:10}:{seq:-3,parallel:-6,compensation:-27,loop:0,adhoc:10},(0,a.Ed)(n,(function(n){C(n)(e,t,i)})),o.isForCompensation&&C("CompensationMarker")(e,t,i),"bpmn:AdHocSubProcess"===o.$type&&C("AdhocMarker")(e,t,i);var c=o.loopCharacteristics,s=c&&c.isSequential;c&&(void 0===s&&C("LoopMarker")(e,t,i),!1===s&&C("ParallelMarker")(e,t,i),!0===s&&C("SequentialMarker")(e,t,i))}this._drawPath=B}r()(b,c.Z),b.$inject=["config.bpmnRenderer","eventBus","styles","pathMap","canvas","textRenderer"],b.prototype.canRender=function(e){return(0,l.is)(e,"bpmn:BaseElement")},b.prototype.drawShape=function(e,t){var n=t.type;return(0,this.handlers[n])(e,t)},b.prototype.drawConnection=function(e,t){var n=t.type;return(0,this.handlers[n])(e,t)},b.prototype.getShapePath=function(e){return(0,l.is)(e,"bpmn:Event")?(0,h.iu)(e):(0,l.is)(e,"bpmn:Activity")?(0,h.H)(e,10):(0,l.is)(e,"bpmn:Gateway")?(0,h.j3)(e):(0,h.lr)(e)};var E={width:150,height:50};function w(e,t){var n;t.textContent=e;try{var i,o=""===e;return t.textContent=o?"dummy":e,i={width:(n=t.getBBox()).width+2*n.x,height:n.height},o&&(i.width=0),i}catch(e){return{width:0,height:0}}}function _(e,t,n){for(var i,o=e.shift(),r=o;;){if((i=w(r,n)).width=r?i.width:0," "===r||""===r||i.width<Math.round(t)||r.length<2)return S(e,r,o,i);r=k(r,i.width,t)}}function S(e,t,n,i){if(t.length<n.length){var o=n.slice(t.length).trim();e.unshift(o)}return{width:i.width,height:i.height,text:t}}function k(e,t,n){var i=Math.max(e.length*(n/t),1),o=function(e,t){var n,i=e.split(/(\s|-|\u00AD)/g),o=[],r=0;if(i.length>1)for(;n=i.shift();){if(!(n.length+r<t)){"-"!==n&&"­"!==n||o.pop();break}o.push(n),r+=n.length}var a=o[o.length-1];return a&&"­"===a&&(o[o.length-1]="-"),o.join("")}(e,i);return o||(o=e.slice(0,Math.max(Math.round(i-1),1))),o}function R(e){this._config=(0,a.f0)({},{size:E,padding:0,style:{},align:"center-top"},e||{})}function j(e){var t=(0,a.f0)({fontFamily:"Arial, sans-serif",fontSize:12,fontWeight:"normal",lineHeight:1.2},e&&e.defaultStyle||{}),n=parseInt(t.fontSize,10)-1,i=(0,a.f0)({},t,{fontSize:n},e&&e.externalStyle||{}),o=new R({style:t});this.getExternalLabelBounds=function(e,t){var n=o.getDimensions(t,{box:{width:90,height:30,x:e.width/2+e.x,y:e.height/2+e.y},style:i});return{x:Math.round(e.x+e.width/2-n.width/2),y:Math.round(e.y),width:Math.ceil(n.width),height:Math.ceil(n.height)}},this.getTextAnnotationBounds=function(e,n){var i=o.getDimensions(n,{box:e,style:t,align:"left-top",padding:5});return{x:e.x,y:e.y,width:e.width,height:Math.max(30,Math.round(i.height))}},this.createText=function(e,t){return o.createText(e,t||{})},this.getDefaultStyle=function(){return t},this.getExternalStyle=function(){return i}}R.prototype.createText=function(e,t){return this.layoutText(e,t).element},R.prototype.getDimensions=function(e,t){return this.layoutText(e,t).dimensions},R.prototype.layoutText=function(e,t){var n=(0,a.f0)({},this._config.size,t.box),i=(0,a.f0)({},this._config.style,t.style),o=function(e){var t=e.split("-");return{horizontal:t[0]||"center",vertical:t[1]||"top"}}(t.align||this._config.align),r=function(e){return(0,a.Kn)(e)?(0,a.f0)({top:0,left:0,right:0,bottom:0},e):{top:e,left:e,right:e,bottom:e}}(void 0!==t.padding?t.padding:this._config.padding),c=t.fitBox||!1,s=function(e){if("fontSize"in e&&"lineHeight"in e)return e.lineHeight*parseInt(e.fontSize,10)}(i),u=e.split(/\u00AD?\r?\n/),l=[],p=n.width-r.left-r.right,h=(0,f.Ue)("text");(0,f.Lj)(h,{x:0,y:0}),(0,f.Lj)(h,i);var d=function(){var e=document.getElementById("helper-svg");return e||(e=(0,f.Ue)("svg"),(0,f.Lj)(e,{id:"helper-svg",width:0,height:0,style:"visibility: hidden; position: fixed"}),document.body.appendChild(e)),e}();for((0,f.R3)(d,h);u.length;)l.push(_(u,p,h));"middle"===o.vertical&&(r.top=r.bottom=0);var m=(0,a.u4)(l,(function(e,t,n){return e+(s||t.height)}),0)+r.top+r.bottom,v=(0,a.u4)(l,(function(e,t,n){return t.width>e?t.width:e}),0),y=r.top;"middle"===o.vertical&&(y+=(n.height-m)/2),y-=(s||l[0].height)/4;var g=(0,f.Ue)("text");return(0,f.Lj)(g,i),(0,a.Ed)(l,(function(e){var t;switch(y+=s||e.height,o.horizontal){case"left":t=r.left;break;case"right":t=(c?v:p)-r.right-e.width;break;default:t=Math.max(((c?v:p)-e.width)/2+r.left,0)}var n=(0,f.Ue)("tspan");(0,f.Lj)(n,{x:t,y}),n.textContent=e.text,(0,f.R3)(g,n)})),(0,f.Od)(h),{dimensions:{width:v,height:m},element:g}},j.$inject=["config.textRenderer"];var P=/\{([^}]+)\}/g,M=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;const B={__init__:["bpmnRenderer"],bpmnRenderer:["type",b],textRenderer:["type",j],pathMap:["type",function(){this.pathMap={EVENT_MESSAGE:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:36,width:36,heightElements:[6,14],widthElements:[10.5,21]},EVENT_SIGNAL:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x1},0 Z",height:36,width:36,heightElements:[18],widthElements:[10,20]},EVENT_ESCALATION:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x0},-{e.y1} l -{e.x0},{e.y1} Z",height:36,width:36,heightElements:[20,7],widthElements:[8]},EVENT_CONDITIONAL:{d:"M {e.x0},{e.y0} l {e.x1},0 l 0,{e.y2} l -{e.x1},0 Z M {e.x2},{e.y3} l {e.x0},0 M {e.x2},{e.y4} l {e.x0},0 M {e.x2},{e.y5} l {e.x0},0 M {e.x2},{e.y6} l {e.x0},0 M {e.x2},{e.y7} l {e.x0},0 M {e.x2},{e.y8} l {e.x0},0 ",height:36,width:36,heightElements:[8.5,14.5,18,11.5,14.5,17.5,20.5,23.5,26.5],widthElements:[10.5,14.5,12.5]},EVENT_LINK:{d:"m {mx},{my} 0,{e.y0} -{e.x1},0 0,{e.y1} {e.x1},0 0,{e.y0} {e.x0},-{e.y2} -{e.x0},-{e.y2} z",height:36,width:36,heightElements:[4.4375,6.75,7.8125],widthElements:[9.84375,13.5]},EVENT_ERROR:{d:"m {mx},{my} {e.x0},-{e.y0} {e.x1},-{e.y1} {e.x2},{e.y2} {e.x3},-{e.y3} -{e.x4},{e.y4} -{e.x5},-{e.y5} z",height:36,width:36,heightElements:[.023,8.737,8.151,16.564,10.591,8.714],widthElements:[.085,6.672,6.97,4.273,5.337,6.636]},EVENT_CANCEL_45:{d:"m {mx},{my} -{e.x1},0 0,{e.x0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:36,width:36,heightElements:[4.75,8.5],widthElements:[4.75,8.5]},EVENT_COMPENSATION:{d:"m {mx},{my} {e.x0},-{e.y0} 0,{e.y1} z m {e.x1},-{e.y2} {e.x2},-{e.y3} 0,{e.y1} -{e.x2},-{e.y3} z",height:36,width:36,heightElements:[6.5,13,.4,6.1],widthElements:[9,9.3,8.7]},EVENT_TIMER_WH:{d:"M {mx},{my} l {e.x0},-{e.y0} m -{e.x0},{e.y0} l {e.x1},{e.y1} ",height:36,width:36,heightElements:[10,2],widthElements:[3,7]},EVENT_TIMER_LINE:{d:"M {mx},{my} m {e.x0},{e.y0} l -{e.x1},{e.y1} ",height:36,width:36,heightElements:[10,3],widthElements:[0,0]},EVENT_MULTIPLE:{d:"m {mx},{my} {e.x1},-{e.y0} {e.x1},{e.y0} -{e.x0},{e.y1} -{e.x2},0 z",height:36,width:36,heightElements:[6.28099,12.56199],widthElements:[3.1405,9.42149,12.56198]},EVENT_PARALLEL_MULTIPLE:{d:"m {mx},{my} {e.x0},0 0,{e.y1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} -{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z",height:36,width:36,heightElements:[2.56228,7.68683],widthElements:[2.56228,7.68683]},GATEWAY_EXCLUSIVE:{d:"m {mx},{my} {e.x0},{e.y0} {e.x1},{e.y0} {e.x2},0 {e.x4},{e.y2} {e.x4},{e.y1} {e.x2},0 {e.x1},{e.y3} {e.x0},{e.y3} {e.x3},0 {e.x5},{e.y1} {e.x5},{e.y2} {e.x3},0 z",height:17.5,width:17.5,heightElements:[8.5,6.5312,-6.5312,-8.5],widthElements:[6.5,-6.5,3,-3,5,-5]},GATEWAY_PARALLEL:{d:"m {mx},{my} 0,{e.y1} -{e.x1},0 0,{e.y0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:30,width:30,heightElements:[5,12.5],widthElements:[5,12.5]},GATEWAY_EVENT_BASED:{d:"m {mx},{my} {e.x0},{e.y0} {e.x0},{e.y1} {e.x1},{e.y2} {e.x2},0 z",height:11,width:11,heightElements:[-6,6,12,-12],widthElements:[9,-3,-12]},GATEWAY_COMPLEX:{d:"m {mx},{my} 0,{e.y0} -{e.x0},-{e.y1} -{e.x1},{e.y2} {e.x0},{e.y1} -{e.x2},0 0,{e.y3} {e.x2},0  -{e.x0},{e.y1} l {e.x1},{e.y2} {e.x0},-{e.y1} 0,{e.y0} {e.x3},0 0,-{e.y0} {e.x0},{e.y1} {e.x1},-{e.y2} -{e.x0},-{e.y1} {e.x2},0 0,-{e.y3} -{e.x2},0 {e.x0},-{e.y1} -{e.x1},-{e.y2} -{e.x0},{e.y1} 0,-{e.y0} -{e.x3},0 z",height:17.125,width:17.125,heightElements:[4.875,3.4375,2.125,3],widthElements:[3.4375,2.125,4.875,3]},DATA_OBJECT_PATH:{d:"m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0",height:61,width:51,heightElements:[10,50,60],widthElements:[10,40,50,60]},DATA_OBJECT_COLLECTION_PATH:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},DATA_ARROW:{d:"m 5,9 9,0 0,-3 5,5 -5,5 0,-3 -9,0 z",height:61,width:51,heightElements:[],widthElements:[]},DATA_STORE:{d:"m  {mx},{my} l  0,{e.y2} c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 l  0,-{e.y2} c -{e.x0},-{e.y1} -{e.x1},-{e.y1} -{e.x2},0c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1} {e.x2},0m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0",height:61,width:61,heightElements:[7,10,45],widthElements:[2,58,60]},TEXT_ANNOTATION:{d:"m {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0",height:30,width:10,heightElements:[30],widthElements:[10]},MARKER_SUB_PROCESS:{d:"m{mx},{my} m 7,2 l 0,10 m -5,-5 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_PARALLEL:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},MARKER_SEQUENTIAL:{d:"m{mx},{my} m 0,3 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_COMPENSATION:{d:"m {mx},{my} 7,-5 0,10 z m 7.1,-0.3 6.9,-4.7 0,10 -6.9,-4.7 z",height:10,width:21,heightElements:[],widthElements:[]},MARKER_LOOP:{d:"m {mx},{my} c 3.526979,0 6.386161,-2.829858 6.386161,-6.320661 0,-3.490806 -2.859182,-6.320661 -6.386161,-6.320661 -3.526978,0 -6.38616,2.829855 -6.38616,6.320661 0,1.745402 0.714797,3.325567 1.870463,4.469381 0.577834,0.571908 1.265885,1.034728 2.029916,1.35457 l -0.718163,-3.909793 m 0.718163,3.909793 -3.885211,0.802902",height:13.9,width:13.7,heightElements:[],widthElements:[]},MARKER_ADHOC:{d:"m {mx},{my} m 0.84461,2.64411 c 1.05533,-1.23780996 2.64337,-2.07882 4.29653,-1.97997996 2.05163,0.0805 3.85579,1.15803 5.76082,1.79107 1.06385,0.34139996 2.24454,0.1438 3.18759,-0.43767 0.61743,-0.33642 1.2775,-0.64078 1.7542,-1.17511 0,0.56023 0,1.12046 0,1.6807 -0.98706,0.96237996 -2.29792,1.62393996 -3.6918,1.66181996 -1.24459,0.0927 -2.46671,-0.2491 -3.59505,-0.74812 -1.35789,-0.55965 -2.75133,-1.33436996 -4.27027,-1.18121996 -1.37741,0.14601 -2.41842,1.13685996 -3.44288,1.96782996 z",height:4,width:15,heightElements:[],widthElements:[]},TASK_TYPE_SEND:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:14,width:21,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_SCRIPT:{d:"m {mx},{my} c 9.966553,-6.27276 -8.000926,-7.91932 2.968968,-14.938 l -8.802728,0 c -10.969894,7.01868 6.997585,8.66524 -2.968967,14.938 z m -7,-12 l 5,0 m -4.5,3 l 4.5,0 m -3,3 l 5,0m -4,3 l 5,0",height:15,width:12.6,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_USER_1:{d:"m {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 -4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 zm -8,6 l 0,5.5 m 11,0 l 0,-5"},TASK_TYPE_USER_2:{d:"m {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 -2.66499998,0 -4.822,-1.981 -4.822,-4.4310005 "},TASK_TYPE_USER_3:{d:"m {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 -4.20799998,3.36699999 -4.20699998,4.34799999 z"},TASK_TYPE_MANUAL:{d:"m {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 -0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 -1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 -10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 -0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 -1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 -0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 -5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z"},TASK_TYPE_INSTANTIATING_SEND:{d:"m {mx},{my} l 0,8.4 l 12.6,0 l 0,-8.4 z l 6.3,3.6 l 6.3,-3.6"},TASK_TYPE_SERVICE:{d:"m {mx},{my} v -1.71335 c 0.352326,-0.0705 0.703932,-0.17838 1.047628,-0.32133 0.344416,-0.14465 0.665822,-0.32133 0.966377,-0.52145 l 1.19431,1.18005 1.567487,-1.57688 -1.195028,-1.18014 c 0.403376,-0.61394 0.683079,-1.29908 0.825447,-2.01824 l 1.622133,-0.01 v -2.2196 l -1.636514,0.01 c -0.07333,-0.35153 -0.178319,-0.70024 -0.323564,-1.04372 -0.145244,-0.34406 -0.321407,-0.6644 -0.522735,-0.96217 l 1.131035,-1.13631 -1.583305,-1.56293 -1.129598,1.13589 c -0.614052,-0.40108 -1.302883,-0.68093 -2.022633,-0.82247 l 0.0093,-1.61852 h -2.241173 l 0.0042,1.63124 c -0.353763,0.0736 -0.705369,0.17977 -1.049785,0.32371 -0.344415,0.14437 -0.665102,0.32092 -0.9635006,0.52046 l -1.1698628,-1.15823 -1.5667691,1.5792 1.1684265,1.15669 c -0.4026573,0.61283 -0.68308,1.29797 -0.8247287,2.01713 l -1.6588041,0.003 v 2.22174 l 1.6724648,-0.006 c 0.073327,0.35077 0.1797598,0.70243 0.3242851,1.04472 0.1452428,0.34448 0.3214064,0.6644 0.5227339,0.96066 l -1.1993431,1.19723 1.5840256,1.56011 1.1964668,-1.19348 c 0.6140517,0.40346 1.3028827,0.68232 2.0233517,0.82331 l 7.19e-4,1.69892 h 2.226848 z m 0.221462,-3.9957 c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_SERVICE_FILL:{d:"m {mx},{my} c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_BUSINESS_RULE_HEADER:{d:"m {mx},{my} 0,4 20,0 0,-4 z"},TASK_TYPE_BUSINESS_RULE_MAIN:{d:"m {mx},{my} 0,12 20,0 0,-12 zm 0,8 l 20,0 m -13,-4 l 0,8"},MESSAGE_FLOW_MARKER:{d:"m {mx},{my} m -10.5 ,-7 l 0,14 l 21,0 l 0,-14 z l 10.5,6 l 10.5,-6"}},this.getRawPath=function(e){return this.pathMap[e].d},this.getScaledPath=function(e,t){var n,i,o=this.pathMap[e];t.abspos?(n=t.abspos.x,i=t.abspos.y):(n=t.containerWidth*t.position.mx,i=t.containerHeight*t.position.my);var r,a,c={};if(t.position){for(var s=t.containerHeight/o.height*t.yScaleFactor,u=t.containerWidth/o.width*t.xScaleFactor,l=0;l<o.heightElements.length;l++)c["y"+l]=o.heightElements[l]*s;for(var p=0;p<o.widthElements.length;p++)c["x"+p]=o.widthElements[p]*u}return r=o.d,a={mx:n,my:i,e:c},String(r).replace(P,(function(e,t){return function(e,t,n){var i=n;return t.replace(M,(function(e,t,n,o,r){t=t||o,i&&(t in i&&(i=i[t]),"function"==typeof i&&r&&(i=i()))})),i=(null==i||i==n?e:i)+""}(e,t,a)}))}}]};var T=n(805),D=n(507),C=n(935);function A(e){return e?"<"+e.$type+(e.id?' id="'+e.id:"")+'" />':"<null>"}function O(e,t){return(0,a.f0)({id:e.id,type:e.$type,businessObject:e},t)}function L(e,t,n){var i=e.di.waypoint;return!i||i.length<2?[(0,C.wS)(t),(0,C.wS)(n)]:i.map((function(e){return{x:e.x,y:e.y}}))}function $(e,t,n,i){return new Error(e("element {element} referenced by {referenced}#{property} not yet drawn",{element:A(n),referenced:A(t),property:i}))}function I(e,t,n,i,o,r){this._eventBus=e,this._canvas=t,this._elementFactory=n,this._elementRegistry=i,this._translate=o,this._textRenderer=r}I.$inject=["eventBus","canvas","elementFactory","elementRegistry","translate","textRenderer"],I.prototype.add=function(e,t){var n,i,o,r,a,c,p,h=e.di,d=this._translate;if((0,l.is)(h,"bpmndi:BPMNPlane"))n=this._elementFactory.createRoot(O(e)),this._canvas.setRootElement(n);else if((0,l.is)(h,"bpmndi:BPMNShape")){var f=!(0,s.ul)(e),m=function(e){return(0,l.is)(e,"bpmn:Group")}(e);i=t&&(t.hidden||t.collapsed);var v=e.di.bounds;n=this._elementFactory.createShape(O(e,{collapsed:f,hidden:i,x:Math.round(v.x),y:Math.round(v.y),width:Math.round(v.width),height:Math.round(v.height),isFrame:m})),(0,l.is)(e,"bpmn:BoundaryEvent")&&this._attachBoundary(e,n),(0,l.is)(e,"bpmn:Lane")&&(o=0),(0,l.is)(e,"bpmn:DataStoreReference")&&(r=t,c=(a=(0,C.wS)(v)).x,p=a.y,c>=r.x&&c<=r.x+r.width&&p>=r.y&&p<=r.y+r.height||(t=this._canvas.getRootElement())),this._canvas.addShape(n,t,o)}else{if(!(0,l.is)(h,"bpmndi:BPMNEdge"))throw new Error(d("unknown di {di} for element {semantic}",{di:A(h),semantic:A(e)}));var y=this._getSource(e),g=this._getTarget(e);i=t&&(t.hidden||t.collapsed),n=this._elementFactory.createConnection(O(e,{hidden:i,source:y,target:g,waypoints:L(e,y,g)})),(0,l.is)(e,"bpmn:DataAssociation")&&(t=null),(0,l.is)(e,"bpmn:SequenceFlow")&&(o=0),this._canvas.addConnection(n,t,o)}return(0,D.ly)(e)&&(0,u.i)(n)&&this.addLabel(e,n),this._eventBus.fire("bpmnElement.added",{element:n}),n},I.prototype._attachBoundary=function(e,t){var n=this._translate,i=e.attachedToRef;if(!i)throw new Error(n("missing {semantic}#attachedToRef",{semantic:A(e)}));var o=this._elementRegistry.get(i.id),r=o&&o.attachers;if(!o)throw $(n,e,i,"attachedToRef");t.host=o,r||(o.attachers=r=[]),-1===r.indexOf(t)&&r.push(t)},I.prototype.addLabel=function(e,t){var n,i,o;return n=(0,D.lq)(e,t),(i=(0,u.i)(t))&&(n=this._textRenderer.getExternalLabelBounds(n,i)),o=this._elementFactory.createLabel(O(e,{id:e.id+"_label",labelTarget:t,type:"label",hidden:t.hidden||!(0,u.i)(t),x:Math.round(n.x),y:Math.round(n.y),width:Math.round(n.width),height:Math.round(n.height)})),this._canvas.addShape(o,t.parent)},I.prototype._getEnd=function(e,t){var n,i,o=e.$type,r=this._translate;if(i=e[t+"Ref"],"source"===t&&"bpmn:DataInputAssociation"===o&&(i=i&&i[0]),("source"===t&&"bpmn:DataOutputAssociation"===o||"target"===t&&"bpmn:DataInputAssociation"===o)&&(i=e.$parent),n=i&&this._getElement(i))return n;throw i?$(r,e,i,t+"Ref"):new Error(r("{semantic}#{side} Ref not specified",{semantic:A(e),side:t}))},I.prototype._getSource=function(e){return this._getEnd(e,"source")},I.prototype._getTarget=function(e){return this._getEnd(e,"target")},I.prototype._getElement=function(e){return this._elementRegistry.get(e.id)};const F={__depends__:[B,{__depends__:[T.Z],bpmnImporter:["type",I]}]};var W=n(411),z=n(490),N=new(n(237).Z)("ov");function H(e,t,n,i){var o,r;this._eventBus=t,this._canvas=n,this._elementRegistry=i,this._ids=N,this._overlayDefaults=(0,a.f0)({show:null,scale:!0},e&&e.defaults),this._overlays={},this._overlayContainers=[],this._overlayRoot=(o=n.getContainer(),r=(0,d.H6)('<div class="djs-overlay-container" style="position: absolute; width: 0; height: 0;" />'),o.insertBefore(r,o.firstChild),r),this._init()}function Z(e,t,n){(0,a.f0)(e.style,{left:t+"px",top:n+"px"})}function G(e,t){e.style.display=!1===t?"none":""}function U(e,t){e.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach((function(n){e.style[n+"transform"]=t}))}H.$inject=["config.overlays","eventBus","canvas","elementRegistry"],H.prototype.get=function(e){if((0,a.HD)(e)&&(e={id:e}),(0,a.HD)(e.element)&&(e.element=this._elementRegistry.get(e.element)),e.element){var t=this._getOverlayContainer(e.element,!0);return t?e.type?(0,a.hX)(t.overlays,(0,a.KQ)({type:e.type})):t.overlays.slice():[]}return e.type?(0,a.hX)(this._overlays,(0,a.KQ)({type:e.type})):e.id?this._overlays[e.id]:null},H.prototype.add=function(e,t,n){if((0,a.Kn)(t)&&(n=t,t=null),e.id||(e=this._elementRegistry.get(e)),!n.position)throw new Error("must specifiy overlay position");if(!n.html)throw new Error("must specifiy overlay html");if(!e)throw new Error("invalid element specified");var i=this._ids.next();return n=(0,a.f0)({},this._overlayDefaults,n,{id:i,type:t,element:e,html:n.html}),this._addOverlay(n),i},H.prototype.remove=function(e){var t=this.get(e)||[];(0,a.kJ)(t)||(t=[t]);var n=this;(0,a.Ed)(t,(function(e){var t=n._getOverlayContainer(e.element,!0);if(e&&((0,d.Od)(e.html),(0,d.Od)(e.htmlContainer),delete e.htmlContainer,delete e.element,delete n._overlays[e.id]),t){var i=t.overlays.indexOf(e);-1!==i&&t.overlays.splice(i,1)}}))},H.prototype.show=function(){G(this._overlayRoot)},H.prototype.hide=function(){G(this._overlayRoot,!1)},H.prototype.clear=function(){this._overlays={},this._overlayContainers=[],(0,d.ZH)(this._overlayRoot)},H.prototype._updateOverlayContainer=function(e){var t=e.element,n=e.html,i=t.x,o=t.y;if(t.waypoints){var r=(0,z.jY)(t);i=r.x,o=r.y}Z(n,i,o),(0,d.Lj)(e.html,"data-container-id",t.id)},H.prototype._updateOverlay=function(e){var t,n,i=e.position,o=e.htmlContainer,r=e.element,a=i.left,c=i.top;void 0!==i.right&&(t=r.waypoints?(0,z.jY)(r).width:r.width,a=-1*i.right+t),void 0!==i.bottom&&(n=r.waypoints?(0,z.jY)(r).height:r.height,c=-1*i.bottom+n),Z(o,a||0,c||0)},H.prototype._createOverlayContainer=function(e){var t=(0,d.H6)('<div class="djs-overlays" style="position: absolute" />');this._overlayRoot.appendChild(t);var n={html:t,element:e,overlays:[]};return this._updateOverlayContainer(n),this._overlayContainers.push(n),n},H.prototype._updateRoot=function(e){var t=e.scale||1,n="matrix("+[t,0,0,t,-1*e.x*t,-1*e.y*t].join(",")+")";U(this._overlayRoot,n)},H.prototype._getOverlayContainer=function(e,t){var n=(0,a.sE)(this._overlayContainers,(function(t){return t.element===e}));return n||t?n:this._createOverlayContainer(e)},H.prototype._addOverlay=function(e){var t,n,i=e.id,o=e.element,r=e.html;r.get&&r.constructor.prototype.jquery&&(r=r.get(0)),(0,a.HD)(r)&&(r=(0,d.H6)(r)),n=this._getOverlayContainer(o),(t=(0,d.H6)('<div class="djs-overlay" data-overlay-id="'+i+'" style="position: absolute">')).appendChild(r),e.type&&(0,d.Sh)(t).add("djs-overlay-"+e.type),e.htmlContainer=t,n.overlays.push(e),n.html.appendChild(t),this._overlays[i]=e,this._updateOverlay(e),this._updateOverlayVisibilty(e,this._canvas.viewbox())},H.prototype._updateOverlayVisibilty=function(e,t){var n=e.show,i=n&&n.minZoom,o=n&&n.maxZoom,r=e.htmlContainer,c=!0;n&&(((0,a.$K)(i)&&i>t.scale||(0,a.$K)(o)&&o<t.scale)&&(c=!1),G(r,c)),this._updateOverlayScale(e,t)},H.prototype._updateOverlayScale=function(e,t){var n,i,o,r=e.scale,c=e.htmlContainer,s="";!0!==r&&(!1===r?(n=1,i=1):(n=r.min,i=r.max),(0,a.$K)(n)&&t.scale<n&&(o=(1/t.scale||1)*n),(0,a.$K)(i)&&t.scale>i&&(o=(1/t.scale||1)*i)),(0,a.$K)(o)&&(s="scale("+o+","+o+")"),U(c,s)},H.prototype._updateOverlaysVisibilty=function(e){var t=this;(0,a.Ed)(this._overlays,(function(n){t._updateOverlayVisibilty(n,e)}))},H.prototype._init=function(){var e=this._eventBus,t=this;e.on("canvas.viewbox.changing",(function(e){t.hide()})),e.on("canvas.viewbox.changed",(function(e){var n;n=e.viewbox,t._updateRoot(n),t._updateOverlaysVisibilty(n),t.show()})),e.on(["shape.remove","connection.remove"],(function(e){var n=e.element,i=t.get({element:n});(0,a.Ed)(i,(function(e){t.remove(e.id)}));var o=t._getOverlayContainer(n);if(o){(0,d.Od)(o.html);var r=t._overlayContainers.indexOf(o);-1!==r&&t._overlayContainers.splice(r,1)}})),e.on("element.changed",500,(function(e){var n=e.element,i=t._getOverlayContainer(n,!0);i&&((0,a.Ed)(i.overlays,(function(e){t._updateOverlay(e)})),t._updateOverlayContainer(i))})),e.on("element.marker.update",(function(e){var n=t._getOverlayContainer(e.element,!0);n&&(0,d.Sh)(n.html)[e.add?"add":"remove"](e.marker)})),e.on("diagram.clear",this.clear,this)};const K={__init__:["overlays"],overlays:["type",H]};var V=n(710),q=n.n(V),Y=n(648),J=n.n(Y),X=n(235),Q=new(n.n(X)())({name:"bpmnElement",enumerable:!0},{name:"di",configurable:!0});function ee(e,t){return e.$instanceOf(t)}function te(e,t){var n={},i=[];function o(e,t){return function(n){e(n,t)}}function r(e){n[e.id]=e}function c(n,i){try{var o=n.di&&function(n,i){if(n.gfx)throw new Error(t("already rendered {element}",{element:A(n)}));return e.element(n,i)}(n,i);return r(n),o}catch(e){s(e.message,{element:n,error:e}),console.error(t("failed to import {element}",{element:A(n)})),console.error(e)}}function s(t,n){e.error(t,n)}function u(e){var n=e.bpmnElement;n?n.di?s(t("multiple DI elements defined for {element}",{element:A(n)}),{element:n}):(Q.bind(n,"di"),n.di=e):s(t("no bpmnElement referenced in {element}",{element:A(e)}),{element:e})}function l(e){u(e)}function p(){for(;i.length;)i.shift()()}function h(e,t){S(e,t),x(e.ioSpecification,t),g(e.artifacts,t),r(e)}function d(e,t){c(e,t)}function f(e,t){c(e,t)}function m(e,t){c(e,t)}function v(e,t){c(e,t)}function y(e,t){c(e,t)}function g(e,t){(0,a.Ed)(e,(function(e){ee(e,"bpmn:Association")?i.push((function(){y(e,t)})):y(e,t)}))}function x(e,t){e&&((0,a.Ed)(e.dataInputs,o(m,t)),(0,a.Ed)(e.dataOutputs,o(v,t)))}function b(e,t){S(e,t),g(e.artifacts,t)}function E(e,t){var n=c(e,t);ee(e,"bpmn:SubProcess")&&b(e,n||t),ee(e,"bpmn:Activity")&&x(e.ioSpecification,t),i.push((function(){(0,a.Ed)(e.dataInputAssociations,o(f,t)),(0,a.Ed)(e.dataOutputAssociations,o(f,t))}))}function w(e,t){i.push((function(){var n=c(e,t);e.childLaneSet&&_(e.childLaneSet,n||t),function(e){(0,a.Ed)(e.flowNodeRef,(function(t){var n=t.get("lanes");n&&n.push(e)}))}(e)}))}function _(e,t){(0,a.Ed)(e.lanes,o(w,t))}function S(e,n){!function(e,n){(0,a.Ed)(e,(function(e){ee(e,"bpmn:SequenceFlow")?i.push((function(){!function(e,t){c(e,t)}(e,n)})):ee(e,"bpmn:BoundaryEvent")?i.unshift((function(){E(e,n)})):ee(e,"bpmn:FlowNode")?E(e,n):ee(e,"bpmn:DataObject")||(ee(e,"bpmn:DataStoreReference")||ee(e,"bpmn:DataObjectReference")?function(e,t){c(e,t)}(e,n):s(t("unrecognized flowElement {element} in context {context}",{element:A(e),context:n?A(n.businessObject):"null"}),{element:e,context:n}))}))}(e.flowElements,n),e.laneSets&&function(e,t){(0,a.Ed)(e,o(_,t))}(e.laneSets,n)}function k(e,t){var n=c(e,t),i=e.processRef;i&&h(i,n||t)}return{handleDeferred:p,handleDefinitions:function(r,c){var f=r.diagrams;if(c&&-1===f.indexOf(c))throw new Error(t("diagram not part of bpmn:Definitions"));if(!c&&f&&f.length&&(c=f[0]),!c)throw new Error(t("no diagram to display"));!function(e){var t;u(t=e.plane),(0,a.Ed)(t.planeElement,l)}(c);var m=c.plane;if(!m)throw new Error(t("no plane for {element}",{element:A(c)}));var v=m.bpmnElement;if(!v){if(!(v=function(e){return(0,a.sE)(e.rootElements,(function(e){return ee(e,"bpmn:Process")||ee(e,"bpmn:Collaboration")}))}(r)))throw new Error(t("no process or collaboration to display"));s(t("correcting missing bpmnElement on {plane} to {rootElement}",{plane:A(m),rootElement:A(v)})),m.bpmnElement=v,u(m)}var y,x=function(t,n){return e.root(t,n)}(v,m);if(ee(v,"bpmn:Process"))h(v,x);else{if(!ee(v,"bpmn:Collaboration"))throw new Error(t("unsupported bpmnElement for {plane}: {rootElement}",{plane:A(m),rootElement:A(v)}));y=v,(0,a.Ed)(y.participants,o(k)),g(y.artifacts),i.push((function(){var e;e=y.messageFlows,(0,a.Ed)(e,o(d,undefined))})),function(e,t){(0,a.hX)(e,(function(e){return!n[e.id]&&ee(e,"bpmn:Process")&&e.laneSets})).forEach(o(h,t))}(r.rootElements,x)}p()},handleSubProcess:b,registerDi:u}}function ne(e){return function(){if(!window.Promise)throw new Error("Promises is not supported in this environment. Please polyfill Promise.");var t=arguments.length;if(!(t>=1&&(0,a.mf)(arguments[t-1])))return e.apply(this,arguments);var n=arguments[t-1];console.warn(new Error("Passing callbacks to "+e.name+" is deprecated and will be removed in a future major release. Please switch to promises: https://bpmn.io/l/moving-to-promises.html"));var i=Array.prototype.slice.call(arguments,0,-1);e.apply(this,i).then((function(e){var t=Object.keys(e)[0];return n(null,e[t])}),(function(e){return n(e,e.warnings)}))}}var ie='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14.02 5.57" width="53" height="21" style="vertical-align:middle"><path fill="currentColor" d="M1.88.92v.14c0 .41-.13.68-.4.8.33.14.46.44.46.86v.33c0 .61-.33.95-.95.95H0V0h.95c.65 0 .93.3.93.92zM.63.57v1.06h.24c.24 0 .38-.1.38-.43V.98c0-.28-.1-.4-.32-.4zm0 1.63v1.22h.36c.2 0 .32-.1.32-.39v-.35c0-.37-.12-.48-.4-.48H.63zM4.18.99v.52c0 .64-.31.98-.94.98h-.3V4h-.62V0h.92c.63 0 .94.35.94.99zM2.94.57v1.35h.3c.2 0 .3-.09.3-.37v-.6c0-.29-.1-.38-.3-.38h-.3zm2.89 2.27L6.25 0h.88v4h-.6V1.12L6.1 3.99h-.6l-.46-2.82v2.82h-.55V0h.87zM8.14 1.1V4h-.56V0h.79L9 2.4V0h.56v4h-.64zm2.49 2.29v.6h-.6v-.6zM12.12 1c0-.63.33-1 .95-1 .61 0 .95.37.95 1v2.04c0 .64-.34 1-.95 1-.62 0-.95-.37-.95-1zm.62 2.08c0 .28.13.39.33.39s.32-.1.32-.4V.98c0-.29-.12-.4-.32-.4s-.33.11-.33.4z"/><path fill="currentColor" d="M0 4.53h14.02v1.04H0zM11.08 0h.63v.62h-.63zm.63 4V1h-.63v2.98z"/></svg>';function oe(e){return e.join(";")}var re,ae=oe(["color: #404040"]),ce='<div class="bjs-powered-by-lightbox" style="'+oe(["z-index: 1001","position: fixed","top: 0","left: 0","right: 0","bottom: 0"])+'"><div class="backdrop" style="'+oe(["width: 100%","height: 100%","background: rgba(40,40,40,0.2)"])+'"></div><div class="notice" style="'+oe(["position: absolute","left: 50%","top: 40%","transform: translate(-50%)","width: 260px","padding: 10px","background: white","box-shadow: 0 1px 4px rgba(0,0,0,0.3)","font-family: Helvetica, Arial, sans-serif","font-size: 14px","display: flex","line-height: 1.3"])+'"><a href="https://bpmn.io" target="_blank" rel="noopener" style="margin: 15px 20px 15px 10px; align-self: center;'+ae+'">'+ie+'</a><span>Web-based tooling for BPMN, DMN and CMMN diagrams powered by <a href="https://bpmn.io" target="_blank" rel="noopener">bpmn.io</a>.</span></div></div>';function se(e){var t,n,i;e=(0,a.f0)({},le,e),this._moddle=this._createModdle(e),this._container=this._createContainer(e),t=this._container,n='<a href="http://bpmn.io" target="_blank" class="bjs-powered-by" title="Powered by bpmn.io" style="position: absolute; bottom: 15px; right: 15px; z-index: 100; '+ae+'">'+ie+"</a>",i=(0,d.H6)(n),t.appendChild(i),d.B.bind(i,"click",(function(e){re||(re=(0,d.H6)(ce),d.cl.bind(re,".backdrop","click",(function(e){document.body.removeChild(re)}))),document.body.appendChild(re),e.preventDefault()})),this._init(this._container,this._moddle,e)}function ue(e,t){return e.warnings=t,e}r()(se,q()),se.prototype.importXML=ne((function(e,t){var n=this;return new Promise((function(i,o){e=n._emit("import.parse.start",{xml:e})||e,n._moddle.fromXML(e,"bpmn:Definitions").then((function(e){var r,a,c=e.rootElement,s=e.references,u=e.warnings,l=e.elementsById;c=n._emit("import.parse.complete",(r={error:null,definitions:c,elementsById:l,references:s,warnings:u},a=n.get("eventBus").createEvent(r),Object.defineProperty(a,"context",{enumerable:!0,get:function(){return console.warn(new Error("import.parse.complete <context> is deprecated and will be removed in future library versions")),{warnings:r.warnings,references:r.references,elementsById:r.elementsById}}}),a))||c,n.importDefinitions(c,t).then((function(e){var t=[].concat(u,e.warnings||[]);return n._emit("import.done",{error:null,warnings:t}),i({warnings:t})})).catch((function(e){var t=[].concat(u,e.warnings||[]);return n._emit("import.done",{error:e,warnings:t}),o(ue(e,t))}))})).catch((function(e){return n._emit("import.parse.complete",{error:e}),e=function(e){var t=/unparsable content <([^>]+)> detected([\s\S]*)$/.exec(e.message);return t&&(e.message="unparsable content <"+t[1]+"> detected; this may indicate an invalid BPMN 2.0 diagram file"+t[2]),e}(e),n._emit("import.done",{error:e,warnings:e.warnings}),o(e)}))}))})),se.prototype.importDefinitions=ne((function(e,t){var n=this;return new Promise((function(i,o){n._setDefinitions(e),n.open(t).then((function(e){var t=e.warnings;return i({warnings:t})})).catch((function(e){return o(e)}))}))})),se.prototype.open=ne((function(e){var t=this._definitions,n=e,i=this;return new Promise((function(o,r){if(!t){var c=new Error("no XML imported");return r(ue(c,[]))}if("string"==typeof e&&!(n=function(e,t){return t&&(0,a.sE)(e.diagrams,(function(e){return e.id===t}))||null}(t,e))){var s=new Error("BPMNDiagram <"+e+"> not found");return r(ue(s,[]))}try{i.clear()}catch(e){return r(ue(e,[]))}(function(e,t,n){var i,o,r,a=[];return new Promise((function(c,s){try{return i=e.get("bpmnImporter"),o=e.get("eventBus"),r=e.get("translate"),o.fire("import.render.start",{definitions:t}),function(e,t){new te({root:function(e){return i.add(e)},element:function(e,t){return i.add(e,t)},error:function(e,t){a.push({message:e,context:t})}},r).handleDefinitions(e,t)}(t,n),o.fire("import.render.complete",{error:void 0,warnings:a}),c({warnings:a})}catch(e){return e.warnings=a,s(e)}}))})(i,t,n).then((function(e){var t=e.warnings;return o({warnings:t})})).catch((function(e){return r(e)}))}))})),se.prototype.saveXML=ne((function(e){e=e||{};var t=this,n=this._definitions;return new Promise((function(i){if(!n)return i({error:new Error("no definitions loaded")});n=t._emit("saveXML.start",{definitions:n})||n,t._moddle.toXML(n,e).then((function(e){var n=e.xml;return n=t._emit("saveXML.serialized",{xml:n})||n,i({xml:n})}))})).catch((function(e){return{error:e}})).then((function(e){t._emit("saveXML.done",e);var n=e.error;return n?Promise.reject(n):e}))})),se.prototype.saveSVG=ne((function(e){e=e||{};var t=this;return new Promise((function(e,n){var i,o;t._emit("saveSVG.start");try{var r=t.get("canvas"),a=r.getDefaultLayer(),c=(0,d.IO)("defs",r._svg),s=(0,f.db)(a),u=c?"<defs>"+(0,f.db)(c)+"</defs>":"",l=a.getBBox();i='<?xml version="1.0" encoding="utf-8"?>\n\x3c!-- created with bpmn-js / http://bpmn.io --\x3e\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+l.width+'" height="'+l.height+'" viewBox="'+l.x+" "+l.y+" "+l.width+" "+l.height+'" version="1.1">'+u+s+"</svg>"}catch(e){o=e}return t._emit("saveSVG.done",{error:o,svg:i}),o?n(o):e({svg:i})}))})),se.prototype._setDefinitions=function(e){this._definitions=e},se.prototype.getModules=function(){return this._modules},se.prototype.clear=function(){this.getDefinitions()&&(this.get("elementRegistry").forEach((function(e){var t=e.businessObject;t&&t.di&&delete t.di})),q().prototype.clear.call(this))},se.prototype.destroy=function(){q().prototype.destroy.call(this),(0,d.Od)(this._container)},se.prototype.on=function(e,t,n,i){return this.get("eventBus").on(e,t,n,i)},se.prototype.off=function(e,t){this.get("eventBus").off(e,t)},se.prototype.attachTo=function(e){if(!e)throw new Error("parentNode required");this.detach(),e.get&&e.constructor.prototype.jquery&&(e=e.get(0)),"string"==typeof e&&(e=(0,d.IO)(e)),e.appendChild(this._container),this._emit("attach",{}),this.get("canvas").resized()},se.prototype.getDefinitions=function(){return this._definitions},se.prototype.detach=function(){var e=this._container,t=e.parentNode;t&&(this._emit("detach",{}),t.removeChild(e))},se.prototype._init=function(e,t,n){var i=n.modules||this.getModules(),o=n.additionalModules||[],r=[].concat([{bpmnjs:["value",this],moddle:["value",t]}],i,o),c=(0,a.f0)((0,a.CE)(n,["additionalModules"]),{canvas:(0,a.f0)({},n.canvas,{container:e}),modules:r});q().call(this,c),n&&n.container&&this.attachTo(n.container)},se.prototype._emit=function(e,t){return this.get("eventBus").fire(e,t)},se.prototype._createContainer=function(e){var t=(0,d.H6)('<div class="bjs-container"></div>');return(0,a.f0)(t.style,{width:pe(e.width),height:pe(e.height),position:e.position}),t},se.prototype._createModdle=function(e){var t=(0,a.f0)({},this._moddleExtensions,e.moddleExtensions);return new(J())(t)},se.prototype._modules=[];var le={width:"100%",height:"100%",position:"relative"};function pe(e){return e+((0,a.hj)(e)?"px":"")}function he(e){se.call(this,e)}function de(e){return!e.altKey&&(e.ctrlKey||e.metaKey)}function fe(e,t){return-1!==(e=(0,a.kJ)(e)?e:[e]).indexOf(t.key)||-1!==e.indexOf(t.keyCode)}function me(e){return e.shiftKey}r()(he,se),he.prototype._modules=[F,T.Z,W.Z,K],he.prototype._moddleExtensions={};var ve="keyboard.keydown";function ye(e,t){var n=this;this._config=e||{},this._eventBus=t,this._keydownHandler=this._keydownHandler.bind(this),this._keyupHandler=this._keyupHandler.bind(this),t.on("diagram.destroy",(function(){n._fire("destroy"),n.unbind()})),t.on("diagram.init",(function(){n._fire("init")})),t.on("attach",(function(){e&&e.bindTo&&n.bind(e.bindTo)})),t.on("detach",(function(){n.unbind()}))}ye.$inject=["config.keyboard","eventBus"],ye.prototype._keydownHandler=function(e){this._keyHandler(e,ve)},ye.prototype._keyupHandler=function(e){this._keyHandler(e,"keyboard.keyup")},ye.prototype._keyHandler=function(e,t){if(!(i=e.target)||!(0,d.wB)(i,"input, textarea")&&"true"!==i.contentEditable){var n={keyEvent:e};this._eventBus.fire(t||ve,n)&&e.preventDefault()}var i},ye.prototype.bind=function(e){this.unbind(),this._node=e,d.B.bind(e,"keydown",this._keydownHandler,!0),d.B.bind(e,"keyup",this._keyupHandler,!0),this._fire("bind")},ye.prototype.getBinding=function(){return this._node},ye.prototype.unbind=function(){var e=this._node;e&&(this._fire("unbind"),d.B.unbind(e,"keydown",this._keydownHandler,!0),d.B.unbind(e,"keyup",this._keyupHandler,!0)),this._node=null},ye.prototype._fire=function(e){this._eventBus.fire("keyboard."+e,{node:this._node})},ye.prototype.addListener=function(e,t,n){(0,a.mf)(e)&&(n=t,t=e,e=1e3),this._eventBus.on(n||ve,e,t)},ye.prototype.removeListener=function(e,t){this._eventBus.off(t||ve,e)},ye.prototype.hasModifier=function(e){return e.ctrlKey||e.metaKey||e.shiftKey||e.altKey},ye.prototype.isCmd=de,ye.prototype.isShift=me,ye.prototype.isKey=fe;var ge=["c","C",67],xe=["v","V",86],be=["y","Y",89],Ee=["z","Z",90];function we(e,t){var n=this;e.on("editorActions.init",500,(function(e){var i=e.editorActions;n.registerBindings(t,i)}))}we.$inject=["eventBus","keyboard"],we.prototype.registerBindings=function(e,t){function n(n,i){t.isRegistered(n)&&e.addListener(i)}n("undo",(function(e){var n=e.keyEvent;if(de(n)&&!me(n)&&fe(Ee,n))return t.trigger("undo"),!0})),n("redo",(function(e){var n=e.keyEvent;if(de(n)&&(fe(be,n)||fe(Ee,n)&&me(n)))return t.trigger("redo"),!0})),n("copy",(function(e){var n=e.keyEvent;if(de(n)&&fe(ge,n))return t.trigger("copy"),!0})),n("paste",(function(e){var n=e.keyEvent;if(de(n)&&fe(xe,n))return t.trigger("paste"),!0})),n("stepZoom",(function(e){var n=e.keyEvent;if(fe(["+","Add","="],n)&&de(n))return t.trigger("stepZoom",{value:1}),!0})),n("stepZoom",(function(e){var n=e.keyEvent;if(fe(["-","Subtract"],n)&&de(n))return t.trigger("stepZoom",{value:-1}),!0})),n("zoom",(function(e){var n=e.keyEvent;if(fe("0",n)&&de(n))return t.trigger("zoom",{value:1}),!0})),n("removeSelection",(function(e){if(fe(["Backspace","Delete","Del"],e.keyEvent))return t.trigger("removeSelection"),!0}))};const _e={__init__:["keyboard","keyboardBindings"],keyboard:["type",ye],keyboardBindings:["type",we]};var Se={moveSpeed:50,moveSpeedAccelerated:200};function ke(e,t,n){var i=this;this._config=(0,a.f0)({},Se,e||{}),t.addListener((function(e){var n=e.keyEvent,o=i._config;if(t.isCmd(n)&&t.isKey(["ArrowLeft","Left","ArrowUp","Up","ArrowDown","Down","ArrowRight","Right"],n)){var r,a=t.isShift(n)?o.moveSpeedAccelerated:o.moveSpeed;switch(n.key){case"ArrowLeft":case"Left":r="left";break;case"ArrowUp":case"Up":r="up";break;case"ArrowRight":case"Right":r="right";break;case"ArrowDown":case"Down":r="down"}return i.moveCanvas({speed:a,direction:r}),!0}})),this.moveCanvas=function(e){var t=0,i=0,o=e.speed/Math.min(Math.sqrt(n.viewbox().scale),1);switch(e.direction){case"left":t=o;break;case"up":i=o;break;case"right":t=-o;break;case"down":i=-o}n.scroll({dx:t,dy:i})}}ke.$inject=["config.keyboardMove","keyboard","canvas"];const Re={__depends__:[_e],__init__:["keyboardMove"],keyboardMove:["type",ke]};var je=n(422),Pe=n(53),Me=n(419),Be=n(752);function Te(e,t){var n;function i(i){var o,r=n.start,a=n.button,c=(0,Be.jt)(i),s=(0,Me.p)(c,r);if(!n.dragging&&(o=s,Math.sqrt(Math.pow(o.x,2)+Math.pow(o.y,2))>15)&&(n.dragging=!0,0===a&&(0,Pe.N)(e),(0,je.t8)("grab")),n.dragging){var u=n.last||n.start;s=(0,Me.p)(c,u),t.scroll({dx:s.x,dy:s.y}),n.last=c}i.preventDefault()}function o(e){d.B.unbind(document,"mousemove",i),d.B.unbind(document,"mouseup",o),n=null,(0,je.zN)()}e.on("element.mousedown",500,(function(e){return function(e){if(!(0,d.oq)(e.target,".djs-draggable")){var t=e.button;if(!(t>=2||e.ctrlKey||e.shiftKey||e.altKey))return n={button:t,start:(0,Be.jt)(e)},d.B.bind(document,"mousemove",i),d.B.bind(document,"mouseup",o),!0}}(e.originalEvent)})),this.isActive=function(){return!!n}}Te.$inject=["eventBus","canvas"];const De={__init__:["moveCanvas"],moveCanvas:["type",Te]};function Ce(e){return Math.log(e)/Math.log(10)}function Ae(e,t){var n=Ce(e.min),i=Ce(e.max);return(Math.abs(n)+Math.abs(i))/t}var Oe=Math.sign||function(e){return e>=0?1:-1},Le={min:.2,max:4};function $e(e,t,n){e=e||{},this._enabled=!1,this._canvas=n,this._container=n._container,this._handleWheel=(0,a.ak)(this._handleWheel,this),this._totalDelta=0,this._scale=e.scale||.75;var i=this;t.on("canvas.init",(function(t){i._init(!1!==e.enabled)}))}$e.$inject=["config.zoomScroll","eventBus","canvas"],$e.prototype.scroll=function(e){this._canvas.scroll(e)},$e.prototype.reset=function(){this._canvas.zoom("fit-viewport")},$e.prototype.zoom=function(e,t){var n=Ae(Le,20);this._totalDelta+=e,Math.abs(this._totalDelta)>.1&&(this._zoom(e,t,n),this._totalDelta=0)},$e.prototype._handleWheel=function(e){if(!(0,d.oq)(e.target,".djs-scrollable",!0)){var t=this._container;e.preventDefault();var n,i=e.ctrlKey,o=e.shiftKey,r=-1*this._scale;if(r*=i?0===e.deltaMode?.02:.32:0===e.deltaMode?1:16,i){var a=t.getBoundingClientRect(),c={x:e.clientX-a.left,y:e.clientY-a.top};n=Math.sqrt(Math.pow(e.deltaY,2)+Math.pow(e.deltaX,2))*Oe(e.deltaY)*r,this.zoom(n,c)}else n=o?{dx:r*e.deltaY,dy:0}:{dx:r*e.deltaX,dy:r*e.deltaY},this.scroll(n)}},$e.prototype.stepZoom=function(e,t){var n=Ae(Le,10);this._zoom(e,t,n)},$e.prototype._zoom=function(e,t,n){var i=this._canvas,o=e>0?1:-1,r=Ce(i.zoom()),a=Math.round(r/n)*n;a+=n*o;var c,s,u=Math.pow(10,a);i.zoom((c=Le,s=u,Math.max(c.min,Math.min(c.max,s))),t)},$e.prototype.toggle=function(e){var t=this._container,n=this._handleWheel,i=this._enabled;return void 0===e&&(e=!i),i!==e&&d.B[e?"bind":"unbind"](t,"wheel",n,!1),this._enabled=e,e},$e.prototype._init=function(e){this.toggle(e)};const Ie={__init__:["zoomScroll"],zoomScroll:["type",$e]};function Fe(e){he.call(this,e)}r()(Fe,he),Fe.prototype._navigationModules=[Re,De,Ie],Fe.prototype._modules=[].concat(he.prototype._modules,Fe.prototype._navigationModules)},312:(e,t,n)=>{n.d(t,{iY:()=>r,gT:()=>a,uZ:()=>c,DN:()=>s,nr:()=>u,W7:()=>l,$Z:()=>p,Ou:()=>h,iu:()=>d,H:()=>f,j3:()=>m,lr:()=>v});var i=n(670),o=n(230);function r(e,t,n){return(0,i.G)(e.eventDefinitions,(function(o){return o.$type===t&&function(e,t){return(0,i.yW)(t,(function(t,n){return e[n]==t}))}(e,n)}))}function a(e){return"bpmn:IntermediateThrowEvent"===e.$type||"bpmn:EndEvent"===e.$type}function c(e){var t=e.dataObjectRef;return e.isCollection||t&&t.isCollection}function s(e){return e.businessObject.di}function u(e){return e.businessObject}function l(e,t){var n=s(e);return n.get("color:background-color")||n.get("bioc:fill")||t||"white"}function p(e,t){var n=s(e);return n.get("color:border-color")||n.get("bioc:stroke")||t||"black"}function h(e,t,n){var i=s(e).get("label");return i&&i.get("color:color")||t||p(e,n)}function d(e){var t=e.x+e.width/2,n=e.y+e.height/2,i=e.width/2,r=[["M",t,n],["m",0,-i],["a",i,i,0,1,1,0,2*i],["a",i,i,0,1,1,0,-2*i],["z"]];return(0,o.KO)(r)}function f(e,t){var n=e.x,i=e.y,r=e.width,a=e.height,c=[["M",n+t,i],["l",r-2*t,0],["a",t,t,0,0,1,t,t],["l",0,a-2*t],["a",t,t,0,0,1,-t,t],["l",2*t-r,0],["a",t,t,0,0,1,-t,-t],["l",0,2*t-a],["a",t,t,0,0,1,t,-t],["z"]];return(0,o.KO)(c)}function m(e){var t=e.width/2,n=e.height/2,i=[["M",e.x+t,e.y],["l",t,n],["l",-t,n],["l",-t,-n],["z"]];return(0,o.KO)(i)}function v(e){var t=e.x,n=e.y,i=e.width,r=[["M",t,n],["l",i,0],["l",0,e.height],["l",-i,0],["z"]];return(0,o.KO)(r)}},635:(e,t,n)=>{n.d(t,{i:()=>r,l:()=>a});var i=n(252);function o(e){return(0,i.is)(e,"bpmn:FlowElement")||(0,i.is)(e,"bpmn:Participant")||(0,i.is)(e,"bpmn:Lane")||(0,i.is)(e,"bpmn:SequenceFlow")||(0,i.is)(e,"bpmn:MessageFlow")||(0,i.is)(e,"bpmn:DataInput")||(0,i.is)(e,"bpmn:DataOutput")?"name":(0,i.is)(e,"bpmn:TextAnnotation")?"text":(0,i.is)(e,"bpmn:Group")?"categoryValueRef":void 0}function r(e){var t=e.businessObject,n=o(t);if(n)return"categoryValueRef"===n?function(e){var t=e.categoryValueRef;return t&&t.value||""}(t):t[n]||""}function a(e,t,n){var i=e.businessObject,r=o(i);return r&&("categoryValueRef"===r?i.categoryValueRef.value=t:i[r]=t),e}},698:(e,t,n)=>{var i=n(670).u4,o=n(670).XP,r=n(670).Ed,a=n(252).is,c=n(252).S;function s(e){this._elementRegistry=e}function u(e,t){r(t,(function(t,n){e.set(n,t)}))}s.$inject=["elementRegistry"],e.exports=s,s.prototype.execute=function(e){var t=e.element,n=e.moddleElement,r=e.properties;if(!n)throw new Error("<moddleElement> required");var a=e.changed||this.getVisualReferences(n).concat(t),c=e.oldProperties||function(e,t){return i(t,(function(t,n){return t[n]=e.get(n),t}),{})}(n,o(r));return u(n,r),e.oldProperties=c,e.changed=a,a},s.prototype.revert=function(e){var t=e.oldProperties,n=e.moddleElement,i=e.changed;return u(n,t),i},s.prototype.getVisualReferences=function(e){var t=this._elementRegistry;return a(e,"bpmn:DataObject")?function(e,t){return t.filter((function(t){return a(t,"bpmn:DataObjectReference")&&c(t).dataObjectRef===e}))}(e,t):[]}},461:(e,t,n)=>{n.d(t,{Z:()=>Or});var i=n(717),o=n.n(i),r=n(935),a=n(419),c=n(507),s=n(670);function u(e){this._eventBus=e}u.$inject=["eventBus"],u.prototype.on=function(e,t,n,i,o,r){if(((0,s.mf)(t)||(0,s.hj)(t))&&(r=o,o=i,i=n,n=t,t=null),(0,s.mf)(n)&&(r=o,o=i,i=n,n=1e3),(0,s.Kn)(o)&&(r=o,o=!1),!(0,s.mf)(i))throw new Error("handlerFn must be a function");(0,s.kJ)(e)||(e=[e]);var a=this._eventBus;(0,s.Ed)(e,(function(e){var c=["commandStack",e,t].filter((function(e){return e})).join(".");a.on(c,n,o?function(e,t){return function(n){return e.call(t||null,n.context,n.command,n)}}(i,r):i,r)}))},(0,s.Ed)(["canExecute","preExecute","preExecuted","execute","executed","postExecute","postExecuted","revert","reverted"],(function(e){u.prototype[e]=function(t,n,i,o,r){((0,s.mf)(t)||(0,s.hj)(t))&&(r=o,o=i,i=n,n=t,t=null),this.on(t,e,n,i,o,r)}}));var l=["top","bottom","left","right"];function p(e,t){function n(e){if((0,c.fF)(e)){var n=function(e){var t=(0,r.wS)(e.label),n=h((0,r.wS)(e),t);if(i=n,-1!==l.indexOf(i)){var i,o=function(e){var t=(0,r.wS)(e);return[].concat(e.incoming.map((function(e){return e.waypoints[e.waypoints.length-2]})),e.outgoing.map((function(e){return e.waypoints[1]}))).map((function(e){return h(t,e)}))}(e);if(e.host){var a=function(e){var t,n=e.host,i=(0,r.wS)(e),o=(0,r.T8)(i,n);return t=o.indexOf("-")>=0?o.split("-"):[o],l.filter((function(e){return-1===t.indexOf(e)}))}(e);o=o.concat(a)}var c=l.filter((function(e){return-1===o.indexOf(e)}));if(-1===c.indexOf(n))return c[0]}}(e);n&&function(e,n){var i=(0,r.wS)(e),o=e.label,c=(0,r.wS)(o);if(o.parent){var s,u=(0,r.JA)(e);switch(n){case"top":s={x:i.x,y:u.top-10-o.height/2};break;case"left":s={x:u.left-10-o.width/2,y:i.y};break;case"bottom":s={x:i.x,y:u.bottom+10+o.height/2};break;case"right":s={x:u.right+10+o.width/2,y:i.y}}var l=(0,a.p)(s,c);t.moveShape(o,l)}}(e,n)}}u.call(this,e),this.postExecuted(["connection.create","connection.layout","connection.updateWaypoints"],(function(e){var t=e.context,i=t.connection,o=i.source,r=i.target;!1!==(t.hints||{}).createElementsBehavior&&(n(o),n(r))})),this.postExecuted(["label.create"],(function(e){var t=e.context,i=t.shape;!1!==(t.hints||{}).createElementsBehavior&&n(i.labelTarget)})),this.postExecuted(["elements.create"],(function(e){var t=e.context,i=t.elements;!1!==(t.hints||{}).createElementsBehavior&&i.forEach((function(e){n(e)}))}))}function h(e,t){return(0,r.T8)(t,e,5)}o()(p,u),p.$inject=["eventBus","modeling"];var d=n(252);function f(e,t,n){u.call(this,e),this.preExecute("shape.append",(function(e){var t=e.source,n=e.shape;e.position||((0,d.is)(n,"bpmn:TextAnnotation")?e.position={x:t.x+t.width/2+75,y:t.y-50-n.height/2}:e.position={x:t.x+t.width+80+n.width/2,y:t.y+t.height/2})}),!0)}function m(e,t){e.invoke(u,this),this.postExecute("shape.move",(function(e){var n=e.newParent,i=e.shape,o=(0,s.hX)(i.incoming.concat(i.outgoing),(function(e){return(0,d.is)(e,"bpmn:Association")}));(0,s.Ed)(o,(function(e){t.moveConnection(e,{x:0,y:0},n)}))}),!0)}function v(e,t){return(0,s.G)(t,(function(t){return(0,d.is)(e,t)}))}function y(e,t){for("string"==typeof t&&(t=[t]);e=e.parent;)if(v(e,t))return e;return null}function g(e,t){t.invoke(u,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",500,(function(e){var t=e.elements;1===(t=t.filter((function(e){return x(e,e.host)}))).length&&t.map((function(e){return t.indexOf(e)})).forEach((function(i){var o=t[i];e.elements[i]=n.replaceShape(t[i],o)}))}),!0),this.preExecute("elements.move",500,(function(e){var t=e.shapes,i=e.newHost;if(1===t.length){var o=t[0];x(o,i)&&(e.shapes=[n.replaceShape(o,i)])}}),!0)}function x(e,t){return!(0,c.j_)(e)&&v(e,["bpmn:IntermediateThrowEvent","bpmn:IntermediateCatchEvent"])&&!!t}function b(e,t,n){function i(e){return(0,s.hX)(e.attachers,(function(e){return(0,d.is)(e,"bpmn:BoundaryEvent")}))}u.call(this,e),this.postExecute("connection.create",(function(e){var t=e.context.source,o=e.context.target,r=i(o);(0,d.is)(t,"bpmn:EventBasedGateway")&&(0,d.is)(o,"bpmn:ReceiveTask")&&r.length>0&&n.removeElements(r)})),this.postExecute("connection.reconnect",(function(e){var t=e.context.oldSource,o=e.context.newSource;(0,d.is)(t,"bpmn:Gateway")&&(0,d.is)(o,"bpmn:EventBasedGateway")&&(0,s.Ed)(o.outgoing,(function(e){var t=e.target,o=i(t);(0,d.is)(t,"bpmn:ReceiveTask")&&o.length>0&&n.removeElements(o)}))})),e.on("moddleCopy.canCopyProperty",2e3,(function(e){var n=e.parent,i=e.property,o=e.propertyName,r=t.getPropertyDescriptor(n,o);r&&r.isReference&&(0,d.is)(i,"bpmn:RootElement")&&n.set(o,i)}))}o()(f,u),f.$inject=["eventBus","elementFactory","bpmnRules"],o()(m,u),m.$inject=["injector","modeling"],g.$inject=["bpmnReplace","injector"],o()(g,u),g.prototype.replaceShape=function(e,t){var n,i,o=(n=e,(i=(0,d.S)(n).eventDefinitions)&&i[0]),r={type:"bpmn:BoundaryEvent",host:t};return o&&(r.eventDefinitionType=o.$type),this._bpmnReplace.replaceElement(e,r,{layoutConnection:!1})},b.$inject=["eventBus","moddle","modeling"],o()(b,u);var E=n(943),w=n(517);function _(e,t,n,i,o){function r(e){return v(e,["bpmn:ReceiveTask","bpmn:SendTask"])||function(e,t){return(0,s.kJ)(t)||(t=[t]),(0,s.G)(t,(function(t){return(0,w.JG)(e,t)}))}(e,["bpmn:ErrorEventDefinition","bpmn:EscalationEventDefinition","bpmn:MessageEventDefinition","bpmn:SignalEventDefinition"])}function a(t){var n=e.getDefinitions().get("rootElements");return!!(0,s.sE)(n,(0,s.KQ)({id:t.id}))}function c(e){return(0,d.is)(e,"bpmn:ErrorEventDefinition")?"errorRef":(0,d.is)(e,"bpmn:EscalationEventDefinition")?"escalationRef":(0,d.is)(e,"bpmn:MessageEventDefinition")?"messageRef":(0,d.is)(e,"bpmn:SignalEventDefinition")?"signalRef":void 0}function l(e){if(v(e,["bpmn:ReceiveTask","bpmn:SendTask"]))return e.get("messageRef");var t=e.get("eventDefinitions")[0];return t.get(c(t))}n.invoke(u,this),this.executed("shape.create",(function(t){var n=t.shape;if(r(n)){var i,o=l((0,d.S)(n));o&&!a(o)&&(i=e.getDefinitions().get("rootElements"),(0,E.IH)(i,o),t.addedRootElement=o)}}),!0),this.reverted("shape.create",(function(t){var n=t.addedRootElement;if(n){var i=e.getDefinitions().get("rootElements");(0,E.Od)(i,n)}}),!0),t.on("copyPaste.copyElement",(function(e){var t=e.descriptor,n=e.element;if(r(n)){var i=l((0,d.S)(n));i&&(t.referencedRootElement=i)}})),t.on("copyPaste.pasteElement",500,(function(e){var t=e.descriptor,n=t.businessObject;if(r(n)){var s=t.referencedRootElement;s&&(a(s)||(s=i.copyElement(s,o.create(s.$type))),function(e,t){if(v(e,["bpmn:ReceiveTask","bpmn:SendTask"]))return e.set("messageRef",t);var n=e.get("eventDefinitions")[0];n.set(c(n),t)}(n,s))}}))}function S(e){e.invoke(u,this),this.preExecute("shape.create",1500,(function(e){var t=e.context,n=t.parent,i=t.shape;(0,d.is)(n,"bpmn:Lane")&&!(0,d.is)(i,"bpmn:Lane")&&(t.parent=y(n,"bpmn:Participant"))}))}_.$inject=["bpmnjs","eventBus","injector","moddleCopy","bpmnFactory"],o()(_,u),S.$inject=["injector"],o()(S,u);var k=n(490);function R(e,t){return{top:e.top-t.top,right:e.right-t.right,bottom:e.bottom-t.bottom,left:e.left-t.left}}function j(e,t){return void 0!==e?e:20}function P(e){return!e.waypoints&&"label"!==e.type}Math.max,Math.min;var M=Math.abs,B=["bpmn:Participant","bpmn:Process","bpmn:SubProcess"],T=30;function D(e,t){return t=t||[],e.children.filter((function(e){(0,d.is)(e,"bpmn:Lane")&&(D(e,t),t.push(e))})),t}function C(e){return e.children.filter((function(e){return(0,d.is)(e,"bpmn:Lane")}))}function A(e){return y(e,B)||e}var O=1500;function L(e,t,n){t.on(["create.hover","create.move","create.out","create.end","shape.move.hover","shape.move.move","shape.move.out","shape.move.end"],O,(function(t){var i=t.context.shape||t.shape,o=t.hover;(0,d.is)(o,"bpmn:Lane")&&!v(i,["bpmn:Lane","bpmn:Participant"])&&(t.hover=A(o),t.hoverGfx=e.getGraphics(t.hover));var r=n.getRootElement();o!==r&&(i.labelTarget||(0,d.is)(i,"bpmn:Group"))&&(t.hover=r,t.hoverGfx=e.getGraphics(t.hover))})),t.on(["connect.hover","connect.out","connect.end","connect.cleanup","global-connect.hover","global-connect.out","global-connect.end","global-connect.cleanup"],O,(function(t){var n=t.hover;(0,d.is)(n,"bpmn:Lane")&&(t.hover=A(n)||n,t.hoverGfx=e.getGraphics(t.hover))})),t.on(["bendpoint.move.hover"],O,(function(t){var n=t.context,i=t.hover,o=n.type;(0,d.is)(i,"bpmn:Lane")&&/reconnect/.test(o)&&(t.hover=A(i)||i,t.hoverGfx=e.getGraphics(t.hover))})),t.on(["connect.start"],O,(function(e){var t=e.context,n=t.start;(0,d.is)(n,"bpmn:Lane")&&(t.start=A(n)||n)})),t.on("shape.move.start",2e3,(function(e){var t=e.shape;(0,d.is)(t,"bpmn:Lane")&&(e.shape=A(t)||t)}))}function $(e,t,n){u.call(this,e),this.preExecute("shape.create",(function(e){var n=e.context.shape;if((0,d.is)(n,"bpmn:DataObjectReference")&&"label"!==n.type){var i=t.create("bpmn:DataObject");n.businessObject.dataObjectRef=i}}))}L.$inject=["elementRegistry","eventBus","canvas"],$.$inject=["eventBus","bpmnFactory","moddle"],o()($,u);var I=2e3;function F(e,t,n){function i(t){var i,o=t.parent,r=e.getRootElement();(0,d.is)(r,"bpmn:Collaboration")?i=r:(i=n.makeCollaboration(),t.process=o),t.parent=i}u.call(this,t),t.on(["create.start","shape.move.start"],I,(function(t){var n=t.context,i=n.shape,o=e.getRootElement();if((0,d.is)(i,"bpmn:Participant")&&(0,d.is)(o,"bpmn:Process")&&o.children.length){var a=o.children.filter((function(e){return!(0,d.is)(e,"bpmn:Group")&&!(0,c.j_)(e)&&!function(e){return!!e.waypoints}(e)}));if(a.length){var u=(0,k.jY)(a),l=function(e,t){t={width:t.width+40+30,height:t.height+40};var n=Math.max(e.width,t.width),i=Math.max(e.height,t.height);return{x:-n/2,y:-i/2,width:n,height:i}}(i,u);(0,s.f0)(i,l),n.createConstraints=function(e,t){return{bottom:(t=(0,r.JA)(t)).top+e.height/2-20,left:t.right-e.width/2+20,top:t.bottom-e.height/2+20,right:t.left+e.width/2-20-30}}(i,u)}}})),t.on("create.start",I,(function(n){var i=n.context.shape,o=e.getRootElement(),r=e.getGraphics(o);function a(e){e.element=o,e.gfx=r}(0,d.is)(i,"bpmn:Participant")&&(0,d.is)(o,"bpmn:Process")&&(t.on("element.hover",I,a),t.once("create.cleanup",(function(){t.off("element.hover",a)})))})),this.preExecute("shape.create",(function(e){var t=e.parent,n=e.shape;(0,d.is)(n,"bpmn:Participant")&&(0,d.is)(t,"bpmn:Process")&&i(e)}),!0),this.execute("shape.create",(function(e){var t=e.process,n=e.shape;t&&(e.oldProcessRef=n.businessObject.processRef,n.businessObject.processRef=t.businessObject)}),!0),this.revert("shape.create",(function(e){var t=e.process,n=e.shape;t&&(n.businessObject.processRef=e.oldProcessRef)}),!0),this.postExecute("shape.create",(function(e){var t=e.process,i=e.shape;if(t){var o=t.children.slice();n.moveElements(o,{x:0,y:0},i)}}),!0),this.preExecute("elements.create",I,(function(e){var t,n=e.elements,o=e.parent;W(n)&&(0,d.is)(o,"bpmn:Process")&&(i(e),t=W(n),e.oldProcessRef=t.businessObject.processRef,t.businessObject.processRef=o.businessObject)}),!0),this.revert("elements.create",(function(e){var t=e.elements;e.process&&(W(t).businessObject.processRef=e.oldProcessRef)}),!0),this.postExecute("elements.create",(function(e){var t,i=e.elements,o=e.process;if(o){t=W(i);var r=o.children.slice();n.moveElements(r,{x:0,y:0},t)}}),!0)}function W(e){return(0,s.sE)(e,(function(e){return(0,d.is)(e,"bpmn:Participant")}))}F.$inject=["canvas","eventBus","modeling"],o()(F,u);var z="__targetRef_placeholder";function N(e,t){function n(e,n){var i=e.get("properties"),o=(0,s.sE)(i,(function(e){return e.name===z}));return!o&&n&&(o=t.create("bpmn:Property",{name:z}),(0,E.IH)(i,o)),o}function i(e,t){var i=n(e);i&&(function(e,t,n){var i=e.get("dataInputAssociations");return(0,s.sE)(i,(function(e){return e!==n&&e.targetRef===t}))}(e,i,t)||(0,E.Od)(e.get("properties"),i))}function o(e){var t,o=e.context,r=o.connection,a=r.businessObject,c=r.target,s=c&&c.businessObject,u=o.newTarget,l=u&&u.businessObject,p=o.oldTarget||o.target,h=p&&p.businessObject,d=r.businessObject;h&&h!==s&&i(h,a),l&&l!==s&&i(l,a),s?(t=n(s,!0),d.targetRef=t):d.targetRef=null}u.call(this,e),this.executed(["connection.create","connection.delete","connection.move","connection.reconnect"],H(o)),this.reverted(["connection.create","connection.delete","connection.move","connection.reconnect"],H(o))}function H(e){return function(t){var n=t.context.connection;if((0,d.is)(n,"bpmn:DataInputAssociation"))return e(t)}}function Z(e){this._bpmnUpdater=e}function G(e,t,n,i){function o(e){return e.children.filter((function(e){return(0,d.is)(e,"bpmn:DataStoreReference")&&!e.labelTarget}))}function r(e,i){var o=e.businessObject||e;if(i=i||n.filter((function(e){return(0,d.is)(e,"bpmn:Participant")&&(0,d.S)(e).processRef}))[0]){var r=i.businessObject||i;t.execute("dataStore.updateContainment",{dataStoreBo:o,newSemanticParent:r.processRef||r,newDiParent:r.di})}}u.call(this,i),t.registerHandler("dataStore.updateContainment",Z),this.preExecute("shape.create",(function(e){var t=e.context,n=t.shape;(0,d.is)(n,"bpmn:DataStoreReference")&&"label"!==n.type&&(t.hints||(t.hints={}),t.hints.autoResize=!1)})),this.preExecute("elements.move",(function(e){var t=e.context,n=t.shapes;n.filter((function(e){return(0,d.is)(e,"bpmn:DataStoreReference")})).length&&(t.hints||(t.hints={}),t.hints.autoResize=n.filter((function(e){return!(0,d.is)(e,"bpmn:DataStoreReference")})))})),this.postExecute("shape.create",(function(e){var t=e.context.shape,n=t.parent;(0,d.is)(t,"bpmn:DataStoreReference")&&"label"!==t.type&&(0,d.is)(n,"bpmn:Collaboration")&&r(t)})),this.postExecute("shape.move",(function(e){var t=e.context,n=t.shape,i=t.oldParent,o=n.parent;(0,d.is)(i,"bpmn:Collaboration")||(0,d.is)(n,"bpmn:DataStoreReference")&&"label"!==n.type&&(0,d.is)(o,"bpmn:Collaboration")&&r(n,(0,d.is)(i,"bpmn:Participant")?i:function(e,t){for(;e.parent;){if((0,d.is)(e.parent,"bpmn:Participant"))return e.parent;e=e.parent}}(i))})),this.postExecute("shape.delete",(function(t){var n=t.context.shape,i=e.getRootElement();v(n,["bpmn:Participant","bpmn:SubProcess"])&&(0,d.is)(i,"bpmn:Collaboration")&&o(i).filter((function(e){return function(e,t){for(var n=e.businessObject||e,i=t.businessObject||t;n.$parent;){if(n.$parent===i.processRef||i)return!0;n=n.$parent}return!1}(e,n)})).forEach((function(e){r(e)}))})),this.postExecute("canvas.updateRoot",(function(e){var t=e.context,n=t.oldRoot,i=t.newRoot;o(n).forEach((function(e){(0,d.is)(i,"bpmn:Process")&&r(e,i)}))}))}function U(e,t,n){u.call(this,e),this.postExecuted("shape.delete",500,(function(e){var t=e.context,i=t.hints,o=t.shape,r=t.oldParent;(0,d.is)(o,"bpmn:Lane")&&(i&&i.nested||function(e,t){var i,o,r,a=C(t),c=[],s=[];(0,k.om)(a,(function(t){return t.y>e.y?s.push(t):c.push(t),t.children})),a.length&&(i=s.length&&c.length?e.height/2:e.height,c.length&&(o=n.calculateAdjustments(c,"y",i,e.y-10),n.makeSpace(o.movingShapes,o.resizingShapes,{x:0,y:i},"s")),s.length&&(r=n.calculateAdjustments(s,"y",-i,e.y+e.height+10),n.makeSpace(r.movingShapes,r.resizingShapes,{x:0,y:-i},"n")))}(o,r))}))}function K(e,t){t.invoke(u,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",500,(function(e){var t=e.elements;t.filter((function(e){return V(e,e.host)})).map((function(e){return t.indexOf(e)})).forEach((function(i){e.elements[i]=n.replaceShape(t[i])}))}),!0),this.preExecute("elements.move",500,(function(e){var t=e.shapes,i=e.newHost;t.forEach((function(e,o){var r,a=e.host;V(e,(r=a,-1!==t.indexOf(r)?a:i))&&(t[o]=n.replaceShape(e))}))}),!0)}function V(e,t){return!(0,c.j_)(e)&&(0,d.is)(e,"bpmn:BoundaryEvent")&&!t}N.$inject=["eventBus","bpmnFactory"],o()(N,u),Z.$inject=["bpmnUpdater"],Z.prototype.execute=function(e){var t=e.dataStoreBo,n=e.newSemanticParent,i=e.newDiParent;e.oldSemanticParent=t.$parent,e.oldDiParent=t.di.$parent,this._bpmnUpdater.updateSemanticParent(t,n),this._bpmnUpdater.updateDiParent(t.di,i)},Z.prototype.revert=function(e){var t=e.dataStoreBo,n=e.oldSemanticParent,i=e.oldDiParent;this._bpmnUpdater.updateSemanticParent(t,n),this._bpmnUpdater.updateDiParent(t.di,i)},G.$inject=["canvas","commandStack","elementRegistry","eventBus"],o()(G,u),U.$inject=["eventBus","modeling","spaceTool"],o()(U,u),K.$inject=["bpmnReplace","injector"],o()(K,u),K.prototype.replaceShape=function(e){var t,n,i,o=(n=e,(i=(0,d.S)(n).eventDefinitions)&&i[0]);return t=o?{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:o.$type}:{type:"bpmn:IntermediateThrowEvent"},this._bpmnReplace.replaceElement(e,t,{layoutConnection:!1})};var q=n(349),Y=n(868),J=n.n(Y),X=Math.round,Q=Math.max;function ee(e,t){return function(e,t){var n,i;for(n=0;i=e[n];n++)if((0,q.tW)(i,t)<=10)return{point:e[n],bendpoint:!0,index:n};return null}(e,t)||function(e,t){var n,i,o,r,a=J()((o=10,[["M",(i=t).x,i.y],["m",0,-o],["a",o,o,0,1,1,0,20],["a",o,o,0,1,1,0,-20],["z"]]),(n=[],e.forEach((function(e,t){n.push([0===t?"M":"L",e.x,e.y])})),n)),c=a[0],s=a[a.length-1];return c?c!==s?c.segment2!==s.segment2?{point:e[r=Q(c.segment2,s.segment2)-1],bendpoint:!0,index:r}:{point:{x:X(c.x+s.x)/2,y:X(c.y+s.y)/2},index:c.segment2}:{point:{x:X(c.x),y:X(c.y)},index:c.segment2}:null}(e,t)}function te(e,t,n){function i(e,i,o){var a,c,u,l,p,h,d,f,m=i.waypoints,v=e.outgoing.slice(),y=e.incoming.slice(),g=ee(m,f=(0,s.hj)(o.width)?(0,r.wS)(o):o);if(g){if(a=m.slice(0,g.index),c=m.slice(g.index+(g.bendpoint?1:0)),!a.length||!c.length)return;u=g.bendpoint?m[g.index]:f,ne(e,a[a.length-1])||a.push(ie(u)),ne(e,c[0])||c.unshift(ie(u))}l=i.source,p=i.target,t.canConnect(l,e,i)&&(n.reconnectEnd(i,e,a||f),h=i),t.canConnect(e,p,i)&&(h?d=n.connect(e,p,{type:i.type,waypoints:c}):(n.reconnectStart(i,e,c||f),d=i));var x=[].concat(h&&(0,s.hX)(y,(function(e){return e.source===h.source}))||[],d&&(0,s.hX)(v,(function(e){return e.target===d.target}))||[]);x.length&&n.removeElements(x)}u.call(this,e),this.preExecute("elements.move",(function(e){var n=e.newParent,i=e.shapes,o=e.delta,a=i[0];if(a&&n){n&&n.waypoints&&(e.newParent=n=n.parent);var c=(0,r.wS)(a),u={x:c.x+o.x,y:c.y+o.y},l=(0,s.sE)(n.children,(function(e){return t.canInsert(i,e)&&ee(e.waypoints,u)}));l&&(e.targetFlow=l,e.position=u)}}),!0),this.postExecuted("elements.move",(function(e){var t=e.shapes,n=e.targetFlow,o=e.position;n&&i(t[0],n,o)}),!0),this.preExecute("shape.create",(function(e){var n=e.parent,i=e.shape;t.canInsert(i,n)&&(e.targetFlow=n,e.parent=n.parent)}),!0),this.postExecuted("shape.create",(function(e){var t=e.shape,n=e.targetFlow,o=e.position;n&&i(t,n,o)}),!0)}function ne(e,t){var n=t.x,i=t.y;return n>=e.x&&n<=e.x+e.width&&i>=e.y&&i<=e.y+e.height}function ie(e){return(0,s.f0)({},e)}function oe(e,t){u.call(this,e),this.preExecuted("connection.create",(function(e){var n=e.context,i=n.source,o=n.target,r=o.incoming.slice();n.hints&&!1===n.hints.createElementsBehavior||(0,d.is)(i,"bpmn:EventBasedGateway")&&o.incoming.length&&r.filter(re).forEach((function(e){t.removeConnection(e)}))})),this.preExecuted("shape.replace",(function(e){var n=e.context.newShape;(0,d.is)(n,"bpmn:EventBasedGateway")&&n.outgoing.filter(re).map((function(e){return e.target})).reduce((function(e,t){var n=t.incoming.filter(re);return e.concat(n)}),[]).forEach((function(e){e.source!==n&&t.removeConnection(e)}))}))}function re(e){return(0,d.is)(e,"bpmn:SequenceFlow")}function ae(e,t){var n=t.create("bpmn:CategoryValue"),i=t.create("bpmn:Category",{categoryValue:[n]});return(0,E.IH)(e.get("rootElements"),i),(0,d.S)(i).$parent=e,(0,d.S)(n).$parent=i,n}function ce(e,t,n,i,o,r){function a(){var e=t.getRootElement();return(0,d.S)(e).$parent}function c(e){var t=(0,d.S)(e).categoryValueRef;if(t){var n=t.$parent;t&&((0,E.Od)(n.categoryValue,t),n&&!n.categoryValue.length&&function(e){var t=a();(0,E.Od)(t.get("rootElements"),e)}(n))}}o.invoke(u,this),this.executed("shape.delete",(function(e){var t,i=e.context.shape;if((0,d.is)(i,"bpmn:Group")){var o=(0,d.S)(i).categoryValueRef,r=n.filter((function(e){return(0,d.is)(e,"bpmn:Group")}));t=o,r.some((function(e){var n=(0,d.S)(e);return n.categoryValueRef&&n.categoryValueRef===t}))||c(i)}})),this.reverted("shape.delete",(function(e){var t=e.context.shape;if((0,d.is)(t,"bpmn:Group")){var n=(0,d.S)(t).categoryValueRef,i=a(),o=n?n.$parent:null;(0,E.IH)(o.get("categoryValue"),n),(0,E.IH)(i.get("rootElements"),o)}})),this.execute("shape.create",(function(t){var n=t.context.shape,i=(0,d.S)(n);if((0,d.is)(i,"bpmn:Group")&&!i.categoryValueRef){var o=ae(a(),e);i.categoryValueRef=o}})),this.revert("shape.create",(function(e){var t=e.context.shape;(0,d.is)(t,"bpmn:Group")&&(c(t),delete(0,d.S)(t).categoryValueRef)})),i.on("moddleCopy.canCopyProperty",2e3,(function(t){var n,i=t.property;if((0,d.is)(i,"bpmn:CategoryValue"))return n=ae(a(),e),r.copyElement(i,n)}))}function se(e,t,n,i){var o,r,a,c;return 0==(o=(i.y-n.y)*(t.x-e.x)-(i.x-n.x)*(t.y-e.y))?null:(r=e.y-n.y,a=e.x-n.x,c=((i.x-n.x)*r-(i.y-n.y)*a)/o,{x:Math.round(e.x+c*(t.x-e.x)),y:Math.round(e.y+c*(t.y-e.y))})}function ue(e){function t(e,t,n){var i,o={x:n.x,y:n.y-50},r={x:n.x-50,y:n.y},a=se(e,t,n,o),c=se(e,t,n,r);i=a&&c?le(a,n)>le(c,n)?c:a:a||c,e.original=i}e.on("bpmnElement.added",(function(e){var n,i,o=e.element;o.waypoints&&(t((i=(n=o).waypoints)[0],i[1],(0,r.wS)(n.source)),t(i[i.length-1],i[i.length-2],(0,r.wS)(n.target)))}))}function le(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function pe(e){u.call(this,e);var t=["bpmn:Participant","bpmn:Lane"];this.executed(["shape.move","shape.create","shape.resize"],(function(e){var n=(0,d.S)(e.context.shape);v(n,t)&&!n.di.get("isHorizontal")&&n.di.set("isHorizontal",!0)}))}o()(te,u),te.$inject=["eventBus","bpmnRules","modeling"],oe.$inject=["eventBus","modeling"],o()(oe,u),ce.$inject=["bpmnFactory","canvas","elementRegistry","eventBus","injector","moddleCopy"],o()(ce,u),ue.$inject=["eventBus"],pe.$inject=["eventBus"],o()(pe,u);var he=n(635);function de(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function fe(e){return Math.atan((e[1].y-e[0].y)/(e[1].x-e[0].x))}function me(e,t){var n=t[0],i=t[1],o={x:i.x-n.x,y:i.y-n.y},r=function(e,t,n){var i=[{n:e[0]-n[0],lambda:t[0]},{n:e[1]-n[1],lambda:t[1]}];return-(i[0].n*t[0]+i[1].n*t[1])/(i[0].lambda*t[0]+i[1].lambda*t[1])}([n.x,n.y],[o.x,o.y],[e.x,e.y]);return{x:n.x+r*o.x,y:n.y+r*o.y}}function ve(e,t){var n=me(e,t);return de({x:n.x-e.x,y:n.y-e.y})}function ye(e,t){return de({x:e.x-t.x,y:e.y-t.y})}var ge=Math.sqrt,xe=Math.min,be=Math.max,Ee=Math.abs;function we(e){return Math.pow(e,2)}function _e(e,t){return ge(we(e.x-t.x)+we(e.y-t.y))}function Se(e,t,n,i){var o=t.x-e.x,r=t.y-e.y,a=n.x-e.x,c=n.y-e.y,s=o*o+r*r,u=(o*a+r*c)/s,l=u*u-(a*a+c*c-i*i)/s;if(l<0&&l>-1e-6&&(l=0),l<0)return[];var p=ge(l),h=-u+p,d=-u-p,f={x:e.x-o*h,y:e.y-r*h};return 0===l?[f]:[f,{x:e.x-o*d,y:e.y-r*d}].filter((function(n){return function(e,t,n){return ke(e.x,t.x,n.x)&&ke(e.y,t.y,n.y)}(n,e,t)}))}function ke(e,t,n){return e>=xe(t,n)-Re&&e<=be(t,n)+Re}var Re=.1;function je(e,t){return Ee(e.x-t.x)<=Re&&Ee(e.y-t.y)<=Re}function Pe(e,t){var n=ye(e[t-1],e[t]);return n/(n+ye(e[t],e[t+1]))}function Me(e,t){return[e[t],e[t+1]]}function Be(e,t,n){var i=(0,a.b)(t),o=(0,a.b)(n),c=(0,a.p)(e,i),s=c.x*(n.width/t.width),u=c.y*(n.height/t.height);return(0,r.ex)({x:o.x+s,y:o.y+u})}function Te(e,t,n){var i=(0,a.b)(e),o=(0,a.b)(t),c=(0,a.b)(n),s=(0,a.p)(e,i),u=(0,a.p)(i,o),l=function(e,t,n){var i=(0,r.JA)(t),o=(0,r.JA)(n);if(function(e,t){return function(e,t){return e.right!==t.right&&e.left!==t.left}(e,t)||function(e,t){return e.top!==t.top&&e.bottom!==t.bottom}(e,t)}(i,o))return null;var a,c,s=(0,r.T8)(t,e);if("top"===s)a={x:0,y:o.bottom-i.bottom};else if("bottom"===s)a={x:0,y:o.top-i.top};else if("right"===s)a={x:o.left-i.left,y:0};else{if("left"!==s)return null;a={x:o.right-i.right,y:0}}return c={x:e.x+a.x,y:e.y+a.y},(0,r.T8)(n,c)!==s?null:a}(i,t,n);if(l)return l;var p=u.x*(n.width/t.width),h=u.y*(n.height/t.height),d=c.x+p,f=c.y+h;return(0,r.ex)({x:d+s.x-e.x,y:f+s.y-e.y})}var De={width:90,height:20};function Ce(e,t,n,i){u.call(this,e),this.postExecute("element.updateProperties",(function(e){var n=e.context,o=n.element,r=n.properties;if("name"in r&&t.updateLabel(o,r.name),"text"in r&&(0,d.is)(o,"bpmn:TextAnnotation")){var a=i.getTextAnnotationBounds({x:o.x,y:o.y,width:o.width,height:o.height},r.text||"");t.updateLabel(o,r.text,a)}})),this.postExecute(["shape.create","connection.create"],(function(e){var n=e.context;if(!1!==(n.hints||{}).createElementsBehavior){var o=n.shape||n.connection,r=o.businessObject;if(!(0,c.j_)(o)&&(0,c.ly)(o)&&(0,he.i)(o)){var a=(0,c.qe)(o),s=i.getExternalLabelBounds(De,(0,he.i)(o));t.createLabel(o,a,{id:r.id+"_label",businessObject:r,width:s.width,height:s.height})}}})),this.postExecute("shape.delete",(function(e){var n=e.context,i=n.labelTarget,o=n.hints||{};i&&!1!==o.unsetLabel&&t.updateLabel(i,null,null,{removeShape:!1})})),this.postExecute(["label.create"],(function(e){var t,i=e.context.shape;i.labelTarget&&(0,d.is)(i.labelTarget||i,"bpmn:BaseElement")&&((t=i.businessObject.di).label||(t.label=n.create("bpmndi:BPMNLabel",{bounds:n.create("dc:Bounds")})),(0,s.f0)(t.label.bounds,{x:i.x,y:i.y,width:i.width,height:i.height}))})),this.postExecute(["connection.layout","connection.updateWaypoints"],(function(e){var n=e.context;if(!1!==(n.hints||{}).labelBehavior){var i,o=n.connection.label;o&&o.parent&&(i=function(e){var t=e.context,n=t.connection,i=n.label,o=(0,s.f0)({},t.hints),a=t.newWaypoints||n.waypoints,c=t.oldWaypoints;return void 0===o.startChanged&&(o.startChanged=!!o.connectionStart),void 0===o.endChanged&&(o.endChanged=!!o.connectionEnd),function(e,t,n,i){var o=0,a=0,c=function(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}(e),s=function(e,t){var n,i,o,r,a,c,s,u,l,p,h,d,f=0;for(f=0;f<t.length-1;f++){if(je(n=t[f],i=t[f+1])?c=[n]:(o=_e(e,n),r=_e(e,i),c=Se(n,i,e,xe(o,r))),c.length<1)throw new Error("expected between [1, 2] circle -> line intersections");1===c.length&&(s={type:"bendpoint",position:c[0],segmentIndex:f,bendpointIndex:je(n,c[0])?f:f+1}),2===c.length&&(h=c[0],d=c[1],s={type:"segment",position:a={x:(h.x+d.x)/2,y:(h.y+d.y)/2},segmentIndex:f,relativeLocation:_e(n,a)/_e(n,i)}),u=_e(s.position,e),(!p||l>u)&&(p=s,l=u)}return p}(c,n),u=s.segmentIndex,l=function(e,t,n,i){var o=n.segmentIndex,r=t.length-e.length;if(i.segmentMove){var a=i.segmentMove.segmentStartIndex,c=i.segmentMove.newSegmentStartIndex;return o===a?c:o>=c?o+r<c?c:o+r:o}if(i.bendpointMove){var s,u=i.bendpointMove.insert,l=i.bendpointMove.bendpointIndex;return 0===r?o:(o>=l&&(s=u?o+1:o-1),o<l&&(s=o,u&&"bendpoint"!==n.type&&l-1===o&&Pe(t,l)<n.relativeLocation&&s++),s)}return 0===r?o:i.connectionStart?0===o?0:null:i.connectionEnd&&o===e.length-2?t.length-2:null}(n,t,s,i);if(null===l)return{x:o,y:a};if(l<0||l>t.length-2)return{x:o,y:a};var p,h,d,f,m,v,y=Me(n,u),g=Me(t,l),x=s.position,b=(f=x,m=ye((d=y)[0],d[1]),v=ye(d[0],f),0===m?0:v/m),E=(p=g,h=fe(y),fe(p)-h);if("bendpoint"===s.type){var w=t.length-n.length,_=s.bendpointIndex,S=n[_];if(-1!==t.indexOf(S))return{x:o,y:a};if(0===w){var k=t[_];return{x:k.x-s.position.x,y:k.y-s.position.y}}w<0&&0!==_&&_<n.length-1&&(b=Pe(n,_))}var R,j,P=(g[1].x-g[0].x)*b+g[0].x,M=(g[1].y-g[0].y)*b+g[0].y,B=(R={x:c.x-x.x,y:c.y-x.y},(j=E)?{x:Math.cos(j)*R.x-Math.sin(j)*R.y,y:Math.sin(j)*R.x+Math.cos(j)*R.y}:R);return o=P+B.x-c.x,a=M+B.y-c.y,(0,r.ex)({x:o,y:a})}(i,a,c,o)}(e),t.moveShape(o,i))}})),this.postExecute(["shape.replace"],(function(e){var t=e.context,n=t.newShape,i=t.oldShape,o=(0,d.S)(n);o&&(0,c.ly)(o)&&i.label&&n.label&&(n.label.x=i.label.x,n.label.y=i.label.y)})),this.postExecute("shape.resize",(function(e){var n,i=e.context,o=i.shape,u=i.newBounds,l=i.oldBounds;if((0,c.fF)(o)){var p=o.label,h=function(e,t,n){var i=Be(e,t,n);return(0,r.ex)((0,a.p)(i,e))}(function(e,t){if(t.length)return me(e,function(e,t){var n=t.map((function(t){return{line:t,distance:ve(e,t)}}));return(0,s.MR)(n,"distance")[0].line}(e,t))}((0,r.wS)(p),[[{x:(n=l).x,y:n.y},{x:n.x+(n.width||0),y:n.y}],[{x:n.x+(n.width||0),y:n.y},{x:n.x+(n.width||0),y:n.y+(n.height||0)}],[{x:n.x,y:n.y+(n.height||0)},{x:n.x+(n.width||0),y:n.y+(n.height||0)}],[{x:n.x,y:n.y},{x:n.x,y:n.y+(n.height||0)}]]),l,u);t.moveShape(p,h)}}))}function Ae(e,t,n){var i=Fe(e),o=We(i,t),r=i[0];return o.length?o[o.length-1]:Be(r.original||r,n,t)}function Oe(e,t,n){var i=Fe(e),o=We(i,t),r=i[i.length-1];return o.length?o[0]:Be(r.original||r,n,t)}function Le(e,t,n){var i=Fe(e),o=Ie(t,n),r=i[0];return Be(r.original||r,o,t)}function $e(e,t,n){var i=Fe(e),o=Ie(t,n),r=i[i.length-1];return Be(r.original||r,o,t)}function Ie(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}}function Fe(e){var t=e.waypoints;if(!t.length)throw new Error("connection#"+e.id+": no waypoints");return t}function We(e,t){var n=(0,s.UI)(e,ze);return(0,s.hX)(n,(function(e){return function(e,t){return"intersect"===(0,r.T8)(t,e,1)}(e,t)}))}function ze(e){return e.original||e}function Ne(e,t){u.call(this,e),this.postExecute("shape.replace",(function(e){var n=e.oldShape,i=e.newShape;if(function(e,t){return(0,d.is)(e,"bpmn:Participant")&&(0,w.ul)(e)&&(0,d.is)(t,"bpmn:Participant")&&!(0,w.ul)(t)}(n,i)){var o,r,a,c,s=(o=n,r=(0,k.PB)([o],!1),a=[],c=[],r.forEach((function(e){e!==o&&(e.incoming.forEach((function(e){(0,d.is)(e,"bpmn:MessageFlow")&&a.push(e)})),e.outgoing.forEach((function(e){(0,d.is)(e,"bpmn:MessageFlow")&&c.push(e)})))}),[]),{incoming:a,outgoing:c});s.incoming.forEach((function(e){var o=Oe(e,i,n);t.reconnectEnd(e,i,o)})),s.outgoing.forEach((function(e){var o=Ae(e,i,n);t.reconnectStart(e,i,o)}))}}),!0)}function He(e,t,n){e.on(["shape.move.rejected","create.rejected"],(function(e){var i,o,r=e.context,a=r.shape,c=r.target;(0,d.is)(c,"bpmn:Collaboration")&&(0,d.is)(a,"bpmn:FlowNode")&&(i=e,o=n("flow elements must be children of pools/participants"),t.add({position:{x:i.x+5,y:i.y+5},type:"error",timeout:2e3,html:"<div>"+o+"</div>"}))}))}function Ze(e,t,n,i){u.call(this,e);var o=i.get("dragging",!1);function r(e){var i,o,r=e.source,a=e.target;e.parent&&((0,d.is)(e,"bpmn:SequenceFlow")&&(n.canConnectSequenceFlow(r,a)||(o=!0),n.canConnectMessageFlow(r,a)&&(i="bpmn:MessageFlow")),(0,d.is)(e,"bpmn:MessageFlow")&&(n.canConnectMessageFlow(r,a)||(o=!0),n.canConnectSequenceFlow(r,a)&&(i="bpmn:SequenceFlow")),(0,d.is)(e,"bpmn:Association")&&!n.canConnectAssociation(r,a)&&(o=!0),o&&t.removeConnection(e),i&&t.connect(r,a,{type:i,waypoints:e.waypoints.slice()}))}this.postExecuted("elements.move",(function(e){var t=e.closure.allConnections;(0,s.Ed)(t,r)}),!0),this.preExecute("connection.reconnect",(function(e){var i,r,a=e.context,c=a.connection,s=a.newSource||c.source,u=a.newTarget||c.target;(i=n.canConnect(s,u))&&i.type!==c.type&&(r=t.connect(s,u,{type:i.type,waypoints:c.waypoints.slice()}),t.removeConnection(c),a.connection=r,o&&function(e,t){var n,i=o.context(),r=i&&i.payload.previousSelection;r&&r.length&&-1!==(n=r.indexOf(e))&&r.splice(n,1,t)}(c,r))})),this.postExecuted("element.updateProperties",(function(e){var n,i=e.context,o=i.properties,r=i.element,a=r.businessObject;o.default&&(n=(0,s.sE)(r.outgoing,(0,s.KQ)({id:r.businessObject.default.id})))&&t.updateProperties(n,{conditionExpression:void 0}),o.conditionExpression&&a.sourceRef.default===a&&t.updateProperties(r.source,{default:void 0})}))}function Ge(e,t){u.call(this,e),this.preExecute("shape.delete",(function(e){var t=e.shape,n=t.parent;(0,d.is)(t,"bpmn:Participant")&&(e.collaborationRoot=n)}),!0),this.postExecute("shape.delete",(function(e){var n=e.collaborationRoot;n&&!n.businessObject.participants.length&&t.makeProcess()}),!0)}function Ue(e,t,n,i,o,r){i.invoke(u,this),this._bpmnReplace=e,this._elementRegistry=n,this._selection=r,this.postExecuted(["elements.create"],500,(function(e){var n=e.context,i=n.parent,o=n.elements,r=t.canReplace(o,i);r&&this.replaceElements(o,r.replacements)}),this),this.postExecuted(["elements.move"],500,(function(e){var n=e.context,i=n.newParent,o=n.newHost,r=[];(0,s.Ed)(n.closure.topLevel,(function(e){r=(0,w.J5)(e)?r.concat(e.children):r.concat(e)})),1===r.length&&o&&(i=o);var a=t.canReplace(r,i);a&&this.replaceElements(r,a.replacements,o)}),this),this.postExecute(["shape.replace"],1500,(function(e){var n,i=e.context,o=i.oldShape,r=i.newShape,a=o.attachers;a&&a.length&&(n=t.canReplace(a,r),this.replaceElements(a,n.replacements))}),this),this.postExecuted(["shape.replace"],1500,(function(e){var t=e.context,n=t.oldShape,i=t.newShape;o.unclaimId(n.businessObject.id,n.businessObject),o.updateProperties(i,{id:n.id})}))}o()(Ce,u),Ce.$inject=["eventBus","modeling","bpmnFactory","textRenderer"],Ne.$inject=["eventBus","modeling"],o()(Ne,u),He.$inject=["eventBus","tooltips","translate"],o()(Ze,u),Ze.$inject=["eventBus","modeling","bpmnRules","injector"],Ge.$inject=["eventBus","modeling"],o()(Ge,u),o()(Ue,u),Ue.prototype.replaceElements=function(e,t){var n=this._elementRegistry,i=this._bpmnReplace,o=this._selection;(0,s.Ed)(t,(function(t){var o={type:t.newElementType},r=n.get(t.oldElementId),a=e.indexOf(r);e[a]=i.replaceElement(r,o,{select:!1})})),t&&o.select(e)},Ue.$inject=["bpmnReplace","bpmnRules","elementRegistry","injector","modeling","selection"];var Ke=Math.abs,Ve=Math.min,qe=Math.max;function Ye(e,t,n,i){var o=e[t];e[t]=void 0===o?n:i(n,o)}function Je(e,t,n){return Ye(e,t,n,Ve)}function Xe(e,t,n){return Ye(e,t,n,qe)}var Qe=300,et=60,tt={width:300,height:150},nt={width:140,height:120},it={width:50,height:30};function ot(e){e.on("resize.start",1500,(function(e){var t=e.context,n=t.shape,i=t.direction,o=t.balanced;((0,d.is)(n,"bpmn:Lane")||(0,d.is)(n,"bpmn:Participant"))&&(t.resizeConstraints=function(e,t,n){var i=A(e),o=!0,a=!0,c=D(i,[i]),s=(0,r.JA)(e),u={},l={};return/e/.test(t)?l.right=s.left+Qe:/w/.test(t)&&(l.left=s.right-Qe),c.forEach((function(e){var i=(0,r.JA)(e);/n/.test(t)&&(i.top<s.top-10&&(o=!1),n&&Ke(s.top-i.bottom)<10&&Xe(u,"top",i.top+et),Ke(s.top-i.top)<5&&Je(l,"top",i.bottom-et)),/s/.test(t)&&(i.bottom>s.bottom+10&&(a=!1),n&&Ke(s.bottom-i.top)<10&&Je(u,"bottom",i.bottom-et),Ke(s.bottom-i.bottom)<5&&Xe(l,"bottom",i.top+et))})),i.children.filter((function(e){return!e.hidden&&!e.waypoints&&((0,d.is)(e,"bpmn:FlowElement")||(0,d.is)(e,"bpmn:Artifact"))})).forEach((function(e){var n=(0,r.JA)(e);o&&/n/.test(t)&&Je(l,"top",n.top-20),/e/.test(t)&&Xe(l,"right",n.right+20),a&&/s/.test(t)&&Xe(l,"bottom",n.bottom+20),/w/.test(t)&&Je(l,"left",n.left-50)})),{min:l,max:u}}(n,i,o)),(0,d.is)(n,"bpmn:Participant")&&(t.minDimensions=tt),(0,d.is)(n,"bpmn:SubProcess")&&(0,w.ul)(n)&&(t.minDimensions=nt),(0,d.is)(n,"bpmn:TextAnnotation")&&(t.minDimensions=it)}))}ot.$inject=["eventBus"];var rt=n(157);function at(e,t){e.on("resize.start",1501,(function(e){var t=e.context,n=t.shape;((0,d.is)(n,"bpmn:Lane")||(0,d.is)(n,"bpmn:Participant"))&&(t.balanced=!(0,rt.RJ)(e))})),e.on("resize.end",1001,(function(e){var n=e.context,i=n.shape,o=n.canExecute,a=n.newBounds;if((0,d.is)(i,"bpmn:Lane")||(0,d.is)(i,"bpmn:Participant"))return o&&(a=(0,r.aR)(a),t.resizeLane(i,a,n.balanced)),!1}))}function ct(e,t,n){u.call(this,e),this.preExecute("shape.delete",(function(e){var i,o,r,a=e.context.shape;if(1===a.incoming.length&&1===a.outgoing.length){var c=a.incoming[0],s=a.outgoing[0];if((0,d.is)(c,"bpmn:SequenceFlow")&&(0,d.is)(s,"bpmn:SequenceFlow")&&t.canConnect(c.source,s.target,c)){var u=(i=c.waypoints,o=s.waypoints,(r=se(st(i[i.length-2]),st(i[i.length-1]),st(o[1]),st(o[0])))?[].concat(i.slice(0,i.length-1),[r],o.slice(1)):[st(i[0]),st(o[o.length-1])]);n.reconnectEnd(c,s.target,u)}}}))}function st(e){return e.original||e}at.$inject=["eventBus","modeling"],o()(ct,u),ct.$inject=["eventBus","bpmnRules","modeling"];var ut=Math.max;function lt(e){e.on("spaceTool.getMinDimensions",(function(e){var t=e.shapes,n=e.axis,i=e.start,o={};return(0,s.Ed)(t,(function(e){var t=e.id;(0,d.is)(e,"bpmn:Participant")&&(function(e){return"x"===e}(n)?o[t]=tt:o[t]={width:tt.width,height:pt(e,i)}),(0,d.is)(e,"bpmn:SubProcess")&&(0,w.ul)(e)&&(o[t]=nt),(0,d.is)(e,"bpmn:TextAnnotation")&&(o[t]=it)})),o}))}function pt(e,t){var n;return C(e).length?(n=function(e,t){var n;return n=ht(C(e),t),e.height-n.height+et}(e,t),ut(tt.height,n)):tt.height}function ht(e,t){var n,i,o;for(n=0;n<e.length;n++)if(t>=(i=e[n]).y&&t<=i.y+i.height)return(o=C(i)).length?ht(o,t):i}function dt(e,t){e.invoke(u,this),this.postExecuted("shape.replace",(function(e){var n=e.context.oldShape,i=e.context.newShape;if((0,d.is)(i,"bpmn:SubProcess")&&(0,d.is)(n,"bpmn:Task")&&(0,w.ul)(i)){var o,r={x:(o=i).x+o.width/6,y:o.y+o.height/2};t.createShape({type:"bpmn:StartEvent"},r,i)}}))}function ft(e,t,n,i){u.call(this,e),this.executed(["shape.toggleCollapse"],500,(function(e){var t,n=e.context.shape;(0,d.is)(n,"bpmn:SubProcess")&&(n.collapsed?(0,d.S)(n).di.isExpanded=!1:((t=n.children).length&&t.forEach((function(e){"label"!==e.type||e.businessObject.name||(e.hidden=!0)})),(0,d.S)(n).di.isExpanded=!0))})),this.reverted(["shape.toggleCollapse"],500,(function(e){var t=e.context.shape;t.collapsed?(0,d.S)(t).di.isExpanded=!1:(0,d.S)(t).di.isExpanded=!0})),this.postExecuted(["shape.toggleCollapse"],500,(function(e){var i,o=e.context.shape,r=t._getDefaultSize(o);i=o.collapsed?function(e,t){return{x:e.x+(e.width-t.width)/2,y:e.y+(e.height-t.height)/2,width:t.width,height:t.height}}(o,r):function(e,t){var n,i,o=t;return(n=function(e,t){var n;if((n=void 0===e.length?(0,s.hX)(e.children,P):e).length)return function(e,t){var n,i,o,r;return"object"==typeof t?(n=j(t.left),i=j(t.right),o=j(t.top),r=j(t.bottom)):n=i=o=r=j(t),{x:e.x-n,y:e.y-o,width:e.width+n+i,height:e.height+o+r}}((0,k.jY)(n),t)}((i=e.children,i.filter((function(e){return!e.hidden}))).concat([e])))?(o.width=Math.max(n.width,o.width),o.height=Math.max(n.height,o.height),o.x=n.x+(n.width-o.width)/2,o.y=n.y+(n.height-o.height)/2):(o.x=e.x+(e.width-o.width)/2,o.y=e.y+(e.height-o.height)/2),o}(o,r),n.resizeShape(o,i,null,{autoResize:!o.collapsed&&"nwse"})}))}function mt(e,t,n,i){t.invoke(u,this),this.preExecute("shape.delete",(function(e){var t=e.context.shape,o=t.businessObject;(0,c.j_)(t)||((0,d.is)(t,"bpmn:Participant")&&(0,w.ul)(t)&&n.ids.unclaim(o.processRef.id),i.unclaimId(o.id,o))})),this.preExecute("connection.delete",(function(e){var t=e.context.connection.businessObject;i.unclaimId(t.id,t)})),this.preExecute("canvas.updateRoot",(function(){var t=e.getRootElement().businessObject;n.ids.unclaim(t.id)}))}function vt(e,t,n){var i;u.call(this,e);var o=["spaceTool","lane.add","lane.resize","lane.split","elements.create","elements.delete","elements.move","shape.create","shape.delete","shape.move","shape.resize"];this.preExecute(o,5e3,(function(e){(i=i||new yt).enter()})),this.postExecuted(o,500,(function(e){!function(){if(!i)throw new Error(n("out of bounds release"));i.leave()&&(t.updateLaneRefs(i.flowNodes,i.lanes),i=null)}()})),this.preExecute(["shape.create","shape.move","shape.delete","shape.resize"],(function(e){var t=e.context.shape,o=function(){if(!i)throw new Error(n("out of bounds release"));return i}();t.labelTarget||((0,d.is)(t,"bpmn:Lane")&&o.addLane(t),(0,d.is)(t,"bpmn:FlowNode")&&o.addFlowNode(t))}))}function yt(){this.flowNodes=[],this.lanes=[],this.counter=0,this.addLane=function(e){this.lanes.push(e)},this.addFlowNode=function(e){this.flowNodes.push(e)},this.enter=function(){this.counter++},this.leave=function(){return this.counter--,!this.counter}}function gt(e,t){u.call(this,e),this.preExecute("connection.delete",(function(e){var n=e.context.connection,i=n.source;(function(e,t){if(!(0,d.is)(e,"bpmn:SequenceFlow"))return!1;var n=(0,d.S)(t),i=(0,d.S)(e);return n.get("default")===i})(n,i)&&t.updateProperties(i,{default:null})}))}lt.$inject=["eventBus"],dt.$inject=["injector","modeling"],o()(dt,u),o()(ft,u),ft.$inject=["eventBus","elementFactory","modeling"],o()(mt,u),mt.$inject=["canvas","injector","moddle","modeling"],vt.$inject=["eventBus","modeling","translate"],o()(vt,u),o()(gt,u),gt.$inject=["eventBus","modeling"];const xt={__init__:["adaptiveLabelPositioningBehavior","appendBehavior","associationBehavior","attachEventBehavior","boundaryEventBehavior","rootElementReferenceBehavior","createBehavior","fixHoverBehavior","createDataObjectBehavior","createParticipantBehavior","dataStoreBehavior","dataInputAssociationBehavior","deleteLaneBehavior","detachEventBehavior","dropOnFlowBehavior","eventBasedGatewayBehavior","groupBehavior","importDockingFix","isHorizontalFix","labelBehavior","messageFlowBehavior","modelingFeedback","removeElementBehavior","removeParticipantBehavior","replaceConnectionBehavior","replaceElementBehaviour","resizeBehavior","resizeLaneBehavior","toggleElementCollapseBehaviour","spaceToolBehavior","subProcessStartEventBehavior","unclaimIdBehavior","unsetDefaultFlowBehavior","updateFlowNodeRefsBehavior"],adaptiveLabelPositioningBehavior:["type",p],appendBehavior:["type",f],associationBehavior:["type",m],attachEventBehavior:["type",g],boundaryEventBehavior:["type",b],rootElementReferenceBehavior:["type",_],createBehavior:["type",S],fixHoverBehavior:["type",L],createDataObjectBehavior:["type",$],createParticipantBehavior:["type",F],dataInputAssociationBehavior:["type",N],dataStoreBehavior:["type",G],deleteLaneBehavior:["type",U],detachEventBehavior:["type",K],dropOnFlowBehavior:["type",te],eventBasedGatewayBehavior:["type",oe],groupBehavior:["type",ce],importDockingFix:["type",ue],isHorizontalFix:["type",pe],labelBehavior:["type",Ce],messageFlowBehavior:["type",Ne],modelingFeedback:["type",He],replaceConnectionBehavior:["type",Ze],removeParticipantBehavior:["type",Ge],replaceElementBehaviour:["type",Ue],resizeBehavior:["type",ot],resizeLaneBehavior:["type",at],removeElementBehavior:["type",ct],toggleElementCollapseBehaviour:["type",ft],spaceToolBehavior:["type",lt],subProcessStartEventBehavior:["type",dt],unclaimIdBehavior:["type",mt],updateFlowNodeRefsBehavior:["type",vt],unsetDefaultFlowBehavior:["type",gt]};function bt(e){this._commandStack=e.get("commandStack",!1)}bt.$inject=["injector"],bt.prototype.allowed=function(e,t){var n=!0,i=this._commandStack;return i&&(n=i.canExecute(e,t)),void 0===n||n};const Et={__init__:["rules"],rules:["type",bt]};function wt(e){u.call(this,e),this.init()}function _t(e){wt.call(this,e)}function St(e){return!e||(0,c.j_)(e)}function kt(e){do{if((0,d.is)(e,"bpmn:Process"))return(0,d.S)(e);if((0,d.is)(e,"bpmn:Participant"))return(0,d.S)(e).processRef||(0,d.S)(e)}while(e=e.parent)}function Rt(e){return(0,d.is)(e,"bpmn:TextAnnotation")}function jt(e){return(0,d.is)(e,"bpmn:Group")&&!e.labelTarget}function Pt(e){return(0,d.is)(e,"bpmn:BoundaryEvent")&&Tt(e,"bpmn:CompensateEventDefinition")}function Mt(e){return(0,d.S)(e).isForCompensation}function Bt(e){for(var t=e;t=t.parent;){if((0,d.is)(t,"bpmn:FlowElementsContainer"))return(0,d.S)(t);if((0,d.is)(t,"bpmn:Participant"))return(0,d.S)(t).processRef}return null}function Tt(e,t){var n=(0,d.S)(e);return!!(0,s.sE)(n.eventDefinitions||[],(function(e){return(0,d.is)(e,t)}))}function Dt(e,t){return((0,d.S)(e).eventDefinitions||[]).every((function(e){return(0,d.is)(e,t)}))}function Ct(e){return(0,d.is)(e,"bpmn:ReceiveTask")||(0,d.is)(e,"bpmn:IntermediateCatchEvent")&&(Tt(e,"bpmn:MessageEventDefinition")||Tt(e,"bpmn:TimerEventDefinition")||Tt(e,"bpmn:ConditionalEventDefinition")||Tt(e,"bpmn:SignalEventDefinition"))}function At(e){return e.waypoints}function Ot(e,t){return-1!==function(e){for(var t=[];e;)(e=e.parent)&&t.push(e);return t}(t).indexOf(e)}function Lt(e,t,n){if(St(e)||St(t))return null;if(!(0,d.is)(n,"bpmn:DataAssociation")){if(Vt(e,t))return{type:"bpmn:MessageFlow"};if(qt(e,t))return{type:"bpmn:SequenceFlow"}}return Yt(e,t)||(Pt(e)&&Mt(t)?{type:"bpmn:Association",associationDirection:"One"}:!!Kt(e,t)&&{type:"bpmn:Association"})}function $t(e,t,n){return!(!(0,c.j_)(e)&&!jt(e))||!((0,d.is)(t,"bpmn:Participant")&&!(0,w.ul)(t))&&((0,d.is)(e,"bpmn:Participant")?(0,d.is)(t,"bpmn:Process")||(0,d.is)(t,"bpmn:Collaboration"):v(e,["bpmn:DataInput","bpmn:DataOutput"])&&e.parent?t===e.parent:(0,d.is)(e,"bpmn:Lane")?(0,d.is)(t,"bpmn:Participant")||(0,d.is)(t,"bpmn:Lane"):!((0,d.is)(e,"bpmn:BoundaryEvent")&&(i=e,!(0,d.S)(i).cancelActivity||!Ft(i)&&!Wt(i)))&&((0,d.is)(e,"bpmn:FlowElement")&&!(0,d.is)(e,"bpmn:DataStoreReference")?(0,d.is)(t,"bpmn:FlowElementsContainer")?(0,w.ul)(t):v(t,["bpmn:Participant","bpmn:Lane"]):(0,d.is)(e,"bpmn:DataStoreReference")&&(0,d.is)(t,"bpmn:Collaboration")?(0,s.G)((0,d.S)(t).get("participants"),(function(e){return!!e.get("processRef")})):v(e,["bpmn:Artifact","bpmn:DataAssociation","bpmn:DataStoreReference"])?v(t,["bpmn:Collaboration","bpmn:Lane","bpmn:Participant","bpmn:Process","bpmn:SubProcess"]):!!(0,d.is)(e,"bpmn:MessageFlow")&&((0,d.is)(t,"bpmn:Collaboration")||e.source.parent==t||e.target.parent==t)));var i}function It(e){return(0,d.is)(e,"bpmn:Lane")}function Ft(e){var t=(0,d.S)(e);return t&&!(t.eventDefinitions&&t.eventDefinitions.length)}function Wt(e){return zt(e,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])}function zt(e,t){return t.some((function(t){return Tt(e,t)}))}function Nt(e,t,n,i){if(Array.isArray(e)||(e=[e]),1!==e.length)return!1;var o=e[0];return!(0,c.j_)(o)&&!!function(e){return!!function(e){return!(0,c.j_)(e)&&(0,d.is)(e,"bpmn:BoundaryEvent")}(e)||!(!(0,d.is)(e,"bpmn:IntermediateThrowEvent")||!Ft(e))||(0,d.is)(e,"bpmn:IntermediateCatchEvent")&&Wt(e)}(o)&&!(0,w.J5)(t)&&!(!(0,d.is)(t,"bpmn:Activity")||Mt(t))&&!(i&&!function(e,t){var n=(0,r.T8)(e,t,-15);return"intersect"!==n?n:null}(i,t))&&!function(e){return(0,d.is)(e,"bpmn:ReceiveTask")&&(0,s.sE)(e.incoming,(function(e){return(0,d.is)(e.source,"bpmn:EventBasedGateway")}))}(t)&&"attach"}function Ht(e,t,n){if(!t)return!1;var i={replacements:[]};return(0,s.Ed)(e,(function(e){(0,w.J5)(t)||(0,d.is)(e,"bpmn:StartEvent")&&"label"!==e.type&&$t(e,t)&&((0,w.yU)(e)||i.replacements.push({oldElementId:e.id,newElementType:"bpmn:StartEvent"}),((0,w.sm)(e)||(0,w.wQ)(e)||(0,w._Z)(e))&&i.replacements.push({oldElementId:e.id,newElementType:"bpmn:StartEvent"}),zt(e,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])&&(0,d.is)(t,"bpmn:SubProcess")&&i.replacements.push({oldElementId:e.id,newElementType:"bpmn:StartEvent"})),(0,d.is)(t,"bpmn:Transaction")||Tt(e,"bpmn:CancelEventDefinition")&&"label"!==e.type&&((0,d.is)(e,"bpmn:EndEvent")&&$t(e,t)&&i.replacements.push({oldElementId:e.id,newElementType:"bpmn:EndEvent"}),(0,d.is)(e,"bpmn:BoundaryEvent")&&Nt(e,t,0,n)&&i.replacements.push({oldElementId:e.id,newElementType:"bpmn:BoundaryEvent"}))})),!!i.replacements.length&&i}function Zt(e,t){return!(0,s.G)(e,It)&&(!t||e.every((function(e){return $t(e,t)})))}function Gt(e,t,n,i){return!!t&&(!(!(0,c.j_)(e)&&!jt(e))||n!==t&&(!n||!Ot(n,t))&&($t(e,t)||Jt(e,t)))}function Ut(e,t){return(0,d.is)(e,"bpmn:SubProcess")?(0,w.ul)(e)&&(!t||t.width>=100&&t.height>=80):(0,d.is)(e,"bpmn:Lane")?!t||t.width>=130&&t.height>=60:(0,d.is)(e,"bpmn:Participant")?!t||t.width>=250&&t.height>=50:!!Rt(e)||!!jt(e)}function Kt(e,t){return!(At(e)||At(t)||(!Pt(e)||!Mt(t))&&(Ot(t,e)||Ot(e,t)||!function(e,t){var n=Rt(e),i=Rt(t);return(n||i)&&n!==i}(e,t)&&!Yt(e,t)))}function Vt(e,t){return!(en(e)&&!en(t))&&(i=e,(0,d.is)(i,"bpmn:InteractionNode")&&!(0,d.is)(i,"bpmn:BoundaryEvent")&&(!(0,d.is)(i,"bpmn:Event")||(0,d.is)(i,"bpmn:ThrowEvent")&&Dt(i,"bpmn:MessageEventDefinition"))&&function(e){return(0,d.is)(e,"bpmn:InteractionNode")&&!Mt(e)&&(!(0,d.is)(e,"bpmn:Event")||(0,d.is)(e,"bpmn:CatchEvent")&&Dt(e,"bpmn:MessageEventDefinition"))&&!((0,d.is)(e,"bpmn:BoundaryEvent")&&!Tt(e,"bpmn:MessageEventDefinition"))}(t)&&(n=t,!(kt(e)===kt(n))));var n,i}function qt(e,t){return!(Ct(t)&&t.incoming.length>0&&(n=t.incoming,(n=n||[]).some(Qt))&&!(0,d.is)(e,"bpmn:EventBasedGateway"))&&(o=e,(0,d.is)(o,"bpmn:FlowNode")&&!(0,d.is)(o,"bpmn:EndEvent")&&!(0,w.J5)(o)&&!((0,d.is)(o,"bpmn:IntermediateThrowEvent")&&Tt(o,"bpmn:LinkEventDefinition"))&&!Pt(o)&&!Mt(o)&&function(e){return(0,d.is)(e,"bpmn:FlowNode")&&!(0,d.is)(e,"bpmn:StartEvent")&&!(0,d.is)(e,"bpmn:BoundaryEvent")&&!(0,w.J5)(e)&&!((0,d.is)(e,"bpmn:IntermediateCatchEvent")&&Tt(e,"bpmn:LinkEventDefinition"))&&!Mt(e)}(t)&&(i=t,Bt(e)===Bt(i))&&!((0,d.is)(e,"bpmn:EventBasedGateway")&&!Ct(t)));var n,i,o}function Yt(e,t){return v(e,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&v(t,["bpmn:Activity","bpmn:ThrowEvent"])?{type:"bpmn:DataInputAssociation"}:!(!v(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"])||!v(e,["bpmn:Activity","bpmn:CatchEvent"]))&&{type:"bpmn:DataOutputAssociation"}}function Jt(e,t,n){if(!t)return!1;if(Array.isArray(e)){if(1!==e.length)return!1;e=e[0]}return t.source!==e&&t.target!==e&&v(t,["bpmn:SequenceFlow","bpmn:MessageFlow"])&&!(0,c.j_)(t)&&(0,d.is)(e,"bpmn:FlowNode")&&!(0,d.is)(e,"bpmn:BoundaryEvent")&&$t(e,t.parent)}function Xt(e,t){return!!(0,c.j_)(t)||!((0,d.is)(t,"bpmn:Lane")&&!function(e,t){return e&&t&&-1!==e.indexOf(t)}(e,t.parent))}function Qt(e){if(e&&e.source)return(0,d.is)(e.source,"bpmn:EventBasedGateway")}function en(e){return y(e,"bpmn:Process")||y(e,"bpmn:Collaboration")}wt.$inject=["eventBus"],o()(wt,u),wt.prototype.addRule=function(e,t,n){var i=this;"string"==typeof e&&(e=[e]),e.forEach((function(e){i.canExecute(e,t,(function(e,t,i){return n(e)}),!0)}))},wt.prototype.init=function(){},o()(_t,wt),_t.$inject=["eventBus"],_t.prototype.init=function(){this.addRule("connection.start",(function(e){return St(t=e.source)?null:v(t,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference","bpmn:Group","bpmn:TextAnnotation"]);var t})),this.addRule("connection.create",(function(e){var t=e.source,n=e.target,i=e.hints||{},o=i.targetParent;if(i.targetAttach)return!1;o&&(n.parent=o);try{return Lt(t,n)}finally{o&&(n.parent=null)}})),this.addRule("connection.reconnect",(function(e){var t=e.connection;return Lt(e.source,e.target,t)})),this.addRule("connection.updateWaypoints",(function(e){return{type:e.connection.type}})),this.addRule("shape.resize",(function(e){return Ut(e.shape,e.newBounds)})),this.addRule("elements.create",(function(e){var t=e.elements,n=e.position,i=e.target;return!(At(i)&&!Jt(t,i))&&(0,s.yW)(t,(function(e){return At(e)?Lt(e.source,e.target,e):e.host?Nt(e,e.host,0,n):Gt(e,i,null)}))})),this.addRule("elements.move",(function(e){var t=e.target,n=e.shapes,i=e.position;return Nt(n,t,0,i)||Ht(n,t,i)||Zt(n,t)||Jt(n,t)})),this.addRule("shape.create",(function(e){return Gt(e.shape,e.target,e.source,e.position)})),this.addRule("shape.attach",(function(e){return Nt(e.shape,e.target,0,e.position)})),this.addRule("element.copy",(function(e){var t=e.element;return Xt(e.elements,t)}))},_t.prototype.canConnectMessageFlow=Vt,_t.prototype.canConnectSequenceFlow=qt,_t.prototype.canConnectDataAssociation=Yt,_t.prototype.canConnectAssociation=Kt,_t.prototype.canMove=Zt,_t.prototype.canAttach=Nt,_t.prototype.canReplace=Ht,_t.prototype.canDrop=$t,_t.prototype.canInsert=Jt,_t.prototype.canCreate=Gt,_t.prototype.canConnect=Lt,_t.prototype.canResize=Ut,_t.prototype.canCopy=Xt;const tn={__depends__:[Et],__init__:["bpmnRules"],bpmnRules:["type",_t]};var nn=n(312);function on(e,t){e.on("saveXML.start",2e3,(function(){var e,n,i=t.getRootElement(),o=(0,d.S)(i).di;e=(0,k.PB)([i],!1),e=(0,s.hX)(e,(function(e){return e!==i&&!e.labelTarget})),n=(0,s.UI)(e,nn.DN),o.set("planeElement",n)}))}on.$inject=["eventBus","canvas"];const rn={__init__:["bpmnDiOrdering"],bpmnDiOrdering:["type",on]};var an=n(805);function cn(e){u.call(this,e);var t=this;this.preExecute(["shape.create","connection.create"],(function(e){var n=e.context,i=n.shape||n.connection,o=n.parent,r=t.getOrdering(i,o);r&&(void 0!==r.parent&&(n.parent=r.parent),n.parentIndex=r.index)})),this.preExecute(["shape.move","connection.move"],(function(e){var n=e.context,i=n.shape||n.connection,o=n.newParent||i.parent,r=t.getOrdering(i,o);r&&(void 0!==r.parent&&(n.newParent=r.parent),n.newParentIndex=r.index)}))}function sn(e,t,n){cn.call(this,e);var i=[{type:"bpmn:SubProcess",order:{level:6}},{type:"bpmn:SequenceFlow",order:{level:3,containers:["bpmn:Participant","bpmn:FlowElementsContainer"]}},{type:"bpmn:DataAssociation",order:{level:9,containers:["bpmn:Collaboration","bpmn:Process"]}},{type:"bpmn:MessageFlow",order:{level:9,containers:["bpmn:Collaboration"]}},{type:"bpmn:Association",order:{level:6,containers:["bpmn:Participant","bpmn:FlowElementsContainer","bpmn:Collaboration"]}},{type:"bpmn:BoundaryEvent",order:{level:8}},{type:"bpmn:Group",order:{level:10,containers:["bpmn:Collaboration","bpmn:Process"]}},{type:"bpmn:FlowElement",order:{level:5}},{type:"bpmn:Participant",order:{level:-2}},{type:"bpmn:Lane",order:{level:-1}}];function o(e){var t=e.order;if(t||(e.order=t=function(e){if(e.labelTarget)return{level:10};var t=(0,s.sE)(i,(function(t){return v(e,[t.type])}));return t&&t.order||{level:1}}(e)),!t)throw new Error("no order for <"+e.id+">");return t}this.getOrdering=function(e,n){if(e.labelTarget)return{parent:t.getRootElement(),index:-1};var i=o(e);i.containers&&(n=function(e,t,n){for(var i=t;i&&!v(i,n);)i=i.parent;if(!i)throw new Error("no parent for <"+e.id+"> in <"+(t&&t.id)+">");return i}(e,n,i.containers));var r=n.children.indexOf(e),a=(0,s.cx)(n.children,(function(t){return!(!e.labelTarget&&t.labelTarget)&&i.level<o(t).level}));return-1!==a&&-1!==r&&r<a&&(a-=1),{index:a,parent:n}}}cn.prototype.getOrdering=function(e,t){return null},o()(cn,u),sn.$inject=["eventBus","canvas","translate"],o()(sn,cn);const un={__depends__:[an.Z],__init__:["bpmnOrderingProvider"],bpmnOrderingProvider:["type",sn]};function ln(){}ln.prototype.get=function(){return this._data},ln.prototype.set=function(e){this._data=e},ln.prototype.clear=function(){var e=this._data;return delete this._data,e},ln.prototype.isEmpty=function(){return!this._data};const pn={clipboard:["type",ln]};var hn=n(674),dn=n(752);function fn(e,t,n){var i,o,r=this,a=n.get("dragging",!1);a&&t.on("drag.start",(function(n){t.once("drag.move",1500,(function(t){!function(t){if(!t.hover){var n=t.originalEvent,i=r._findTargetGfx(n),o=i&&e.get(i);i&&o&&(t.stopPropagation(),a.hover({element:o,gfx:i}),a.move(n))}}(t)}))})),t.on("element.hover",(function(e){i=e.gfx,o=e.element})),t.on("element.hover",1500,(function(e){o&&t.fire("element.out",{element:o,gfx:i})})),t.on("element.out",(function(){i=null,o=null})),this._findTargetGfx=function(e){var t,n;if(e instanceof MouseEvent)return t=(0,dn.jt)(e),n=document.elementFromPoint(t.x,t.y),(0,hn.oq)(n,"svg, .djs-element",!0)}}fn.$inject=["elementRegistry","eventBus","injector"];const mn={__init__:["hoverFix"],hoverFix:["type",fn]};var vn=n(411),yn=n(422),gn=n(53),xn=Math.round,bn="djs-drag-active";function En(e){e.preventDefault()}function wn(e,t,n,i){var o,r={threshold:5,trapClick:!0};function c(e){var n=t.viewbox(),i=t._container.getBoundingClientRect();return{x:n.x+(e.x-i.left)/n.scale,y:n.y+(e.y-i.top)/n.scale}}function u(t,n){n=n||o;var i=e.createEvent((0,s.f0)({},n.payload,n.data,{isTouch:n.isTouch}));return!1!==e.fire("drag."+t,i)&&e.fire(n.prefix+"."+t,i)}function l(e,i){var r,l=o.payload,p=o.displacement,h=o.globalStart,d=(0,dn.jt)(e),f=(0,a.p)(d,h),m=o.localStart,v=c(d),g=(0,a.p)(v,m);if(!o.active&&(i||(r=f,Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y,2))>o.threshold))){if((0,s.f0)(l,{x:xn(m.x+p.x),y:xn(m.y+p.y),dx:0,dy:0},{originalEvent:e}),!1===u("start"))return y();o.active=!0,o.keepSelection||(l.previousSelection=n.get(),n.select(null)),o.cursor&&(0,yn.t8)(o.cursor),t.addMarker(t.getRootElement(),bn)}(0,dn.UW)(e),o.active&&((0,s.f0)(l,{x:xn(v.x+p.x),y:xn(v.y+p.y),dx:xn(g.x),dy:xn(g.y)},{originalEvent:e}),u("move"))}function p(e){var t=!0;o.active&&(e&&(o.payload.originalEvent=e,(0,dn.UW)(e)),t=u("end")),!1===t&&u("rejected"),u("ended",g(!0!==t))}function h(e){27===e.which&&(En(e),y())}function d(t){var n;o.active&&(n=(0,gn.N)(e),setTimeout(n,400),En(t)),p(t)}function f(e){l(e)}function m(e){var t=o.payload;t.hoverGfx=e.gfx,t.hover=e.element,u("hover")}function v(e){u("out");var t=o.payload;t.hoverGfx=null,t.hover=null}function y(e){var t;if(o){var n=o.active;n&&u("cancel"),t=g(e),n&&u("canceled",t)}}function g(r){var a,c;u("cleanup"),(0,yn.zN)(),c=o.trapClick?d:p,hn.B.unbind(document,"mousemove",l),hn.B.unbind(document,"dragstart",En),hn.B.unbind(document,"selectstart",En),hn.B.unbind(document,"mousedown",c,!0),hn.B.unbind(document,"mouseup",c,!0),hn.B.unbind(document,"keyup",h),hn.B.unbind(document,"touchstart",f,!0),hn.B.unbind(document,"touchcancel",y,!0),hn.B.unbind(document,"touchmove",l,!0),hn.B.unbind(document,"touchend",p,!0),e.off("element.hover",m),e.off("element.out",v),t.removeMarker(t.getRootElement(),bn);var s=o.payload.previousSelection;return!1!==r&&s&&!n.get().length&&function(e){var t=e.filter((function(e){return i.get(e.id)}));t.length&&n.select(t)}(s),a=o,o=null,a}e.on("diagram.destroy",y),this.init=function(t,n,i,g){o&&y(!1),"string"==typeof n&&(g=i,i=n,n=null);var x,b,E,w,_,S=(g=(0,s.f0)({},r,g||{})).data||{};w=g.trapClick?d:p,t?(x=(0,dn.Ku)(t)||t,b=(0,dn.jt)(t),(0,dn.UW)(t),"dragstart"===x.type&&En(x)):(x=null,b={x:0,y:0}),E=c(b),n||(n=E),_=function(e){return"undefined"!=typeof TouchEvent&&e instanceof TouchEvent}(x),o=(0,s.f0)({prefix:i,data:S,payload:{},globalStart:b,displacement:(0,a.p)(n,E),localStart:E,isTouch:_},g),g.manual||(_?(hn.B.bind(document,"touchstart",f,!0),hn.B.bind(document,"touchcancel",y,!0),hn.B.bind(document,"touchmove",l,!0),hn.B.bind(document,"touchend",p,!0)):(hn.B.bind(document,"mousemove",l),hn.B.bind(document,"dragstart",En),hn.B.bind(document,"selectstart",En),hn.B.bind(document,"mousedown",w,!0),hn.B.bind(document,"mouseup",w,!0)),hn.B.bind(document,"keyup",h),e.on("element.hover",m),e.on("element.out",v)),u("init"),g.autoActivate&&l(t,!0)},this.move=l,this.hover=m,this.out=v,this.end=p,this.cancel=y,this.context=function(){return o},this.setOptions=function(e){(0,s.f0)(r,e)}}wn.$inject=["eventBus","canvas","selection","elementRegistry"];const _n={__depends__:[mn,vn.Z],dragging:["type",wn]};var Sn=n(487),kn=n(23),Rn=["marker-start","marker-mid","marker-end"],jn=["circle","ellipse","line","path","polygon","polyline","rect"];function Pn(e,t,n,i){this._elementRegistry=e,this._canvas=n,this._styles=i,this._clonedMarkers={};var o=this;t.on("drag.cleanup",(function(){(0,s.Ed)(o._clonedMarkers,(function(e){(0,Sn.Od)(e)})),o._clonedMarkers={}}))}Pn.$inject=["elementRegistry","eventBus","canvas","styles"],Pn.prototype.getGfx=function(e){return this._elementRegistry.getGraphics(e)},Pn.prototype.addDragger=function(e,t,n){n=n||this.getGfx(e);var i=(0,Sn.d9)(n),o=n.getBoundingClientRect();return this._cloneMarkers((0,kn.s)(i)),(0,Sn.Lj)(i,this._styles.cls("djs-dragger",[],{x:o.top,y:o.left})),(0,Sn.R3)(t,i),i},Pn.prototype.addFrame=function(e,t){var n=(0,Sn.Ue)("rect",{class:"djs-resize-overlay",width:e.width,height:e.height,x:e.x,y:e.y});return(0,Sn.R3)(t,n),n},Pn.prototype._cloneMarkers=function(e){var t,n=this;if(e.childNodes)for(var i=0;i<e.childNodes.length;i++)n._cloneMarkers(e.childNodes[i]);t=e,-1!==jn.indexOf(t.nodeName)&&Rn.forEach((function(t){if((0,Sn.Lj)(e,t)){var i=function(e,t,n){var i=(0,Sn.Lj)(e,t).match(/url\(['"]?#([^'"]*)['"]?\)/)[1];return(0,hn.IO)("marker#"+i,n||document)}(e,t,n._canvas.getContainer());n._cloneMarker(e,i,t)}}))},Pn.prototype._cloneMarker=function(e,t,n){var i=t.id,o=this._clonedMarkers[i];if(!o){var r=i+"-clone";(o=(0,Sn.d9)(t)).id=r,(0,Sn.Sh)(o).add("djs-dragger").add("djs-dragger-marker"),this._clonedMarkers[i]=o;var a=(0,hn.IO)("defs",this._canvas._svg);a||(a=(0,Sn.Ue)("defs"),(0,Sn.R3)(this._canvas._svg,a)),(0,Sn.R3)(a,o)}var c="url(#"+this._clonedMarkers[i].id+")";(0,Sn.Lj)(e,n,c)};const Mn={__init__:["previewSupport"],previewSupport:["type",Pn]};var Bn="drop-ok",Tn="drop-not-ok",Dn="attach-ok",Cn="new-parent",An="create";function On(e,t,n,i,o){function r(t,n){[Dn,Bn,Tn,Cn].forEach((function(i){i===n?e.addMarker(t,i):e.removeMarker(t,i)}))}function a(){var e=t.context();e&&e.prefix===An&&t.cancel()}n.on(["create.move","create.hover"],(function(e){var t=e.context,n=t.elements,i=e.hover,a=t.source,c=t.hints||{};if(!i)return t.canExecute=!1,void(t.target=null);Ln(e);var u={x:e.x,y:e.y},l=t.canExecute=i&&function(e,t,n,i,r){if(!t)return!1;e=(0,s.hX)(e,(function(t){var n=t.labelTarget;return!(t.parent||function(e){return!!e.labelTarget}(t)&&-1!==e.indexOf(n))}));var a=(0,s.sE)(e,(function(e){return!$n(e)})),c=!1,u=!1,l=!1;In(e)&&(c=o.allowed("shape.attach",{position:n,shape:a,target:t})),c||(l=In(e)?o.allowed("shape.create",{position:n,shape:a,source:i,target:t}):o.allowed("elements.create",{elements:e,position:n,target:t}));var p=r.connectionTarget;return l||c?(a&&i&&(u=o.allowed("connection.create",{source:p===i?a:i,target:p===i?i:a,hints:{targetParent:t,targetAttach:c}})),{attach:c,connect:u}):(null===l||null===c)&&null}(n,i,u,a,c);i&&null!==l&&(t.target=i,l&&l.attach?r(i,Dn):r(i,l?Cn:Tn))})),n.on(["create.end","create.out","create.cleanup"],(function(e){var t=e.hover;t&&r(t,null)})),n.on("create.end",(function(e){var t=e.context,n=t.source,o=t.shape,r=t.elements,a=t.target,c=t.canExecute,u=c&&c.attach,l=c&&c.connect,p=t.hints||{};if(!1===c||!a)return!1;Ln(e);var h={x:e.x,y:e.y};l?o=i.appendShape(n,o,h,a,{attach:u,connection:!0===l?{}:l,connectionTarget:p.connectionTarget}):(r=i.createElements(r,h,a,(0,s.f0)({},p,{attach:u})),o=(0,s.sE)(r,(function(e){return!$n(e)}))),(0,s.f0)(t,{elements:r,shape:o}),(0,s.f0)(e,{elements:r,shape:o})})),n.on("create.init",(function(){n.on("elements.changed",a),n.once(["create.cancel","create.end"],2e3,(function(){n.off("elements.changed",a)}))})),this.start=function(e,n,i){(0,s.kJ)(n)||(n=[n]);var o=(0,s.sE)(n,(function(e){return!$n(e)}));if(o){i=(0,s.f0)({elements:n,hints:{},shape:o},i||{}),(0,s.Ed)(n,(function(e){(0,s.hj)(e.x)||(e.x=0),(0,s.hj)(e.y)||(e.y=0)}));var r=(0,k.jY)(n);(0,s.Ed)(n,(function(e){$n(e)&&(e.waypoints=(0,s.UI)(e.waypoints,(function(e){return{x:e.x-r.x-r.width/2,y:e.y-r.y-r.height/2}}))),(0,s.f0)(e,{x:e.x-r.x-r.width/2,y:e.y-r.y-r.height/2})})),t.init(e,An,{cursor:"grabbing",autoActivate:!0,data:{shape:o,elements:n,context:i}})}}}function Ln(e){var t=e.context.createConstraints;t&&(t.left&&(e.x=Math.max(e.x,t.left)),t.right&&(e.x=Math.min(e.x,t.right)),t.top&&(e.y=Math.max(e.y,t.top)),t.bottom&&(e.y=Math.min(e.y,t.bottom)))}function $n(e){return!!e.waypoints}function In(e){return e&&1===e.length&&!$n(e[0])}On.$inject=["canvas","dragging","eventBus","modeling","rules"];var Fn=n(168);function Wn(e,t,n,i,o){t.on("create.move",750,(function(t){var r,a=t.hover,c=t.context,s=c.elements,u=c.dragGroup;u||(u=c.dragGroup=function(e){var t=(0,Sn.Ue)("g");(0,Sn.Lj)(t,o.cls("djs-drag-group",["no-events"]));var r=(0,Sn.Ue)("g");return e.forEach((function(e){var o;e.hidden||(e.waypoints?(o=n._createContainer("connection",r),n.drawConnection((0,kn.s)(o),e)):(o=n._createContainer("shape",r),n.drawShape((0,kn.s)(o),e),(0,Fn.Iu)(o,e.x,e.y)),i.addDragger(e,t,o))})),t}(s)),a?(u.parentNode||(r=e.getDefaultLayer(),(0,Sn.R3)(r,u)),(0,Fn.Iu)(u,t.x,t.y)):(0,Sn.Od)(u)})),t.on("create.cleanup",(function(e){var t=e.context.dragGroup;t&&(0,Sn.Od)(t)}))}Wn.$inject=["canvas","eventBus","graphicsFactory","previewSupport","styles"];const zn={__depends__:[_n,Mn,Et,vn.Z],__init__:["create","createPreview"],create:["type",On],createPreview:["type",Wn]};function Nn(e){var t=this;function n(e){t._lastMoveEvent=e}this._lastMoveEvent=null,e.on("canvas.init",(function(e){(t._svg=e.svg).addEventListener("mousemove",n)})),e.on("canvas.destroy",(function(){t._lastMouseEvent=null,t._svg.removeEventListener("mousemove",n)}))}Nn.$inject=["eventBus"],Nn.prototype.getLastMoveEvent=function(){return this._lastMoveEvent||((e=document.createEvent("MouseEvent")).initMouseEvent&&e.initMouseEvent("mousemove",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e);var e};const Hn={__init__:["mouse"],mouse:["type",Nn]};function Zn(e,t,n,i,o,r,a,c){this._canvas=e,this._create=t,this._clipboard=n,this._elementFactory=i,this._eventBus=o,this._modeling=r,this._mouse=a,this._rules=c,o.on("copyPaste.copyElement",(function(e){var t=e.descriptor,n=e.element,i=e.elements;t.priority=1,t.id=n.id,(0,s.sE)(i,(function(e){return e===n.parent}))&&(t.parent=n.parent.id),function(e){return!!e.host}(n)&&(t.priority=2,t.host=n.host.id),Gn(n)&&(t.priority=3,t.source=n.source.id,t.target=n.target.id,t.waypoints=function(e){return(0,s.UI)(e.waypoints,(function(e){return(e=Kn(e)).original&&(e.original=Kn(e.original)),e}))}(n)),Un(n)&&(t.priority=4,t.labelTarget=n.labelTarget.id),(0,s.Ed)(["x","y","width","height"],(function(e){(0,s.hj)(n[e])&&(t[e]=n[e])})),t.hidden=n.hidden,t.collapsed=n.collapsed})),o.on("copyPaste.pasteElements",(function(e){var t=e.hints;(0,s.f0)(t,{createElementsBehavior:!1})}))}function Gn(e){return!!e.waypoints}function Un(e){return!!e.labelTarget}function Kn(e){return(0,s.f0)({},e)}function Vn(e,t){var n=t.indexOf(e);return-1===n?t:t.splice(n,1)}Zn.$inject=["canvas","create","clipboard","elementFactory","eventBus","modeling","mouse","rules"],Zn.prototype.copy=function(e){var t,n;return(0,s.kJ)(e)||(e=e?[e]:[]),n=!1===(t=this._eventBus.fire("copyPaste.canCopyElements",{elements:e}))?{}:this.createTree((0,s.kJ)(t)?t:e),this._clipboard.set(n),this._eventBus.fire("copyPaste.elementsCopied",{elements:e,tree:n}),n},Zn.prototype.paste=function(e){var t=this._clipboard.get();if(!this._clipboard.isEmpty()){var n=e&&e.hints||{};this._eventBus.fire("copyPaste.pasteElements",{hints:n});var i=this._createElements(t);if(e&&e.element&&e.point)return this._paste(i,e.element,e.point,n);this._create.start(this._mouse.getLastMoveEvent(),i,{hints:n||{}})}},Zn.prototype._paste=function(e,t,n,i){(0,s.Ed)(e,(function(e){(0,s.hj)(e.x)||(e.x=0),(0,s.hj)(e.y)||(e.y=0)}));var o=(0,k.jY)(e);return(0,s.Ed)(e,(function(e){Gn(e)&&(e.waypoints=(0,s.UI)(e.waypoints,(function(e){return{x:e.x-o.x-o.width/2,y:e.y-o.y-o.height/2}}))),(0,s.f0)(e,{x:e.x-o.x-o.width/2,y:e.y-o.y-o.height/2})})),this._modeling.createElements(e,n,t,(0,s.f0)({},i))},Zn.prototype._createElements=function(e){var t=this,n=this._eventBus,i={},o=[];return(0,s.Ed)(e,(function(e,r){r=parseInt(r,10),e=(0,s.MR)(e,"priority"),(0,s.Ed)(e,(function(e){var r,a=(0,s.f0)({},(0,s.CE)(e,["priority"]));return i[e.parent]?a.parent=i[e.parent]:delete a.parent,n.fire("copyPaste.pasteElement",{cache:i,descriptor:a}),Gn(a)?(a.source=i[e.source],a.target=i[e.target],r=i[e.id]=t.createConnection(a),void o.push(r)):Un(a)?(a.labelTarget=i[a.labelTarget],r=i[e.id]=t.createLabel(a),void o.push(r)):(a.host&&(a.host=i[a.host]),r=i[e.id]=t.createShape(a),void o.push(r))}))})),o},Zn.prototype.createConnection=function(e){return this._elementFactory.createConnection((0,s.CE)(e,["id"]))},Zn.prototype.createLabel=function(e){return this._elementFactory.createLabel((0,s.CE)(e,["id"]))},Zn.prototype.createShape=function(e){return this._elementFactory.createShape((0,s.CE)(e,["id"]))},Zn.prototype.hasRelations=function(e,t){var n,i;return!(Gn(e)&&(n=(0,s.sE)(t,(0,s.KQ)({id:e.source.id})),i=(0,s.sE)(t,(0,s.KQ)({id:e.target.id})),!n||!i)||Un(e)&&!(0,s.sE)(t,(0,s.KQ)({id:e.labelTarget.id})))},Zn.prototype.createTree=function(e){var t=this._rules,n=this,i={},o=[],r=(0,k.cd)(e);function a(e,t){var n=(0,s.sE)(o,(function(t){return e===t.element}));n?n.depth<t&&(o=function(e,t){var n=t.indexOf(e);return-1!==n&&t.splice(n,1),t}(n,o)).push({element:n.element,depth:t}):o.push({element:e,depth:t})}return(0,k.om)(r,(function(e,t,n){if(!Un(e))return(0,s.Ed)(e.labels,(function(e){a(e,n)})),(0,s.Ed)([e.attachers,e.incoming,e.outgoing],(function(e){e&&e.length&&(0,s.Ed)(e,(function(e){(0,s.Ed)(e.labels,(function(e){a(e,n)})),a(e,n)}))})),a(e,n),e.children})),e=(0,s.UI)(o,(function(e){return e.element})),o=(0,s.UI)(o,(function(t){return t.descriptor={},n._eventBus.fire("copyPaste.copyElement",{descriptor:t.descriptor,element:t.element,elements:e}),t})),o=(0,s.MR)(o,(function(e){return e.descriptor.priority})),e=(0,s.UI)(o,(function(e){return e.element})),(0,s.Ed)(o,(function(o){var r=o.depth;n.hasRelations(o.element,e)&&function(e,n){return t.allowed("element.copy",{element:e,elements:n})}(o.element,e)?(i[r]||(i[r]=[]),i[r].push(o.descriptor)):Vn(o.element,e)})),i};const qn={__depends__:[pn,zn,Hn,Et],__init__:["copyPaste"],copyPaste:["type",Zn]};function Yn(e,t,n){(0,s.kJ)(n)||(n=[n]),(0,s.Ed)(n,(function(n){(0,s.o8)(e[n])||(t[n]=e[n])}))}function Jn(e,t,n){var i;t.on("copyPaste.copyElement",750,(function(e){var t=e.descriptor,n=e.element,i=t.oldBusinessObject=(0,d.S)(n);if(t.type=n.type,Yn(i,t,"name"),t.di={},Yn(i.di,t.di,["fill","stroke","background-color","border-color","color"]),Yn(i.di,t,"isExpanded"),Xn(t))return t;i.default&&(t.default=i.default.id)})),t.on("moddleCopy.canCopyProperty",(function(t){var i,o=t.parent,r=t.property;if("processRef"===t.propertyName&&(0,d.is)(o,"bpmn:Participant")&&(0,d.is)(r,"bpmn:Process"))return i=e.create("bpmn:Process"),n.copyElement(r,i)})),t.on("copyPaste.pasteElements",(function(){i={}})),t.on("copyPaste.pasteElement",(function(t){var o,r,a,c=t.cache,u=t.descriptor,l=u.oldBusinessObject;Xn(u)?u.businessObject=(0,d.S)(c[u.labelTarget]):(o=e.create(l.$type),u.businessObject=n.copyElement(l,o),function(e,t){var n=(0,d.S)(e);e.default&&(i[e.default]={element:n,property:"default"}),e.host&&((0,d.S)(e).attachedToRef=(0,d.S)(t[e.host])),i=(0,s.CE)(i,(0,s.u4)(i,(function(t,i,o){var r=i.element,a=i.property;return o===e.id&&(r[a]=n,t.push(e.id)),t}),[]))}(u,c),Yn(u,o,["isExpanded","name"]),r=u,a="oldBusinessObject",(0,s.kJ)(a)||(a=[a]),(0,s.Ed)(a,(function(e){r[e]&&delete r[e]})))}))}function Xn(e){return!!e.labelTarget}Jn.$inject=["bpmnFactory","eventBus","moddleCopy"];var Qn=["artifacts","dataInputAssociations","dataOutputAssociations","default","flowElements","lanes","incoming","outgoing"];function ei(e,t,n){this._bpmnFactory=t,this._eventBus=e,this._moddle=n,e.on("moddleCopy.canCopyProperties",(function(e){var t=e.propertyNames;if(t&&t.length)return(0,s.MR)(t,(function(e){return"extensionElements"===e}))})),e.on("moddleCopy.canCopyProperty",(function(e){var t=e.parent,n=(0,s.Kn)(t)&&t.$descriptor,i=e.propertyName;return(!i||-1===Qn.indexOf(i))&&!(i&&n&&!(0,s.sE)(n.properties,(0,s.KQ)({name:i})))&&void 0})),e.on("moddleCopy.canSetCopiedProperty",(function(e){var t,n=e.property;if("bpmn:ExtensionElements",(t=n)&&"function"==typeof t.$instanceOf&&t.$instanceOf("bpmn:ExtensionElements")&&(!n.values||!n.values.length))return!1}))}function ti(e,t){return(0,s.u4)(e.properties,(function(e,n){return t&&n.default?e:e.concat(n.name)}),[])}ei.$inject=["eventBus","bpmnFactory","moddle"],ei.prototype.copyElement=function(e,t,n){var i=this;n&&!(0,s.kJ)(n)&&(n=[n]),n=n||ti(e.$descriptor);var o=this._eventBus.fire("moddleCopy.canCopyProperties",{propertyNames:n,sourceElement:e,targetElement:t});return!1===o||((0,s.kJ)(o)&&(n=o),(0,s.Ed)(n,(function(n){var o;(0,s.e$)(e,n)&&(o=e.get(n));var r=i.copyProperty(o,t,n);!1!==i._eventBus.fire("moddleCopy.canSetCopiedProperty",{parent:t,property:r,propertyName:n})&&(0,s.$K)(r)&&t.set(n,r)}))),t},ei.prototype.copyProperty=function(e,t,n){var i=this,o=this._eventBus.fire("moddleCopy.canCopyProperty",{parent:t,property:e,propertyName:n});if(!1!==o){if(o)return(0,s.Kn)(o)&&o.$type&&!o.$parent&&(o.$parent=t),o;var r=this._moddle.getPropertyDescriptor(t,n);if(!r.isId&&!r.isReference){if((0,s.kJ)(e))return(0,s.u4)(e,(function(e,r){return(o=i.copyProperty(r,t,n))?(o.$parent=t,e.concat(o)):e}),[]);if((0,s.Kn)(e)&&e.$type){if(this._moddle.getElementDescriptor(e).isGeneric)return;return(o=i._bpmnFactory.create(e.$type)).$parent=t,o=i.copyElement(e,o)}return e}}};const ni={__depends__:[qn],__init__:["bpmnCopyPaste","moddleCopy"],bpmnCopyPaste:["type",Jn],moddleCopy:["type",ei]};var ii=Math.round;function oi(e){this._modeling=e}oi.$inject=["modeling"],oi.prototype.replaceElement=function(e,t,n){if(e.waypoints)return null;var i=this._modeling,o=t.width||e.width,r=t.height||e.height,a=t.x||e.x,c=t.y||e.y,u=ii(a+o/2),l=ii(c+r/2);return i.replaceShape(e,(0,s.f0)({},t,{x:u,y:l,width:o,height:r}),n)};const ri={__init__:["replace"],replace:["type",oi]};var ai=["cancelActivity","instantiate","eventGatewayType","triggeredByEvent","isInterrupting"];function ci(e,t,n,i,o,r,a){this.replaceElement=function(c,u,l){l=l||{};var p=u.type,h=c.businessObject;if(si(h)&&"bpmn:SubProcess"===p&&function(e,t){var n=e&&(0,s.e$)(e,"collapsed")?e.collapsed:!(0,w.ul)(e);return n!==(t&&((0,s.e$)(t,"collapsed")||(0,s.e$)(t,"isExpanded"))?(0,s.e$)(t,"collapsed")?t.collapsed:!t.isExpanded:n)&&(e.collapsed=n,!0)}(c,u))return i.toggleCollapse(c),c;var f,m=e.create(p),y={type:p,businessObject:m},g=ti(h.$descriptor),x=ti(m.$descriptor,!0),b=(f=x,g.filter((function(e){return-1!==f.indexOf(e)})));(0,s.f0)(m,(0,s.ei)(u,ai));var E=(0,s.hX)(b,(function(e){return"eventDefinitions"===e?ui(c,u.eventDefinitionType):"loopCharacteristics"===e?!(0,w.J5)(m):!(0,s.e$)(m,e)&&("processRef"!==e||!1!==u.isExpanded)&&"triggeredByEvent"!==e}));return m=n.copyElement(h,m,E),u.eventDefinitionType&&(ui(m,u.eventDefinitionType)||(y.eventDefinitionType=u.eventDefinitionType,y.eventDefinitionAttrs=u.eventDefinitionAttrs)),(0,d.is)(h,"bpmn:Activity")&&(si(h)?y.isExpanded=(0,w.ul)(h):u&&(0,s.e$)(u,"isExpanded")&&(y.isExpanded=u.isExpanded),(0,w.ul)(h)&&!(0,d.is)(h,"bpmn:Task")&&y.isExpanded&&(y.width=c.width,y.height=c.height)),si(h)&&!si(m)&&(l.moveChildren=!1),(0,d.is)(h,"bpmn:Participant")&&(!0===u.isExpanded?m.processRef=e.create("bpmn:Process"):l.moveChildren=!1,y.width=c.width,y.height=t._getDefaultSize(m).height),r.allowed("shape.resize",{shape:m})||(y.height=t._getDefaultSize(m).height,y.width=t._getDefaultSize(m).width),m.name=h.name,v(h,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&v(m,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&(m.default=h.default),u.host&&!(0,d.is)(h,"bpmn:BoundaryEvent")&&(0,d.is)(m,"bpmn:BoundaryEvent")&&(y.host=u.host),"bpmn:DataStoreReference"!==y.type&&"bpmn:DataObjectReference"!==y.type||(y.x=c.x+(c.width-y.width)/2),y.di={},function(e,t,n){(0,s.kJ)(n)||(n=[n]),(0,s.Ed)(n,(function(n){(0,s.o8)(e[n])||(t[n]=e[n])}))}(h.di,y.di,["fill","stroke","background-color","border-color","color"]),y=o.replaceElement(c,y,l),!1!==l.select&&a.select(y),y}}function si(e){return(0,d.is)(e,"bpmn:SubProcess")}function ui(e,t){var n=(0,d.S)(e);return t&&n.get("eventDefinitions").some((function(e){return(0,d.is)(e,t)}))}ci.$inject=["bpmnFactory","elementFactory","moddleCopy","modeling","replace","rules","selection"];const li={__depends__:[ni,ri,vn.Z],bpmnReplace:["type",ci]};function pi(e,t){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[],trigger:null},this._injector=t,this._eventBus=e,this._uid=1,e.on(["diagram.destroy","diagram.clear"],(function(){this.clear(!1)}),this)}pi.$inject=["eventBus","injector"],pi.prototype.execute=function(e,t){if(!e)throw new Error("command required");this._currentExecution.trigger="execute";var n={command:e,context:t};this._pushAction(n),this._internalExecute(n),this._popAction(n)},pi.prototype.canExecute=function(e,t){var n={command:e,context:t},i=this._getHandler(e),o=this._fire(e,"canExecute",n);if(void 0===o){if(!i)return!1;i.canExecute&&(o=i.canExecute(t))}return o},pi.prototype.clear=function(e){this._stack.length=0,this._stackIdx=-1,!1!==e&&this._fire("changed",{trigger:"clear"})},pi.prototype.undo=function(){var e,t=this._getUndoAction();if(t){for(this._currentExecution.trigger="undo",this._pushAction(t);t&&(this._internalUndo(t),(e=this._getUndoAction())&&e.id===t.id);)t=e;this._popAction()}},pi.prototype.redo=function(){var e,t=this._getRedoAction();if(t){for(this._currentExecution.trigger="redo",this._pushAction(t);t&&(this._internalExecute(t,!0),(e=this._getRedoAction())&&e.id===t.id);)t=e;this._popAction()}},pi.prototype.register=function(e,t){this._setHandler(e,t)},pi.prototype.registerHandler=function(e,t){if(!e||!t)throw new Error("command and handlerCls must be defined");var n=this._injector.instantiate(t);this.register(e,n)},pi.prototype.canUndo=function(){return!!this._getUndoAction()},pi.prototype.canRedo=function(){return!!this._getRedoAction()},pi.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]},pi.prototype._getUndoAction=function(){return this._stack[this._stackIdx]},pi.prototype._internalUndo=function(e){var t=this,n=e.command,i=e.context,o=this._getHandler(n);this._atomicDo((function(){t._fire(n,"revert",e),o.revert&&t._markDirty(o.revert(i)),t._revertedAction(e),t._fire(n,"reverted",e)}))},pi.prototype._fire=function(e,t,n){arguments.length<3&&(n=t,t=null);var i,o,r,a=t?[e+"."+t,t]:[e];for(n=this._eventBus.createEvent(n),i=0;(o=a[i])&&(r=this._eventBus.fire("commandStack."+o,n),!n.cancelBubble);i++);return r},pi.prototype._createId=function(){return this._uid++},pi.prototype._atomicDo=function(e){var t=this._currentExecution;t.atomic=!0;try{e()}finally{t.atomic=!1}},pi.prototype._internalExecute=function(e,t){var n=this,i=e.command,o=e.context,r=this._getHandler(i);if(!r)throw new Error("no command handler registered for <"+i+">");this._pushAction(e),t||(this._fire(i,"preExecute",e),r.preExecute&&r.preExecute(o),this._fire(i,"preExecuted",e)),this._atomicDo((function(){n._fire(i,"execute",e),r.execute&&n._markDirty(r.execute(o)),n._executedAction(e,t),n._fire(i,"executed",e)})),t||(this._fire(i,"postExecute",e),r.postExecute&&r.postExecute(o),this._fire(i,"postExecuted",e)),this._popAction(e)},pi.prototype._pushAction=function(e){var t=this._currentExecution,n=t.actions,i=n[0];if(t.atomic)throw new Error("illegal invocation in <execute> or <revert> phase (action: "+e.command+")");e.id||(e.id=i&&i.id||this._createId()),n.push(e)},pi.prototype._popAction=function(){var e=this._currentExecution,t=e.trigger,n=e.actions,i=e.dirty;n.pop(),n.length||(this._eventBus.fire("elements.changed",{elements:(0,s.uw)("id",i.reverse())}),i.length=0,this._fire("changed",{trigger:t}),e.trigger=null)},pi.prototype._markDirty=function(e){var t=this._currentExecution;e&&(e=(0,s.kJ)(e)?e:[e],t.dirty=t.dirty.concat(e))},pi.prototype._executedAction=function(e,t){var n=++this._stackIdx;t||this._stack.splice(n,this._stack.length,e)},pi.prototype._revertedAction=function(e){this._stackIdx--},pi.prototype._getHandler=function(e){return this._handlerMap[e]},pi.prototype._setHandler=function(e,t){if(!e||!t)throw new Error("command and handler required");if(this._handlerMap[e])throw new Error("overriding handler for command <"+e+">");this._handlerMap[e]=t};const hi={commandStack:["type",pi]};var di=n(842);function fi(e,t){if("function"!=typeof t)throw new Error("removeFn iterator must be a function");if(e){for(var n;n=e[0];)t(n);return e}}function mi(e,t,n){u.call(this,t);var i=e.get("movePreview",!1);t.on("shape.move.start",1400,(function(e){var t=e.context,n=t.shapes,i=t.validatedShapes;t.shapes=vi(n),t.validatedShapes=vi(i)})),i&&t.on("shape.move.start",250,(function(e){var t=e.context,n=t.shapes,o=[];(0,s.Ed)(n,(function(e){(0,s.Ed)(e.labels,(function(n){n.hidden||-1!==t.shapes.indexOf(n)||o.push(n),e.labelTarget&&o.push(e)}))})),(0,s.Ed)(o,(function(e){i.makeDraggable(t,e,!0)}))})),this.preExecuted("elements.move",1400,(function(e){var t=e.context.closure,n=t.enclosedElements,i=[];(0,s.Ed)(n,(function(e){(0,s.Ed)(e.labels,(function(e){n[e.id]||i.push(e)}))})),t.addAll(i)})),this.preExecute(["connection.delete","shape.delete"],(function(e){var t=e.context;fi((t.connection||t.shape).labels,(function(e){n.removeShape(e,{nested:!0})}))})),this.execute("shape.delete",(function(e){var t=e.context,n=t.shape,i=n.labelTarget;i&&(t.labelTargetIndex=(0,E.cq)(i.labels,n),t.labelTarget=i,n.labelTarget=null)})),this.revert("shape.delete",(function(e){var t=e.context,n=t.shape,i=t.labelTarget,o=t.labelTargetIndex;i&&((0,E.IH)(i.labels,n,o),n.labelTarget=i)}))}function vi(e){return(0,s.hX)(e,(function(t){return-1===e.indexOf(t.labelTarget)}))}o()(mi,u),mi.$inject=["injector","eventBus","modeling"];const yi={__init__:["labelSupport"],labelSupport:["type",mi]};var gi="attach-ok";function xi(e,t,n,i,o){u.call(this,t);var r=e.get("movePreview",!1);t.on("shape.move.start",1401,(function(e){var t,n,i=e.context,o=i.shapes,r=i.validatedShapes;i.shapes=(n=bi(t=o),(0,s.qZ)("id",t,n)),i.validatedShapes=function(e){var t=(0,s.vM)(e,"id");return(0,s.hX)(e,(function(e){for(;e;){if(e.host&&t[e.host.id])return!1;e=e.parent}return!0}))}(r)})),r&&t.on("shape.move.start",251,(function(e){var t=e.context,n=bi(t.shapes);(0,s.Ed)(n,(function(e){r.makeDraggable(t,e,!0),(0,s.Ed)(e.labels,(function(e){r.makeDraggable(t,e,!0)}))}))})),r&&t.on("shape.move.start",(function(e){var i=e.context.shapes;if(1===i.length){var o=i[0].host;o&&(n.addMarker(o,gi),t.once(["shape.move.out","shape.move.cleanup"],(function(){n.removeMarker(o,gi)})))}})),this.preExecuted("elements.move",1401,(function(e){var t=e.context,n=t.closure,i=bi(t.shapes);(0,s.Ed)(i,(function(e){n.add(e,n.topLevel[e.host.id])}))})),this.postExecuted("elements.move",(function(e){var t,n=e.context,i=n.shapes,r=n.newHost;r&&1!==i.length||(t=r?i:(0,s.hX)(i,(function(e){var t,n=e.host;return function(e){return!!e.host}(e)&&(t=n,!(-1!==i.indexOf(t)))})),(0,s.Ed)(t,(function(e){o.updateAttachment(e,r)})))})),this.postExecuted("elements.move",(function(e){var t=e.context.shapes;(0,s.Ed)(t,(function(e){(0,s.Ed)(e.attachers,(function(e){(0,s.Ed)(e.outgoing.slice(),(function(e){i.allowed("connection.reconnect",{connection:e,source:e.source,target:e.target})||o.removeConnection(e)})),(0,s.Ed)(e.incoming.slice(),(function(e){i.allowed("connection.reconnect",{connection:e,source:e.source,target:e.target})||o.removeConnection(e)}))}))}))})),this.postExecute("shape.create",(function(e){var t=e.context,n=t.shape,i=t.host;i&&o.updateAttachment(n,i)})),this.postExecute("shape.replace",(function(e){var t=e.context,n=t.oldShape,r=t.newShape;fi(n.attachers,(function(e){"attach"===i.allowed("elements.move",{target:r,shapes:[e]})?o.updateAttachment(e,r):o.removeShape(e)})),r.attachers.length&&(0,s.Ed)(r.attachers,(function(e){var t=Te(e,n,r);o.moveShape(e,t,e.parent)}))})),this.postExecute("shape.resize",(function(e){var t=e.context,n=t.shape,i=t.oldBounds,r=t.newBounds,a=n.attachers;!1!==(t.hints||{}).attachSupport&&(0,s.Ed)(a,(function(e){var t=Te(e,i,r);o.moveShape(e,t,e.parent),(0,s.Ed)(e.labels,(function(e){o.moveShape(e,t,e.parent)}))}))})),this.preExecute("shape.delete",(function(e){var t=e.context.shape;fi(t.attachers,(function(e){o.removeShape(e)})),t.host&&o.updateAttachment(t,null)}))}function bi(e){return(0,s.xH)((0,s.UI)(e,(function(e){return e.attachers||[]})))}o()(xi,u),xi.$inject=["injector","eventBus","canvas","rules","modeling"];const Ei={__depends__:[Et],__init__:["attachSupport"],attachSupport:["type",xi]};function wi(e,t,n,i){e.on("element.changed",(function(i){var o=i.element;(o.parent||o===t.getRootElement())&&(i.gfx=n.getGraphics(o)),i.gfx&&e.fire((0,k.oL)(o)+".changed",i)})),e.on("elements.changed",(function(t){var n=t.elements;n.forEach((function(t){e.fire("element.changed",{element:t})})),i.updateContainments(n)})),e.on("shape.changed",(function(e){i.update("shape",e.element,e.gfx)})),e.on("connection.changed",(function(e){i.update("connection",e.element,e.gfx)}))}wi.$inject=["eventBus","canvas","elementRegistry","graphicsFactory"];const _i={__init__:["changeSupport"],changeSupport:["type",wi]};function Si(e,t){this._eventBus=e,this._dragging=t,this._tools=[],this._active=null}Si.$inject=["eventBus","dragging"],Si.prototype.registerTool=function(e,t){var n=this._tools;if(!t)throw new Error('A tool has to be registered with it\'s "events"');n.push(e),this.bindEvents(e,t)},Si.prototype.isActive=function(e){return e&&this._active===e},Si.prototype.length=function(e){return this._tools.length},Si.prototype.setActive=function(e){var t=this._eventBus;this._active!==e&&(this._active=e,t.fire("tool-manager.update",{tool:e}))},Si.prototype.bindEvents=function(e,t){var n=this._eventBus,i=this._dragging,o=[];n.on(t.tool+".init",(function(t){if(!t.context.reactivate&&this.isActive(e))return this.setActive(null),void i.cancel();this.setActive(e)}),this),(0,s.Ed)(t,(function(e){o.push(e+".ended"),o.push(e+".canceled")})),n.on(o,250,(function(e){this._active&&(function(e){var t=e.originalEvent&&e.originalEvent.target;return t&&(0,hn.oq)(t,'.group[data-group="tools"]')}(e)||this.setActive(null))}),this)};const ki={__depends__:[_n],__init__:["toolManager"],toolManager:["type",Si]};function Ri(e,t){return-1!==e.indexOf(t)}var ji=Math.abs,Pi=Math.round,Mi={x:"width",y:"height"},Bi="crosshair",Ti={n:"top",w:"left",s:"bottom",e:"right"},Di={n:"s",w:"e",s:"n",e:"w"};function Ci(e,t,n,i,o,r,a){this._canvas=e,this._dragging=t,this._eventBus=n,this._modeling=i,this._rules=o,this._toolManager=r,this._mouse=a;var c=this;r.registerTool("space",{tool:"spaceTool.selection",dragging:"spaceTool"}),n.on("spaceTool.selection.end",(function(e){n.once("spaceTool.selection.ended",(function(){c.activateMakeSpace(e.originalEvent)}))})),n.on("spaceTool.move",1500,(function(e){var t=e.context,n=t.initialized;n||(n=t.initialized=c.init(e,t)),n&&Oi(e)})),n.on("spaceTool.end",(function(e){var t=e.context,i=t.axis,o=t.direction,r=t.movingShapes,a=t.resizingShapes,s=t.start;if(t.initialized){Oi(e);var u={x:0,y:0};u[i]=Pi(e["d"+i]),c.makeSpace(r,a,u,o,s),n.once("spaceTool.ended",(function(e){c.activateSelection(e.originalEvent,!0,!0)}))}}))}function Ai(e){return{top:e.top-20,right:e.right+20,bottom:e.bottom+20,left:e.left-20}}function Oi(e){var t,n,i=e.context.spaceToolConstraints;i&&((0,s.hj)(i.left)&&(t=Math.max(e.x,i.left),e.dx=e.dx+t-e.x,e.x=t),(0,s.hj)(i.right)&&(t=Math.min(e.x,i.right),e.dx=e.dx+t-e.x,e.x=t),(0,s.hj)(i.top)&&(n=Math.max(e.y,i.top),e.dy=e.dy+n-e.y,e.y=n),(0,s.hj)(i.bottom)&&(n=Math.min(e.y,i.bottom),e.dy=e.dy+n-e.y,e.y=n))}function Li(e,t){return-1!==e.indexOf(t)}function $i(e){return!!e.waypoints}function Ii(e){return!!e.labelTarget}Ci.$inject=["canvas","dragging","eventBus","modeling","rules","toolManager","mouse"],Ci.prototype.activateSelection=function(e,t,n){this._dragging.init(e,"spaceTool.selection",{autoActivate:t,cursor:Bi,data:{context:{reactivate:n}},trapClick:!1})},Ci.prototype.activateMakeSpace=function(e){this._dragging.init(e,"spaceTool",{autoActivate:!0,cursor:Bi,data:{context:{}}})},Ci.prototype.makeSpace=function(e,t,n,i,o){return this._modeling.createSpace(e,t,n,i,o)},Ci.prototype.init=function(e,t){var n=ji(e.dx)>ji(e.dy)?"x":"y",i=e["d"+n],o=e[n]-i;if(ji(i)<5)return!1;i<0&&(i*=-1),(0,rt.RJ)(e)&&(i*=-1);var a=function(e,t){if("x"===e){if(t>0)return"e";if(t<0)return"w"}if("y"===e){if(t>0)return"s";if(t<0)return"n"}return null}(n,i),c=this._canvas.getRootElement(),u=(0,k.PB)(c,!0),l=this.calculateAdjustments(u,n,i,o),p=function(e,t,n,i,o){var a=e.movingShapes,c=e.resizingShapes;if(c.length){var u,l,p={};return(0,s.Ed)(c,(function(e){var h,d,f,m=(0,r.JA)(e),v=(0,s.hX)(e.children,(function(e){return!($i(e)||Ii(e)||Li(a,e)||Li(c,e))})),y=(0,s.hX)(e.children,(function(e){return!$i(e)&&!Ii(e)&&Li(a,e)}));v.length&&(d=Ai((0,r.JA)((0,k.jY)(v))),h=i-m[Ti[n]]+d[Ti[n]],"n"===n?p.bottom=l=(0,s.hj)(l)?Math.min(l,h):h:"w"===n?p.right=l=(0,s.hj)(l)?Math.min(l,h):h:"s"===n?p.top=u=(0,s.hj)(u)?Math.max(u,h):h:"e"===n&&(p.left=u=(0,s.hj)(u)?Math.max(u,h):h)),y.length&&(f=Ai((0,r.JA)((0,k.jY)(y))),h=i-f[Ti[Di[n]]]+m[Ti[Di[n]]],"n"===n?p.bottom=l=(0,s.hj)(l)?Math.min(l,h):h:"w"===n?p.right=l=(0,s.hj)(l)?Math.min(l,h):h:"s"===n?p.top=u=(0,s.hj)(u)?Math.max(u,h):h:"e"===n&&(p.left=u=(0,s.hj)(u)?Math.max(u,h):h));var g=o&&o[e.id];g&&("n"===n?(h=i+e[Mi[t]]-g[Mi[t]],p.bottom=l=(0,s.hj)(l)?Math.min(l,h):h):"w"===n?(h=i+e[Mi[t]]-g[Mi[t]],p.right=l=(0,s.hj)(l)?Math.min(l,h):h):"s"===n?(h=i-e[Mi[t]]+g[Mi[t]],p.top=u=(0,s.hj)(u)?Math.max(u,h):h):"e"===n&&(h=i-e[Mi[t]]+g[Mi[t]],p.left=u=(0,s.hj)(u)?Math.max(u,h):h))})),p}}(l,n,a,o,this._eventBus.fire("spaceTool.getMinDimensions",{axis:n,direction:a,shapes:l.resizingShapes,start:o}));return(0,s.f0)(t,l,{axis:n,direction:a,spaceToolConstraints:p,start:o}),(0,yn.t8)("resize-"+("x"===n?"ew":"ns")),!0},Ci.prototype.calculateAdjustments=function(e,t,n,i){var o=this._rules,r=[],a=[];return(0,s.Ed)(e,(function(e){if(e.parent&&!$i(e)){var c=e[t],s=c+e[Mi[t]];return n>0&&c>i||n<0&&s<i?r.push(e):c<i&&s>i&&o.allowed("shape.resize",{shape:e})?a.push(e):void 0}})),{movingShapes:r,resizingShapes:a}},Ci.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)},Ci.prototype.isActive=function(){var e=this._dragging.context();return e&&/^spaceTool/.test(e.prefix)};var Fi="djs-dragging",Wi="djs-resizing",zi=Math.max;function Ni(e,t,n,i,o){function r(e,t){(0,s.Ed)(e,(function(e){o.addDragger(e,t),n.addMarker(e,Fi)}))}e.on("spaceTool.selection.start",(function(e){var t=n.getLayer("space"),o=e.context,r=(0,Sn.Ue)("g");(0,Sn.Lj)(r,i.cls("djs-crosshair-group",["no-events"])),(0,Sn.R3)(t,r);var a=(0,Sn.Ue)("path");(0,Sn.Lj)(a,"d","M 0,-10000 L 0,10000"),(0,Sn.Sh)(a).add("djs-crosshair"),(0,Sn.R3)(r,a);var c=(0,Sn.Ue)("path");(0,Sn.Lj)(c,"d","M -10000,0 L 10000,0"),(0,Sn.Sh)(c).add("djs-crosshair"),(0,Sn.R3)(r,c),o.crosshairGroup=r})),e.on("spaceTool.selection.move",(function(e){var t=e.context.crosshairGroup;(0,Fn.Iu)(t,e.x,e.y)})),e.on("spaceTool.selection.cleanup",(function(e){var t=e.context.crosshairGroup;t&&(0,Sn.Od)(t)})),e.on("spaceTool.move",250,(function(e){var a=e.context,c=a.line,u=a.axis,l=a.movingShapes,p=a.resizingShapes;if(a.initialized){if(!a.dragGroup){var h=n.getLayer("space");c=(0,Sn.Ue)("path"),(0,Sn.Lj)(c,"d","M0,0 L0,0"),(0,Sn.Sh)(c).add("djs-crosshair"),(0,Sn.R3)(h,c),a.line=c;var d=(0,Sn.Ue)("g");(0,Sn.Lj)(d,i.cls("djs-drag-group",["no-events"])),(0,Sn.R3)(n.getDefaultLayer(),d),r(l,d),r(a.movingConnections=t.filter((function(e){var t=!1;(0,s.Ed)(l,(function(n){(0,s.Ed)(n.outgoing,(function(n){e===n&&(t=!0)}))}));var n=!1;(0,s.Ed)(l,(function(t){(0,s.Ed)(t.incoming,(function(t){e===t&&(n=!0)}))}));var i=!1;(0,s.Ed)(p,(function(t){(0,s.Ed)(t.outgoing,(function(t){e===t&&(i=!0)}))}));var o=!1;return(0,s.Ed)(p,(function(t){(0,s.Ed)(t.incoming,(function(t){e===t&&(o=!0)}))})),function(e){return e.waypoints}(e)&&(t||i)&&(n||o)})),d),a.dragGroup=d}if(!a.frameGroup){var f=(0,Sn.Ue)("g");(0,Sn.Lj)(f,i.cls("djs-frame-group",["no-events"])),(0,Sn.R3)(n.getDefaultLayer(),f);var m=[];(0,s.Ed)(p,(function(e){var t=o.addFrame(e,f),i=t.getBBox();m.push({element:t,initialBounds:i}),n.addMarker(e,Wi)})),a.frameGroup=f,a.frames=m}var v={x:"M"+e.x+", -10000 L"+e.x+", 10000",y:"M -10000, "+e.y+" L 10000, "+e.y};(0,Sn.Lj)(c,{d:v[u]});var y={x:e.dx,y:e.dy};y[{x:"y",y:"x"}[a.axis]]=0,(0,Fn.Iu)(a.dragGroup,y.x,y.y),(0,s.Ed)(a.frames,(function(e){var t,n,i=e.element,o=e.initialBounds;"e"===a.direction?(0,Sn.Lj)(i,{width:zi(o.width+y.x,5)}):(t=zi(o.width-y.x,5),(0,Sn.Lj)(i,{width:t,x:o.x+o.width-t})),"s"===a.direction?(0,Sn.Lj)(i,{height:zi(o.height+y.y,5)}):(n=zi(o.height-y.y,5),(0,Sn.Lj)(i,{height:n,y:o.y+o.height-n}))}))}})),e.on("spaceTool.cleanup",(function(e){var t=e.context,i=t.movingShapes,o=t.movingConnections,r=t.resizingShapes,a=t.line,c=t.dragGroup,u=t.frameGroup;(0,s.Ed)(i,(function(e){n.removeMarker(e,Fi)})),(0,s.Ed)(o,(function(e){n.removeMarker(e,Fi)})),c&&((0,Sn.Od)(a),(0,Sn.Od)(c)),(0,s.Ed)(r,(function(e){n.removeMarker(e,Wi)})),u&&(0,Sn.Od)(u)}))}Ni.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"];const Hi={__init__:["spaceToolPreview"],__depends__:[_n,Et,ki,Mn,Hn],spaceTool:["type",Ci],spaceToolPreview:["type",Ni]};function Zi(e){this._model=e}Zi.$inject=["moddle"],Zi.prototype._needsId=function(e){return v(e,["bpmn:RootElement","bpmn:FlowElement","bpmn:MessageFlow","bpmn:DataAssociation","bpmn:Artifact","bpmn:Participant","bpmn:Lane","bpmn:LaneSet","bpmn:Process","bpmn:Collaboration","bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane","bpmn:Property","bpmn:CategoryValue"])},Zi.prototype._ensureId=function(e){var t;t=(0,d.is)(e,"bpmn:Activity")?"Activity":(0,d.is)(e,"bpmn:Event")?"Event":(0,d.is)(e,"bpmn:Gateway")?"Gateway":v(e,["bpmn:SequenceFlow","bpmn:MessageFlow"])?"Flow":(e.$type||"").replace(/^[^:]*:/g,""),t+="_",!e.id&&this._needsId(e)&&(e.id=this._model.ids.nextPrefixed(t,e))},Zi.prototype.create=function(e,t){var n=this._model.create(e,t||{});return this._ensureId(n),n},Zi.prototype.createDiLabel=function(){return this.create("bpmndi:BPMNLabel",{bounds:this.createDiBounds()})},Zi.prototype.createDiShape=function(e,t,n){return this.create("bpmndi:BPMNShape",(0,s.f0)({bpmnElement:e,bounds:this.createDiBounds(t)},n))},Zi.prototype.createDiBounds=function(e){return this.create("dc:Bounds",e)},Zi.prototype.createDiWaypoints=function(e){var t=this;return(0,s.UI)(e,(function(e){return t.createDiWaypoint(e)}))},Zi.prototype.createDiWaypoint=function(e){return this.create("dc:Point",(0,s.ei)(e,["x","y"]))},Zi.prototype.createDiEdge=function(e,t,n){return this.create("bpmndi:BPMNEdge",(0,s.f0)({bpmnElement:e},n))},Zi.prototype.createDiPlane=function(e){return this.create("bpmndi:BPMNPlane",{bpmnElement:e})};var Gi=n(43);function Ui(e,t,n,i){u.call(this,e),this._bpmnFactory=t,this._translate=i;var o=this;function r(e){var t=e.context.oldRoot.children;(0,s.Ed)(t,(function(e){(0,d.is)(e,"bpmn:BaseElement")&&o.updateParent(e)}))}function a(e){var t=e.context.shape;(0,d.is)(t,"bpmn:BaseElement")&&o.updateBounds(t)}function c(e){o.updateConnection(e.context)}function l(e){o.updateConnectionWaypoints(e.context.connection)}function p(e){o.updateAttachment(e.context)}this.executed(["connection.layout","connection.create"],(function(e){var t,i=e.context,o=i.hints||{};i.cropped||!1===o.createElementsBehavior||((t=i.connection).waypoints=n.getCroppedWaypoints(t),i.cropped=!0)})),this.reverted(["connection.layout"],(function(e){delete e.context.cropped})),this.executed(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],Ki((function(e){var t=e.context;o.updateParent(t.shape||t.connection,t.oldParent)}))),this.reverted(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],Ki((function(e){var t=e.context,n=t.shape||t.connection,i=t.parent||t.newParent;o.updateParent(n,i)}))),this.executed(["canvas.updateRoot"],r),this.reverted(["canvas.updateRoot"],r),this.executed(["shape.move","shape.create","shape.resize"],Ki((function(e){"label"!==e.context.shape.type&&a(e)}))),this.reverted(["shape.move","shape.create","shape.resize"],Ki((function(e){"label"!==e.context.shape.type&&a(e)}))),e.on("shape.changed",(function(e){"label"===e.element.type&&a({context:{shape:e.element}})})),this.executed(["connection.create","connection.move","connection.delete","connection.reconnect"],Ki(c)),this.reverted(["connection.create","connection.move","connection.delete","connection.reconnect"],Ki(c)),this.executed(["connection.layout","connection.move","connection.updateWaypoints"],Ki(l)),this.reverted(["connection.layout","connection.move","connection.updateWaypoints"],Ki(l)),this.executed("connection.reconnect",Ki((function(e){var t=e.context,n=t.connection,i=t.oldSource,o=t.newSource,r=(0,d.S)(n),a=(0,d.S)(i),c=(0,d.S)(o);r.conditionExpression&&!v(c,["bpmn:Activity","bpmn:ExclusiveGateway","bpmn:InclusiveGateway"])&&(t.oldConditionExpression=r.conditionExpression,delete r.conditionExpression),i!==o&&a.default===r&&(t.oldDefault=a.default,delete a.default)}))),this.reverted("connection.reconnect",Ki((function(e){var t=e.context,n=t.connection,i=t.oldSource,o=t.newSource,r=(0,d.S)(n),a=(0,d.S)(i),c=(0,d.S)(o);t.oldConditionExpression&&(r.conditionExpression=t.oldConditionExpression),t.oldDefault&&(a.default=t.oldDefault,delete c.default)}))),this.executed(["element.updateAttachment"],Ki(p)),this.reverted(["element.updateAttachment"],Ki(p))}function Ki(e){return function(t){var n=t.context,i=n.shape||n.connection;(0,d.is)(i,"bpmn:BaseElement")&&e(t)}}o()(Ui,u),Ui.$inject=["eventBus","bpmnFactory","connectionDocking","translate"],Ui.prototype.updateAttachment=function(e){var t=e.shape,n=t.businessObject,i=t.host;n.attachedToRef=i&&i.businessObject},Ui.prototype.updateParent=function(e,t){if(!(e instanceof Gi.__||(0,d.is)(e,"bpmn:DataStoreReference")&&e.parent&&(0,d.is)(e.parent,"bpmn:Collaboration"))){var n=e.parent,i=e.businessObject,o=n&&n.businessObject,r=o&&o.di;(0,d.is)(e,"bpmn:FlowNode")&&this.updateFlowNodeRefs(i,o,t&&t.businessObject),(0,d.is)(e,"bpmn:DataOutputAssociation")&&(o=e.source?e.source.businessObject:null),(0,d.is)(e,"bpmn:DataInputAssociation")&&(o=e.target?e.target.businessObject:null),this.updateSemanticParent(i,o),(0,d.is)(e,"bpmn:DataObjectReference")&&i.dataObjectRef&&this.updateSemanticParent(i.dataObjectRef,o),this.updateDiParent(i.di,r)}},Ui.prototype.updateBounds=function(e){var t=e.businessObject.di,n=e instanceof Gi.__?this._getLabel(t):t,i=n.bounds;i||(i=this._bpmnFactory.createDiBounds(),n.set("bounds",i)),(0,s.f0)(i,{x:e.x,y:e.y,width:e.width,height:e.height})},Ui.prototype.updateFlowNodeRefs=function(e,t,n){var i,o;n!==t&&((0,d.is)(n,"bpmn:Lane")&&(i=n.get("flowNodeRef"),(0,E.Od)(i,e)),(0,d.is)(t,"bpmn:Lane")&&(o=t.get("flowNodeRef"),(0,E.IH)(o,e)))},Ui.prototype.updateDiConnection=function(e,t,n){e.sourceElement&&e.sourceElement.bpmnElement!==t&&(e.sourceElement=t&&t.di),e.targetElement&&e.targetElement.bpmnElement!==n&&(e.targetElement=n&&n.di)},Ui.prototype.updateDiParent=function(e,t){if(t&&!(0,d.is)(t,"bpmndi:BPMNPlane")&&(t=t.$parent),e.$parent!==t){var n=(t||e.$parent).get("planeElement");t?(n.push(e),e.$parent=t):((0,E.Od)(n,e),e.$parent=null)}},Ui.prototype.getLaneSet=function(e){var t,n;return(0,d.is)(e,"bpmn:Lane")?((t=e.childLaneSet)||(t=this._bpmnFactory.create("bpmn:LaneSet"),e.childLaneSet=t,t.$parent=e),t):((0,d.is)(e,"bpmn:Participant")&&(e=e.processRef),(t=(n=e.get("laneSets"))[0])||((t=this._bpmnFactory.create("bpmn:LaneSet")).$parent=e,n.push(t)),t)},Ui.prototype.updateSemanticParent=function(e,t,n){var i,o=this._translate;if(e.$parent!==t&&(!(0,d.is)(e,"bpmn:DataInput")&&!(0,d.is)(e,"bpmn:DataOutput")||((0,d.is)(t,"bpmn:Participant")&&"processRef"in t&&(t=t.processRef),!("ioSpecification"in t)||t.ioSpecification!==e.$parent))){if((0,d.is)(e,"bpmn:Lane"))t&&(t=this.getLaneSet(t)),i="lanes";else if((0,d.is)(e,"bpmn:FlowElement")){if(t)if((0,d.is)(t,"bpmn:Participant"))t=t.processRef;else if((0,d.is)(t,"bpmn:Lane"))do{t=t.$parent.$parent}while((0,d.is)(t,"bpmn:Lane"));i="flowElements"}else if((0,d.is)(e,"bpmn:Artifact")){for(;t&&!(0,d.is)(t,"bpmn:Process")&&!(0,d.is)(t,"bpmn:SubProcess")&&!(0,d.is)(t,"bpmn:Collaboration");){if((0,d.is)(t,"bpmn:Participant")){t=t.processRef;break}t=t.$parent}i="artifacts"}else if((0,d.is)(e,"bpmn:MessageFlow"))i="messageFlows";else if((0,d.is)(e,"bpmn:Participant")){i="participants";var r,a=e.processRef;a&&(r=function(e){for(;e&&!(0,d.is)(e,"bpmn:Definitions");)e=e.$parent;return e}(e.$parent||t),e.$parent&&((0,E.Od)(r.get("rootElements"),a),a.$parent=null),t&&((0,E.IH)(r.get("rootElements"),a),a.$parent=r))}else(0,d.is)(e,"bpmn:DataOutputAssociation")?i="dataOutputAssociations":(0,d.is)(e,"bpmn:DataInputAssociation")&&(i="dataInputAssociations");if(!i)throw new Error(o("no parent for {element} in {parent}",{element:e.id,parent:t.id}));var c;if(e.$parent&&(c=e.$parent.get(i),(0,E.Od)(c,e)),t?((c=t.get(i)).push(e),e.$parent=t):e.$parent=null,n){var s=n.get(i);(0,E.Od)(c,e),t&&(s||(s=[],t.set(i,s)),s.push(e))}}},Ui.prototype.updateConnectionWaypoints=function(e){e.businessObject.di.set("waypoint",this._bpmnFactory.createDiWaypoints(e.waypoints))},Ui.prototype.updateConnection=function(e){var t,n=e.connection,i=(0,d.S)(n),o=(0,d.S)(n.source),r=(0,d.S)(n.target);if((0,d.is)(i,"bpmn:DataAssociation"))(0,d.is)(i,"bpmn:DataInputAssociation")?(i.get("sourceRef")[0]=o,t=e.parent||e.newParent||r,this.updateSemanticParent(i,r,t)):(0,d.is)(i,"bpmn:DataOutputAssociation")&&(t=e.parent||e.newParent||o,this.updateSemanticParent(i,o,t),i.targetRef=r);else{var a=(0,d.is)(i,"bpmn:SequenceFlow");i.sourceRef!==o&&(a&&((0,E.Od)(i.sourceRef&&i.sourceRef.get("outgoing"),i),o&&o.get("outgoing")&&o.get("outgoing").push(i)),i.sourceRef=o),i.targetRef!==r&&(a&&((0,E.Od)(i.targetRef&&i.targetRef.get("incoming"),i),r&&r.get("incoming")&&r.get("incoming").push(i)),i.targetRef=r)}this.updateConnectionWaypoints(n),this.updateDiConnection(i.di,o,r)},Ui.prototype._getLabel=function(e){return e.label||(e.label=this._bpmnFactory.createDiLabel()),e.label};var Vi=n(149);function qi(e,t,n){Vi.Z.call(this),this._bpmnFactory=e,this._moddle=t,this._translate=n}function Yi(e,t,n){e[n]=t[n],delete t[n]}function Ji(e,t){this._modeling=e,this._canvas=t}function Xi(e){this._modeling=e}function Qi(e,t){this._canvas=e,this._layouter=t}o()(qi,Vi.Z),qi.$inject=["bpmnFactory","moddle","translate"],qi.prototype.baseCreate=Vi.Z.prototype.create,qi.prototype.create=function(e,t){return"label"===e?this.baseCreate(e,(0,s.f0)({type:"label"},c.DN,t)):this.createBpmnElement(e,t)},qi.prototype.createBpmnElement=function(e,t){var n,i,o,r=this._translate,a=(t=t||{}).businessObject;if(!a){if(!t.type)throw new Error(r("no shape type specified"));a=this._bpmnFactory.create(t.type)}return a.di||(a.di="root"===e?this._bpmnFactory.createDiPlane(a,[],{id:a.id+"_di"}):"connection"===e?this._bpmnFactory.createDiEdge(a,[],{id:a.id+"_di"}):this._bpmnFactory.createDiShape(a,{},{id:a.id+"_di"})),(0,d.is)(a,"bpmn:Group")&&(t=(0,s.f0)({isFrame:!0},t)),t.di&&((0,s.f0)(a.di,t.di),delete t.di),function(e,t,n){(0,s.Ed)(["processRef","isInterrupting","associationDirection","isForCompensation"],(function(n){void 0!==t[n]&&Yi(e,t,n)}))}(a,t),t.isExpanded&&Yi(a.di,t,"isExpanded"),(0,d.is)(a,"bpmn:ExclusiveGateway")&&(a.di.isMarkerVisible=!0),t.eventDefinitionType&&(i=a.get("eventDefinitions")||[],o=this._bpmnFactory.create(t.eventDefinitionType,t.eventDefinitionAttrs),"bpmn:ConditionalEventDefinition"===t.eventDefinitionType&&(o.condition=this._bpmnFactory.create("bpmn:FormalExpression")),i.push(o),o.$parent=a,a.eventDefinitions=i,delete t.eventDefinitionType),n=this._getDefaultSize(a),t=(0,s.f0)({businessObject:a,id:a.id},n,t),this.baseCreate(e,t)},qi.prototype._getDefaultSize=function(e){return(0,d.is)(e,"bpmn:SubProcess")?(0,w.ul)(e)?{width:350,height:200}:{width:100,height:80}:(0,d.is)(e,"bpmn:Task")?{width:100,height:80}:(0,d.is)(e,"bpmn:Gateway")?{width:50,height:50}:(0,d.is)(e,"bpmn:Event")?{width:36,height:36}:(0,d.is)(e,"bpmn:Participant")?(0,w.ul)(e)?{width:600,height:250}:{width:400,height:60}:(0,d.is)(e,"bpmn:Lane")?{width:400,height:100}:(0,d.is)(e,"bpmn:DataObjectReference")?{width:36,height:50}:(0,d.is)(e,"bpmn:DataStoreReference")?{width:50,height:50}:(0,d.is)(e,"bpmn:TextAnnotation")?{width:100,height:30}:(0,d.is)(e,"bpmn:Group")?{width:300,height:300}:{width:100,height:80}},qi.prototype.createParticipantShape=function(e){return(0,s.Kn)(e)||(e={isExpanded:e}),!1!==(e=(0,s.f0)({type:"bpmn:Participant"},e||{})).isExpanded&&(e.processRef=this._bpmnFactory.create("bpmn:Process")),this.createShape(e)},Ji.$inject=["modeling","canvas"],Ji.prototype.preExecute=function(e){var t=this._modeling,n=e.elements,i=e.alignment;(0,s.Ed)(n,(function(e){var n={x:0,y:0};i.left?n.x=i.left-e.x:i.right?n.x=i.right-e.width-e.x:i.center?n.x=i.center-Math.round(e.width/2)-e.x:i.top?n.y=i.top-e.y:i.bottom?n.y=i.bottom-e.height-e.y:i.middle&&(n.y=i.middle-Math.round(e.height/2)-e.y),t.moveElements([e],n,e.parent)}))},Ji.prototype.postExecute=function(e){},Xi.$inject=["modeling"],Xi.prototype.preExecute=function(e){var t=e.source;if(!t)throw new Error("source required");var n=e.target||t.parent,i=e.shape,o=e.hints||{};i=e.shape=this._modeling.createShape(i,e.position,n,{attach:o.attach}),e.shape=i},Xi.prototype.postExecute=function(e){var t,n,i=e.hints||{};t=e.source,n=e.shape,(0,s.G)(t.outgoing,(function(e){return e.target===n}))||(i.connectionTarget===e.source?this._modeling.connect(e.shape,e.source,e.connection):this._modeling.connect(e.source,e.shape,e.connection))},Qi.$inject=["canvas","layouter"],Qi.prototype.execute=function(e){var t=e.connection,n=e.source,i=e.target,o=e.parent,r=e.parentIndex,a=e.hints;if(!n||!i)throw new Error("source and target required");if(!o)throw new Error("parent required");return t.source=n,t.target=i,t.waypoints||(t.waypoints=this._layouter.layoutConnection(t,a)),this._canvas.addConnection(t,o,r),t},Qi.prototype.revert=function(e){var t=e.connection;return this._canvas.removeConnection(t),t.source=null,t.target=null,t};var eo=Math.round;function to(e){this._modeling=e}function no(e){return!!e.waypoints}to.$inject=["modeling"],to.prototype.preExecute=function(e){var t=e.elements,n=e.parent,i=e.parentIndex,o=e.position,r=e.hints,a=this._modeling;(0,s.Ed)(t,(function(e){(0,s.hj)(e.x)||(e.x=0),(0,s.hj)(e.y)||(e.y=0)}));var c=(0,k.jY)(t);(0,s.Ed)(t,(function(e){no(e)&&(e.waypoints=(0,s.UI)(e.waypoints,(function(e){return{x:eo(e.x-c.x-c.width/2+o.x),y:eo(e.y-c.y-c.height/2+o.y)}}))),(0,s.f0)(e,{x:eo(e.x-c.x-c.width/2+o.x),y:eo(e.y-c.y-c.height/2+o.y)})}));var u=(0,k.cd)(t),l={};(0,s.Ed)(t,(function(e){if(no(e))l[e.id]=(0,s.hj)(i)?a.createConnection(l[e.source.id],l[e.target.id],i,e,e.parent||n,r):a.createConnection(l[e.source.id],l[e.target.id],e,e.parent||n,r);else{var t=(0,s.f0)({},r);-1===u.indexOf(e)&&(t.autoResize=!1),l[e.id]=(0,s.hj)(i)?a.createShape(e,(0,s.ei)(e,["x","y","width","height"]),e.parent||n,i,t):a.createShape(e,(0,s.ei)(e,["x","y","width","height"]),e.parent||n,t)}})),e.elements=(0,s.VO)(l)};var io=Math.round;function oo(e){this._canvas=e}function ro(e){oo.call(this,e)}oo.$inject=["canvas"],oo.prototype.execute=function(e){var t=e.shape,n=e.position,i=e.parent,o=e.parentIndex;if(!i)throw new Error("parent required");if(!n)throw new Error("position required");return void 0!==n.width?(0,s.f0)(t,n):(0,s.f0)(t,{x:n.x-io(t.width/2),y:n.y-io(t.height/2)}),this._canvas.addShape(t,i,o),t},oo.prototype.revert=function(e){var t=e.shape;return this._canvas.removeShape(t),t},o()(ro,oo),ro.$inject=["canvas"];var ao=oo.prototype.execute;ro.prototype.execute=function(e){var t=e.shape;return function(e){["width","height"].forEach((function(t){void 0===e[t]&&(e[t]=0)}))}(t),t.labelTarget=e.labelTarget,ao.call(this,e)};var co=oo.prototype.revert;function so(e,t){this._canvas=e,this._modeling=t}function uo(e,t){this._modeling=e,this._elementRegistry=t}function lo(e,t){this._canvas=e,this._modeling=t}function po(e){this._modeling=e}ro.prototype.revert=function(e){return e.shape.labelTarget=null,co.call(this,e)},so.$inject=["canvas","modeling"],so.prototype.execute=function(e){var t=e.connection,n=t.parent;return e.parent=n,e.parentIndex=(0,E.cq)(n.children,t),e.source=t.source,e.target=t.target,this._canvas.removeConnection(t),t.source=null,t.target=null,t},so.prototype.revert=function(e){var t=e.connection,n=e.parent,i=e.parentIndex;return t.source=e.source,t.target=e.target,(0,E.IH)(n.children,t,i),this._canvas.addConnection(t,n),t},uo.$inject=["modeling","elementRegistry"],uo.prototype.postExecute=function(e){var t=this._modeling,n=this._elementRegistry,i=e.elements;(0,s.Ed)(i,(function(e){n.get(e.id)&&(e.waypoints?t.removeConnection(e):t.removeShape(e))}))},lo.$inject=["canvas","modeling"],lo.prototype.preExecute=function(e){var t=this._modeling,n=e.shape;fi(n.incoming,(function(e){t.removeConnection(e,{nested:!0})})),fi(n.outgoing,(function(e){t.removeConnection(e,{nested:!0})})),fi(n.children,(function(e){e.waypoints?t.removeConnection(e,{nested:!0}):t.removeShape(e,{nested:!0})}))},lo.prototype.execute=function(e){var t=this._canvas,n=e.shape,i=n.parent;return e.oldParent=i,e.oldParentIndex=(0,E.cq)(i.children,n),t.removeShape(n),n},lo.prototype.revert=function(e){var t=this._canvas,n=e.shape,i=e.oldParent,o=e.oldParentIndex;return(0,E.IH)(i.children,n,o),t.addShape(n,i),n},po.$inject=["modeling"];var ho={x:"y",y:"x"};function fo(e,t){this._layouter=e,this._canvas=t}function mo(){}function vo(){this.allShapes={},this.allConnections={},this.enclosedElements={},this.enclosedConnections={},this.topLevel={}}function yo(e){this._modeling=e}function go(e){this._helper=new yo(e)}function xo(e){this._modeling=e,this._helper=new yo(e)}function bo(e){this._modeling=e}function Eo(e){return e.original||e}function wo(e,t){this._modeling=e,this._rules=t}function _o(e){this._modeling=e}function So(e){this._modeling=e}function ko(e){return(0,s.f0)({},e)}function Ro(e){switch(e){case"n":return"y";case"w":return"x";case"s":return"y";case"e":return"x"}}function jo(e,t,n){var i=Ro(n);return/e|s/.test(n)?e[i]>t:/n|w/.test(n)?e[i]<t:void 0}function Po(e,t){return-1!==e.indexOf(t)}function Mo(e){this._modeling=e}function Bo(e){var t={};return(0,s.Ed)(e,(function(e){t[e.id]=e.hidden,e.children&&(t=(0,s.f0)({},t,Bo(e.children)))})),t}function To(e,t){var n=[];return(0,s.Ed)(e,(function(e){e.hidden=t,n=n.concat(e),e.children&&(n=n.concat(To(e.children,e.collapsed||t)))})),n}function Do(e,t){var n=[];return(0,s.Ed)(e,(function(e){e.hidden=t[e.id],n=n.concat(e),e.children&&(n=n.concat(Do(e.children,t)))})),n}function Co(e){this._modeling=e}function Ao(e,t){return(0,E.Od)(e&&e.attachers,t)}function Oo(e,t,n){if(e){var i=e.attachers;i||(e.attachers=i=[]),(0,E.IH)(i,t,n)}}function Lo(){}function $o(e,t,n){this._eventBus=e,this._elementFactory=t,this._commandStack=n;var i=this;e.on("diagram.init",(function(){i.registerHandlers(n)}))}po.prototype.preExecute=function(e){var t=this._modeling,n=e.groups,i=e.axis,o=e.dimension;function r(e,t){e.range.min=Math.min(t[i],e.range.min),e.range.max=Math.max(t[i]+t[o],e.range.max)}function a(e){return e[i]+e[o]/2}function c(e){return e.length-1}function u(e){return e.max-e.min}var l,p,h=n[0],d=c(n),f=n[d],m=0;(0,s.Ed)(n,(function(e,l){var p,h,f;e.elements.length<2?l&&l!==n.length-1&&(r(e,e.elements[0]),m+=u(e.range)):(h=(p=(0,s.MR)(e.elements,i))[0],l===d&&(h=p[c(p)]),f=a(h),e.range=null,(0,s.Ed)(p,(function(n){!function(e,n){var o={y:0};o[i]=e-a(n),o[i]&&(o[ho[i]]=0,t.moveElements([n],o,n.parent))}(f,n),null!==e.range?r(e,n):e.range={min:n[i],max:n[i]+n[o]}})),l&&l!==n.length-1&&(m+=u(e.range)))})),p=Math.abs(f.range.min-h.range.max),(l=Math.round((p-m)/(n.length-1)))<n.length-1||(0,s.Ed)(n,(function(e,r){var a,c={};e!==h&&e!==f&&(a=n[r-1],e.range.max=0,(0,s.Ed)(e.elements,(function(n,r){c[ho[i]]=0,c[i]=a.range.max-n[i]+l,e.range.min!==n[i]&&(c[i]+=n[i]-e.range.min),c[i]&&t.moveElements([n],c,n.parent),e.range.max=Math.max(n[i]+n[o],r?e.range.max:0)})))}))},po.prototype.postExecute=function(e){},fo.$inject=["layouter","canvas"],fo.prototype.execute=function(e){var t=e.connection,n=t.waypoints;return(0,s.f0)(e,{oldWaypoints:n}),t.waypoints=this._layouter.layoutConnection(t,e.hints),t},fo.prototype.revert=function(e){var t=e.connection;return t.waypoints=e.oldWaypoints,t},mo.prototype.execute=function(e){var t=e.connection,n=e.delta,i=e.newParent||t.parent,o=e.newParentIndex,r=t.parent;return e.oldParent=r,e.oldParentIndex=(0,E.Od)(r.children,t),(0,E.IH)(i.children,t,o),t.parent=i,(0,s.Ed)(t.waypoints,(function(e){e.x+=n.x,e.y+=n.y,e.original&&(e.original.x+=n.x,e.original.y+=n.y)})),t},mo.prototype.revert=function(e){var t=e.connection,n=t.parent,i=e.oldParent,o=e.oldParentIndex,r=e.delta;return(0,E.Od)(n.children,t),(0,E.IH)(i.children,t,o),t.parent=i,(0,s.Ed)(t.waypoints,(function(e){e.x-=r.x,e.y-=r.y,e.original&&(e.original.x-=r.x,e.original.y-=r.y)})),t},vo.prototype.add=function(e,t){return this.addAll([e],t)},vo.prototype.addAll=function(e,t){var n=(0,k.vA)(e,!!t,this);return(0,s.f0)(this,n),this},yo.prototype.moveRecursive=function(e,t,n){return e?this.moveClosure(this.getClosure(e),t,n):[]},yo.prototype.moveClosure=function(e,t,n,i,o){var r=this._modeling,a=e.allShapes,c=e.allConnections,u=e.enclosedConnections,l=e.topLevel,p=!1;o&&o.parent===n&&(p=!0),(0,s.Ed)(a,(function(e){r.moveShape(e,t,l[e.id]&&!p&&n,{recurse:!1,layout:!1})})),(0,s.Ed)(c,(function(e){var i=!!a[e.source.id],o=!!a[e.target.id];u[e.id]&&i&&o?r.moveConnection(e,t,l[e.id]&&!p&&n):r.layoutConnection(e,{connectionStart:i&&Le(e,e.source,t),connectionEnd:o&&$e(e,e.target,t)})}))},yo.prototype.getClosure=function(e){return(new vo).addAll(e,!0)},go.$inject=["modeling"],go.prototype.preExecute=function(e){e.closure=this._helper.getClosure(e.shapes)},go.prototype.postExecute=function(e){var t,n=e.hints;n&&n.primaryShape&&(t=n.primaryShape,n.oldParent=t.parent),this._helper.moveClosure(e.closure,e.delta,e.newParent,e.newHost,t)},xo.$inject=["modeling"],xo.prototype.execute=function(e){var t=e.shape,n=e.delta,i=e.newParent||t.parent,o=e.newParentIndex,r=t.parent;return e.oldBounds=(0,s.ei)(t,["x","y","width","height"]),e.oldParent=r,e.oldParentIndex=(0,E.Od)(r.children,t),(0,E.IH)(i.children,t,o),(0,s.f0)(t,{parent:i,x:t.x+n.x,y:t.y+n.y}),t},xo.prototype.postExecute=function(e){var t=e.shape,n=e.delta,i=e.hints,o=this._modeling;!1!==i.layout&&((0,s.Ed)(t.incoming,(function(e){o.layoutConnection(e,{connectionEnd:$e(e,t,n)})})),(0,s.Ed)(t.outgoing,(function(e){o.layoutConnection(e,{connectionStart:Le(e,t,n)})}))),!1!==i.recurse&&this.moveChildren(e)},xo.prototype.revert=function(e){var t=e.shape,n=e.oldParent,i=e.oldParentIndex,o=e.delta;return(0,E.IH)(n.children,t,i),(0,s.f0)(t,{parent:n,x:t.x-o.x,y:t.y-o.y}),t},xo.prototype.moveChildren=function(e){var t=e.delta,n=e.shape;this._helper.moveRecursive(n.children,t,null)},xo.prototype.getNewParent=function(e){return e.newParent||e.shape.parent},bo.$inject=["modeling"],bo.prototype.execute=function(e){var t=e.newSource,n=e.newTarget,i=e.connection,o=e.dockingOrPoints;if(!t&&!n)throw new Error("newSource or newTarget required");return(0,s.kJ)(o)&&(e.oldWaypoints=i.waypoints,i.waypoints=o),t&&(e.oldSource=i.source,i.source=t),n&&(e.oldTarget=i.target,i.target=n),i},bo.prototype.postExecute=function(e){var t=e.connection,n=e.newSource,i=e.newTarget,o=e.dockingOrPoints,r=e.hints||{},a={};r.connectionStart&&(a.connectionStart=r.connectionStart),r.connectionEnd&&(a.connectionEnd=r.connectionEnd),!1!==r.layoutConnection&&(!n||i&&"source"!==r.docking||(a.connectionStart=a.connectionStart||Eo((0,s.kJ)(o)?o[0]:o)),!i||n&&"target"!==r.docking||(a.connectionEnd=a.connectionEnd||Eo((0,s.kJ)(o)?o[o.length-1]:o)),r.newWaypoints&&(a.waypoints=r.newWaypoints),this._modeling.layoutConnection(t,a))},bo.prototype.revert=function(e){var t=e.oldSource,n=e.oldTarget,i=e.oldWaypoints,o=e.connection;return t&&(o.source=t),n&&(o.target=n),i&&(o.waypoints=i),o},wo.$inject=["modeling","rules"],wo.prototype.preExecute=function(e){var t,n=this,i=this._modeling,o=this._rules,r=e.oldShape,a=e.newData,c=e.hints||{};function u(e,t,n){return o.allowed("connection.reconnect",{connection:n,source:e,target:t})}var l,p={x:a.x,y:a.y},h={x:r.x,y:r.y,width:r.width,height:r.height};t=e.newShape=e.newShape||n.createShape(a,p,r.parent,c),r.host&&i.updateAttachment(t,r.host),!1!==c.moveChildren&&(l=r.children.slice(),i.moveElements(l,{x:0,y:0},t,c));var d=r.incoming.slice(),f=r.outgoing.slice();(0,s.Ed)(d,(function(e){u(e.source,t,e)&&n.reconnectEnd(e,t,Oe(e,t,h),c)})),(0,s.Ed)(f,(function(e){var i=e.target;u(t,i,e)&&n.reconnectStart(e,t,Ae(e,t,h),c)}))},wo.prototype.postExecute=function(e){var t=e.oldShape;this._modeling.removeShape(t)},wo.prototype.execute=function(e){},wo.prototype.revert=function(e){},wo.prototype.createShape=function(e,t,n,i){return this._modeling.createShape(e,t,n,i)},wo.prototype.reconnectStart=function(e,t,n,i){this._modeling.reconnectStart(e,t,n,i)},wo.prototype.reconnectEnd=function(e,t,n,i){this._modeling.reconnectEnd(e,t,n,i)},_o.$inject=["modeling"],_o.prototype.execute=function(e){var t=e.shape,n=e.newBounds,i=e.minBounds;if(void 0===n.x||void 0===n.y||void 0===n.width||void 0===n.height)throw new Error("newBounds must have {x, y, width, height} properties");if(i&&(n.width<i.width||n.height<i.height))throw new Error("width and height cannot be less than minimum height and width");if(!i&&n.width<10||n.height<10)throw new Error("width and height cannot be less than 10px");return e.oldBounds={width:t.width,height:t.height,x:t.x,y:t.y},(0,s.f0)(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t},_o.prototype.postExecute=function(e){var t=this._modeling,n=e.shape,i=e.oldBounds;!1!==(e.hints||{}).layout&&((0,s.Ed)(n.incoming,(function(e){t.layoutConnection(e,{connectionEnd:Oe(e,n,i)})})),(0,s.Ed)(n.outgoing,(function(e){t.layoutConnection(e,{connectionStart:Ae(e,n,i)})})))},_o.prototype.revert=function(e){var t=e.shape,n=e.oldBounds;return(0,s.f0)(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t},So.$inject=["modeling"],So.prototype.preExecute=function(e){var t=e.delta,n=e.direction,i=e.movingShapes,o=e.resizingShapes,r=e.start,a={};this.moveShapes(i,t),(0,s.Ed)(o,(function(e){a[e.id]=function(e){return{x:e.x,y:e.y,height:e.height,width:e.width}}(e)})),this.resizeShapes(o,t,n),this.updateConnectionWaypoints(function(e,t){var n=[];return(0,s.Ed)(e.concat(t),(function(i){var o=i.incoming,r=i.outgoing;(0,s.Ed)(o.concat(r),(function(i){var o=i.source,r=i.target;(Ri(e,o)||Ri(e,r)||Ri(t,o)||Ri(t,r))&&(Ri(n,i)||n.push(i))}))})),n}(i,o),t,n,r,i,o,a)},So.prototype.execute=function(){},So.prototype.revert=function(){},So.prototype.moveShapes=function(e,t){var n=this;(0,s.Ed)(e,(function(e){n._modeling.moveShape(e,t,null,{autoResize:!1,layout:!1,recurse:!1})}))},So.prototype.resizeShapes=function(e,t,n){var i=this;(0,s.Ed)(e,(function(e){var o=function(e,t,n){var i=e.x,o=e.y,r=e.width,a=e.height,c=n.x,s=n.y;switch(t){case"n":return{x:i,y:o+s,width:r,height:a-s};case"s":return{x:i,y:o,width:r,height:a+s};case"w":return{x:i+c,y:o,width:r-c,height:a};case"e":return{x:i,y:o,width:r+c,height:a};default:throw new Error("unknown direction: "+t)}}(e,n,t);i._modeling.resizeShape(e,o,null,{attachSupport:!1,autoResize:!1,layout:!1})}))},So.prototype.updateConnectionWaypoints=function(e,t,n,i,o,r,a){var c=this,u=o.concat(r);(0,s.Ed)(e,(function(e){var l=e.source,p=e.target,h=function(e){return(0,s.UI)(e.waypoints,(function(e){return(e=ko(e)).original&&(e.original=ko(e.original)),e}))}(e),d=Ro(n),f={labelBehavior:!1};Po(u,l)&&Po(u,p)?(h=(0,s.UI)(h,(function(e){return jo(e,i,n)&&(e[d]=e[d]+t[d]),e.original&&jo(e.original,i,n)&&(e.original[d]=e.original[d]+t[d]),e})),c._modeling.updateWaypoints(e,h,{labelBehavior:!1})):(Po(u,l)||Po(u,p))&&(Po(o,l)?f.connectionStart=Le(e,l,t):Po(o,p)?f.connectionEnd=$e(e,p,t):Po(r,l)?f.connectionStart=Ae(e,l,a[l.id]):Po(r,p)&&(f.connectionEnd=Oe(e,p,a[p.id])),c._modeling.layoutConnection(e,f))}))},Mo.$inject=["modeling"],Mo.prototype.execute=function(e){var t=e.shape,n=t.children;e.oldChildrenVisibility=Bo(n),t.collapsed=!t.collapsed;var i=To(n,t.collapsed);return[t].concat(i)},Mo.prototype.revert=function(e){var t=e.shape,n=e.oldChildrenVisibility,i=Do(t.children,n);return t.collapsed=!t.collapsed,[t].concat(i)},Co.$inject=["modeling"],Co.prototype.execute=function(e){var t=e.shape,n=e.newHost,i=t.host;return e.oldHost=i,e.attacherIdx=Ao(i,t),Oo(n,t),t.host=n,t},Co.prototype.revert=function(e){var t=e.shape,n=e.newHost,i=e.oldHost,o=e.attacherIdx;return t.host=i,Ao(n,t),Oo(i,t,o),t},Lo.prototype.execute=function(e){var t=e.connection,n=e.newWaypoints;return e.oldWaypoints=t.waypoints,t.waypoints=n,t},Lo.prototype.revert=function(e){var t=e.connection,n=e.oldWaypoints;return t.waypoints=n,t},$o.$inject=["eventBus","elementFactory","commandStack"],$o.prototype.getHandlers=function(){return{"shape.append":Xi,"shape.create":oo,"shape.delete":lo,"shape.move":xo,"shape.resize":_o,"shape.replace":wo,"shape.toggleCollapse":Mo,spaceTool:So,"label.create":ro,"connection.create":Qi,"connection.delete":so,"connection.move":mo,"connection.layout":fo,"connection.updateWaypoints":Lo,"connection.reconnect":bo,"elements.create":to,"elements.move":go,"elements.delete":uo,"elements.distribute":po,"elements.align":Ji,"element.updateAttachment":Co}},$o.prototype.registerHandlers=function(e){(0,s.Ed)(this.getHandlers(),(function(t,n){e.registerHandler(n,t)}))},$o.prototype.moveShape=function(e,t,n,i,o){"object"==typeof i&&(o=i,i=null);var r={shape:e,delta:t,newParent:n,newParentIndex:i,hints:o||{}};this._commandStack.execute("shape.move",r)},$o.prototype.updateAttachment=function(e,t){var n={shape:e,newHost:t};this._commandStack.execute("element.updateAttachment",n)},$o.prototype.moveElements=function(e,t,n,i){var o,r=(i=i||{}).attach,a=n;!0===r?(o=n,a=n.parent):!1===r&&(o=null);var c={shapes:e,delta:t,newParent:a,newHost:o,hints:i};this._commandStack.execute("elements.move",c)},$o.prototype.moveConnection=function(e,t,n,i,o){"object"==typeof i&&(o=i,i=void 0);var r={connection:e,delta:t,newParent:n,newParentIndex:i,hints:o||{}};this._commandStack.execute("connection.move",r)},$o.prototype.layoutConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.layout",n)},$o.prototype.createConnection=function(e,t,n,i,o,r){"object"==typeof n&&(r=o,o=i,i=n,n=void 0);var a={source:e,target:t,parent:o,parentIndex:n,connection:i=this._create("connection",i),hints:r};return this._commandStack.execute("connection.create",a),a.connection},$o.prototype.createShape=function(e,t,n,i,o){"number"!=typeof i&&(o=i,i=void 0);var r,a,c=(o=o||{}).attach;e=this._create("shape",e),c?(r=n.parent,a=n):r=n;var s={position:t,shape:e,parent:r,parentIndex:i,host:a,hints:o};return this._commandStack.execute("shape.create",s),s.shape},$o.prototype.createElements=function(e,t,n,i,o){(0,s.kJ)(e)||(e=[e]),"number"!=typeof i&&(o=i,i=void 0);var r={position:t,elements:e,parent:n,parentIndex:i,hints:o=o||{}};return this._commandStack.execute("elements.create",r),r.elements},$o.prototype.createLabel=function(e,t,n,i){n=this._create("label",n);var o={labelTarget:e,position:t,parent:i||e.parent,shape:n};return this._commandStack.execute("label.create",o),o.shape},$o.prototype.appendShape=function(e,t,n,i,o){o=o||{};var r={source:e,position:n,target:i,shape:t=this._create("shape",t),connection:o.connection,connectionParent:o.connectionParent,hints:o};return this._commandStack.execute("shape.append",r),r.shape},$o.prototype.removeElements=function(e){var t={elements:e};this._commandStack.execute("elements.delete",t)},$o.prototype.distributeElements=function(e,t,n){var i={groups:e,axis:t,dimension:n};this._commandStack.execute("elements.distribute",i)},$o.prototype.removeShape=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.delete",n)},$o.prototype.removeConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.delete",n)},$o.prototype.replaceShape=function(e,t,n){var i={oldShape:e,newData:t,hints:n||{}};return this._commandStack.execute("shape.replace",i),i.newShape},$o.prototype.alignElements=function(e,t){var n={elements:e,alignment:t};this._commandStack.execute("elements.align",n)},$o.prototype.resizeShape=function(e,t,n,i){var o={shape:e,newBounds:t,minBounds:n,hints:i};this._commandStack.execute("shape.resize",o)},$o.prototype.createSpace=function(e,t,n,i,o){var r={delta:n,direction:i,movingShapes:e,resizingShapes:t,start:o};this._commandStack.execute("spaceTool",r)},$o.prototype.updateWaypoints=function(e,t,n){var i={connection:e,newWaypoints:t,hints:n||{}};this._commandStack.execute("connection.updateWaypoints",i)},$o.prototype.reconnect=function(e,t,n,i,o){var r={connection:e,newSource:t,newTarget:n,dockingOrPoints:i,hints:o||{}};this._commandStack.execute("connection.reconnect",r)},$o.prototype.reconnectStart=function(e,t,n,i){i||(i={}),this.reconnect(e,t,e.target,n,(0,s.f0)(i,{docking:"source"}))},$o.prototype.reconnectEnd=function(e,t,n,i){i||(i={}),this.reconnect(e,e.source,t,n,(0,s.f0)(i,{docking:"target"}))},$o.prototype.connect=function(e,t,n,i){return this.createConnection(e,t,n||{},e.parent,i)},$o.prototype._create=function(e,t){return t instanceof Gi.XY?t:this._elementFactory.create(e,t)},$o.prototype.toggleCollapse=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.toggleCollapse",n)};var Io=n(698),Fo=n.n(Io),Wo={width:0,height:0};function zo(e,t,n,i,o){this._elementRegistry=e,this._moddle=t,this._translate=n,this._modeling=i,this._textRenderer=o}function No(e,t){return"id"in e&&e.id!==t.id}function Ho(e,t){(0,s.Ed)(t,(function(t,n){"di"!==n?e.set(n,t):e.di&&function(e,t){(0,s.Ed)(t,(function(t,n){e.set(n,t)}))}(e.di,t)}))}zo.$inject=["elementRegistry","moddle","translate","modeling","textRenderer"],zo.prototype.execute=function(e){var t=e.element,n=[t],i=this._translate;if(!t)throw new Error(i("element required"));var o=this._elementRegistry,r=this._moddle.ids,a=t.businessObject,c=function(e){var t=(0,s.f0)({},e);return Zo.forEach((function(n){n in e&&(t[n]=(0,d.S)(t[n]))})),t}(e.properties),u=e.oldProperties||function(e,t){var n=(0,s.XP)(t);return(0,s.u4)(n,(function(n,i){return n[i]="di"!==i?e.get(i):function(e,t){return(0,s.u4)(t,(function(t,n){return t[n]=e.get(n),t}),{})}(e.di,(0,s.XP)(t.di)),n}),{})}(a,c);return No(c,a)&&(r.unclaim(a.id),o.updateId(t,c.id),r.claim(c.id,a)),"default"in c&&(c.default&&n.push(o.get(c.default.id)),a.default&&n.push(o.get(a.default.id))),Ho(a,c),e.oldProperties=u,e.changed=n,n},zo.prototype.postExecute=function(e){var t=e.element.label,n=t&&(0,d.S)(t).name;if(n){var i=this._textRenderer.getExternalLabelBounds(t,n);this._modeling.resizeShape(t,i,Wo)}},zo.prototype.revert=function(e){var t=e.element,n=e.properties,i=e.oldProperties,o=t.businessObject,r=this._elementRegistry,a=this._moddle.ids;return Ho(o,i),No(n,o)&&(a.unclaim(n.id),r.updateId(t,i.id),a.claim(i.id,o)),e.changed};var Zo=["default"];function Go(e,t){this._canvas=e,this._modeling=t}function Uo(e,t){this._modeling=e,this._spaceTool=t}function Ko(e,t){this._modeling=e,this._translate=t}function Vo(e,t){this._modeling=e,this._spaceTool=t}Go.$inject=["canvas","modeling"],Go.prototype.execute=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,o=t.getRootElement(),r=o.businessObject,a=r.$parent,c=r.di;t.setRootElement(n,!0),(0,E.IH)(a.rootElements,i),i.$parent=a,(0,E.Od)(a.rootElements,r),r.$parent=null,r.di=null,c.bpmnElement=i,i.di=c,e.oldRoot=o},Go.prototype.revert=function(e){var t=this._canvas,n=e.newRoot.businessObject,i=e.oldRoot,o=i.businessObject,r=n.$parent,a=n.di;t.setRootElement(i,!0),(0,E.Od)(r.rootElements,n),n.$parent=null,(0,E.IH)(r.rootElements,o),o.$parent=r,n.di=null,a.bpmnElement=o,o.di=a},Uo.$inject=["modeling","spaceTool"],Uo.prototype.preExecute=function(e){var t=this._spaceTool,n=this._modeling,i=e.shape,o=e.location,r=A(i),a=r===i,c=a?i:i.parent;C(c).length||n.createShape({type:"bpmn:Lane"},{x:i.x+T,y:i.y,width:i.width-T,height:i.height},c);var u=[];(0,k.om)(r,(function(e){return u.push(e),e.label&&u.push(e.label),e===i?[]:(0,s.hX)(e.children,(function(e){return e!==i}))}));var l="top"===o?-120:120,p="top"===o?i.y:i.y+i.height,h=p+("top"===o?10:-10),d="top"===o?"n":"s",f=t.calculateAdjustments(u,"y",l,h);t.makeSpace(f.movingShapes,f.resizingShapes,{x:0,y:l},d,h),e.newLane=n.createShape({type:"bpmn:Lane"},{x:i.x+(a?T:0),y:p-("top"===o?120:0),width:i.width-(a?T:0),height:120},c)},Ko.$inject=["modeling","translate"],Ko.prototype.preExecute=function(e){var t=this._modeling,n=this._translate,i=e.shape,o=e.count,r=C(i),a=r.length;if(a>o)throw new Error(n("more than {count} child lanes",{count:o}));var c,s,u,l,p,h=Math.round(i.height/o);for(p=0;p<o;p++)c=i.y+p*h,s=p===o-1?i.height-h*p:h,u={x:i.x+T,y:c,width:i.width-T,height:s},p<a?t.resizeShape(r[p],u):(l={type:"bpmn:Lane"},t.createShape(l,u,i))},Vo.$inject=["modeling","spaceTool"],Vo.prototype.preExecute=function(e){var t=e.shape,n=e.newBounds;!1!==e.balanced?this.resizeBalanced(t,n):this.resizeSpace(t,n)},Vo.prototype.resizeBalanced=function(e,t){var n=this._modeling,i=function(e,t){var n=A(e),i=D(n,(0,d.is)(n,"bpmn:Process")?[]:[n]),o=(0,r.JA)(e),a=(0,r.JA)(t),c=function(e,t){return R((0,r.JA)(t),(0,r.JA)(e))}(e,t),s=[];return i.forEach((function(t){if(t!==e){var n,i,u=0,l=c.right,p=0,h=c.left,d=(0,r.JA)(t);c.top&&(M(d.bottom-o.top)<10&&(p=a.top-d.bottom),M(d.top-o.top)<5&&(u=a.top-d.top)),c.bottom&&(M(d.top-o.bottom)<10&&(u=a.bottom-d.top),M(d.bottom-o.bottom)<5&&(p=a.bottom-d.bottom)),(u||l||p||h)&&s.push({shape:t,newBounds:(n=t,i={top:u,right:l,bottom:p,left:h},{x:n.x+(i.left||0),y:n.y+(i.top||0),width:n.width-(i.left||0)+(i.right||0),height:n.height-(i.top||0)+(i.bottom||0)})})}})),s}(e,t);n.resizeShape(e,t),i.forEach((function(e){n.resizeShape(e.shape,e.newBounds)}))},Vo.prototype.resizeSpace=function(e,t){var n,i,o,a,c,s=this._spaceTool,u=(0,r.JA)(e),l=R((0,r.JA)(t),u),p=A(e),h=[],f=[];(0,k.om)(p,(function(e){return h.push(e),((0,d.is)(e,"bpmn:Lane")||(0,d.is)(e,"bpmn:Participant"))&&f.push(e),e.children})),(l.bottom||l.top)&&(n=l.bottom||l.top,i=e.y+(l.bottom?e.height:0)+(l.bottom?-10:10),o=l.bottom?"s":"n",a=l.top>0||l.bottom<0?-n:n,c=s.calculateAdjustments(h,"y",a,i),s.makeSpace(c.movingShapes,c.resizingShapes,{x:0,y:n},o)),(l.left||l.right)&&(n=l.right||l.left,i=e.x+(l.right?e.width:0)+(l.right?-10:100),o=l.right?"e":"w",a=l.left>0||l.right<0?-n:n,c=s.calculateAdjustments(f,"x",a,i),s.makeSpace(c.movingShapes,c.resizingShapes,{x:n,y:0},o))};var qo="flowNodeRef",Yo="lanes";function Jo(e){this._elementRegistry=e}function Xo(e){this._moddle=e}Jo.$inject=["elementRegistry"],Jo.prototype.computeUpdates=function(e,t){var n=[],i=[],o={},a=[];function c(e){-1===n.indexOf(e)&&(a.push(e),n.push(e))}return t.forEach((function(e){var t=A(e);t&&-1===n.indexOf(t)&&(t.children.filter((function(e){return(0,d.is)(e,"bpmn:FlowNode")})).forEach(c),n.push(t))})),e.forEach(c),a.forEach((function(e){var t=e.businessObject,n=t.get(Yo).slice(),a=function(e){return e.parent?function(e){var t=A(e);return o[t.id]||(o[t.id]=D(t)),o[t.id]}(e).filter((function(t){return n=e,i=t,o=(0,r.JA)(i),a=n.x+n.width/2,c=n.y+n.height/2,a>o.left&&a<o.right&&c>o.top&&c<o.bottom;var n,i,o,a,c})).map((function(e){return e.businessObject})):[]}(e);i.push({flowNode:t,remove:n,add:a})})),t.forEach((function(e){var t=e.businessObject;e.parent||t.get(qo).forEach((function(e){i.push({flowNode:e,remove:[t],add:[]})}))})),i},Jo.prototype.execute=function(e){var t=e.updates;t||(t=e.updates=this.computeUpdates(e.flowNodeShapes,e.laneShapes)),t.forEach((function(e){var t=e.flowNode,n=t.get(Yo);e.remove.forEach((function(e){(0,E.Od)(n,e),(0,E.Od)(e.get(qo),t)})),e.add.forEach((function(e){(0,E.IH)(n,e),(0,E.IH)(e.get(qo),t)}))}))},Jo.prototype.revert=function(e){e.updates.forEach((function(e){var t=e.flowNode,n=t.get(Yo);e.add.forEach((function(e){(0,E.Od)(n,e),(0,E.Od)(e.get(qo),t)})),e.remove.forEach((function(e){(0,E.IH)(n,e),(0,E.IH)(e.get(qo),t)}))}))},Xo.$inject=["moddle"],Xo.prototype.execute=function(e){var t=this._moddle.ids,n=e.id,i=e.element;e.claiming?t.claim(n,i):t.unclaim(n)},Xo.prototype.revert=function(e){var t=this._moddle.ids,n=e.id,i=e.element;e.claiming?t.unclaim(n):t.claim(n,i)};var Qo={fill:void 0,stroke:void 0};function er(e){this._commandStack=e,this._normalizeColor=function(e){if(e){if((0,s.HD)(e)){var t=function(e){var t=document.createElement("canvas").getContext("2d");return t.fillStyle="transparent",t.fillStyle=e,/^#[0-9a-fA-F]{6}$/.test(t.fillStyle)?t.fillStyle:null}(e);if(t)return t}throw new Error("invalid color value: "+e)}}}er.$inject=["commandStack"],er.prototype.postExecute=function(e){var t=e.elements,n=e.colors||Qo,i=this,o={};"fill"in n&&(0,s.f0)(o,{"background-color":this._normalizeColor(n.fill)}),"stroke"in n&&(0,s.f0)(o,{"border-color":this._normalizeColor(n.stroke)}),(0,s.Ed)(t,(function(e){var t=function(e){return!!e.waypoints}(e)?(0,s.ei)(o,["border-color"]):o;!function(e){"border-color"in e&&(e.stroke=e["border-color"]),"background-color"in e&&(e.fill=e["background-color"])}(t),i._commandStack.execute("element.updateProperties",{element:e,properties:{di:t}})}))};var tr={width:0,height:0};function nr(e,t){function n(e,t){var n=e.label||e,i=e.labelTarget||e;return(0,he.l)(n,t,i!==n),[n,i]}this.preExecute=function(t){var n=t.element,i=n.businessObject,o=t.newLabel;if(!(0,c.j_)(n)&&(0,c.ly)(n)&&!(0,c.fF)(n)&&!ir(o)){var r=(0,c.qe)(n);r={x:r.x,y:r.y+7},e.createLabel(n,r,{id:i.id+"_label",businessObject:i})}},this.execute=function(e){return e.oldLabel=(0,he.i)(e.element),n(e.element,e.newLabel)},this.revert=function(e){return n(e.element,e.oldLabel)},this.postExecute=function(n){var i=n.element,o=i.label||i,r=n.newLabel,a=n.newBounds,s=n.hints||{};if((0,c.j_)(o)||(0,d.is)(o,"bpmn:TextAnnotation"))if((0,c.j_)(o)&&ir(r))!1!==s.removeShape&&e.removeShape(o,{unsetLabel:!1});else{var u=(0,he.i)(o);void 0===a&&(a=t.getExternalLabelBounds(o,u)),a&&e.resizeShape(o,a,tr)}}}function ir(e){return!e||!e.trim()}function or(e,t,n,i){$o.call(this,e,t,n),this._bpmnRules=i}function rr(){}nr.$inject=["modeling","textRenderer"],o()(or,$o),or.$inject=["eventBus","elementFactory","commandStack","bpmnRules"],or.prototype.getHandlers=function(){var e=$o.prototype.getHandlers.call(this);return e["element.updateModdleProperties"]=Fo(),e["element.updateProperties"]=zo,e["canvas.updateRoot"]=Go,e["lane.add"]=Uo,e["lane.resize"]=Vo,e["lane.split"]=Ko,e["lane.updateRefs"]=Jo,e["id.updateClaim"]=Xo,e["element.setColor"]=er,e["element.updateLabel"]=nr,e},or.prototype.updateLabel=function(e,t,n,i){this._commandStack.execute("element.updateLabel",{element:e,newLabel:t,newBounds:n,hints:i||{}})},or.prototype.connect=function(e,t,n,i){var o=this._bpmnRules;if(n||(n=o.canConnect(e,t)),n)return this.createConnection(e,t,n,e.parent,i)},or.prototype.updateModdleProperties=function(e,t,n){this._commandStack.execute("element.updateModdleProperties",{element:e,moddleElement:t,properties:n})},or.prototype.updateProperties=function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:t})},or.prototype.resizeLane=function(e,t,n){this._commandStack.execute("lane.resize",{shape:e,newBounds:t,balanced:n})},or.prototype.addLane=function(e,t){var n={shape:e,location:t};return this._commandStack.execute("lane.add",n),n.newLane},or.prototype.splitLane=function(e,t){this._commandStack.execute("lane.split",{shape:e,count:t})},or.prototype.makeCollaboration=function(){var e=this._create("root",{type:"bpmn:Collaboration"}),t={newRoot:e};return this._commandStack.execute("canvas.updateRoot",t),e},or.prototype.updateLaneRefs=function(e,t){this._commandStack.execute("lane.updateRefs",{flowNodeShapes:e,laneShapes:t})},or.prototype.makeProcess=function(){var e={newRoot:this._create("root",{type:"bpmn:Process"})};this._commandStack.execute("canvas.updateRoot",e)},or.prototype.claimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t,claiming:!0})},or.prototype.unclaimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t})},or.prototype.setColor=function(e,t){e.length||(e=[e]),this._commandStack.execute("element.setColor",{elements:e,colors:t})},rr.prototype.layoutConnection=function(e,t){return[(t=t||{}).connectionStart||(0,r.wS)(t.source||e.source),t.connectionEnd||(0,r.wS)(t.target||e.target)]};var ar=Math.round,cr={"h:h":20,"v:v":20,"h:v":-10,"v:h":-10};function sr(e,t,n){var i,o,a,c=(0,r.T8)(t,e,5),s=n.split(":")[0],u=ar((t.x-e.x)/2+e.x),l=ar((t.y-e.y)/2+e.y),p=(a=c,{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/left|right/,v:/top|bottom/}[s].test(a)),h=/h|r|l/.test(s),d=!1;return p?(i=h?{x:u,y:e.y}:{x:e.x,y:l},o=h?"h:h":"v:v"):(o=h?"h:v":"v:h",function(e,t){return!{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/./,v:/./}[t].test(e)}(c,s)?h?(d=l===e.y,i={x:e.x+20*(/l/.test(s)?-1:1),y:d?l+20:l}):i={x:(d=u===e.x)?u+20:u,y:e.y+20*(/t/.test(s)?-1:1)}:i={x:u,y:l}),{waypoints:lr(e,i,o).concat(i),directions:o,turnNextDirections:d}}function ur(e){return e.split(":").reverse().join(":")}function lr(e,t,n){if(!function(e){return e&&/^h|v|t|r|b|l:h|v|t|r|b|l$/.test(e)}(n=n||"h:h"))throw new Error("unknown directions: <"+n+">: must be specified as <start>:<end> with start/end in { h,v,t,r,b,l }");if(fr(n)){var i=function(e,t,n){return sr(e,t,n)}(e,t,n),o=function(e,t,n){var i=sr(t,e,ur(n));return{waypoints:i.waypoints.slice().reverse(),directions:ur(i.directions),turnNextDirections:i.turnNextDirections}}(e,t,n),r=function(e,t){var n=e.directions.split(":")[1],i=t.directions.split(":")[0];e.turnNextDirections&&(n="h"==n?"v":"h"),t.turnNextDirections&&(i="h"==i?"v":"h");var o=n+":"+i;return{waypoints:lr(e.waypoints[e.waypoints.length-1],t.waypoints[0],o),directions:o}}(i,o);return[].concat(i.waypoints,r.waypoints,o.waypoints)}return function(e,t,n){var i=ar((t.x-e.x)/2+e.x),o=ar((t.y-e.y)/2+e.y);if("h:v"===n)return[{x:t.x,y:e.y}];if("v:h"===n)return[{x:e.x,y:t.y}];if("h:h"===n)return[{x:i,y:e.y},{x:i,y:t.y}];if("v:v"===n)return[{x:e.x,y:o},{x:t.x,y:o}];throw new Error("invalid directions: can only handle varians of [hv]:[hv]")}(e,t,n)}function pr(e,t,n,i,o,a){var c;return(0,s.kJ)(n)&&(o=n,a=i,n=(0,r.wS)(e),i=(0,r.wS)(t)),o=o||[],(c=-1!==(a=(0,s.f0)({preferredLayouts:[]},a)).preferredLayouts.indexOf("straight")&&function(e,t,n,i,o){var a,c,s={};return c=(0,r.T8)(e,t),/^(top|bottom|left|right)$/.test(c)?(/top|bottom/.test(c)&&(a="x"),/left|right/.test(c)&&(a="y"),"target"===o.preserveDocking?hr(a,i,e)?(s[a]=i[a],[{x:void 0!==s.x?s.x:n.x,y:void 0!==s.y?s.y:n.y,original:{x:void 0!==s.x?s.x:n.x,y:void 0!==s.y?s.y:n.y}},{x:i.x,y:i.y}]):null:hr(a,n,t)?(s[a]=n[a],[{x:n.x,y:n.y},{x:void 0!==s.x?s.x:i.x,y:void 0!==s.y?s.y:i.y,original:{x:void 0!==s.x?s.x:i.x,y:void 0!==s.y?s.y:i.y}}]):null):null}(e,t,n,i,a))||(c=a.connectionEnd&&function(e,t,n,i){var o=i.slice().reverse();return(o=dr(e,t,n,o))?o.reverse():null}(t,e,i,o))?c:(c=a.connectionStart&&dr(e,t,n,o))||(!a.connectionStart&&!a.connectionEnd&&o&&o.length?o:function(e,t,n,i,o){var a=o&&o.preferredLayouts||[],c=(0,s.zu)(a,"straight")[0]||"h:h",u=cr[c]||0,l=(0,r.T8)(e,t,u),p=function(e,t){if(fr(t))return t;switch(e){case"intersect":return"t:t";case"top":case"bottom":return"v:v";case"left":case"right":return"h:h";default:return t}}(l,c);n=n||(0,r.wS)(e),i=i||(0,r.wS)(t);var h=p.split(":");return function(e,t,n){var i=lr(e,t,n);return i.unshift(e),i.push(t),vr(i)}(mr(n,e,h[0],function(e){return{top:"bottom",bottom:"top",left:"right",right:"left","top-left":"bottom-right","bottom-right":"top-left","top-right":"bottom-left","bottom-left":"top-right"}[e]}(l)),mr(i,t,h[1],l),p)}(e,t,n,i,a))}function hr(e,t,n){return function(e,t,n){return e>=t&&e<=n}(t[e],n[e],n[e]+n[{x:"width",y:"height"}[e]])}function dr(e,t,n,i){if(function(e){return e.length<3||!(e.length>4)&&!!(0,s.sE)(e,(function(t,n){var i=e[n-1];return i&&(0,q.tW)(t,i)<3}))}(i))return null;var o,r=i[0],a=i.slice();return a[0]=n,a[1]=function(e,t,n){switch((0,q.Or)(t,e)){case"v":return{x:n.x,y:e.y};case"h":return{x:e.x,y:n.y}}return{x:e.x,y:e.y}}(a[1],r,n),(o=function(e,t,n){var i;for(i=e.length-2;0!==i;i--)if((0,q.qr)(e[i],t,20)||(0,q.qr)(e[i],n,20))return e.slice(i);return e}(a,e,t))!==a&&(a=dr(e,t,n,o)),a&&(0,q.Or)(a)?null:a}function fr(e){return e&&/t|r|b|l/.test(e)}function mr(e,t,n,i){if("h"===n&&(n=/left/.test(i)?"l":"r"),"v"===n&&(n=/top/.test(i)?"t":"b"),"t"===n)return{original:e,x:e.x,y:t.y};if("r"===n)return{original:e,x:t.x+t.width,y:e.y};if("b"===n)return{original:e,x:e.x,y:t.y+t.height};if("l"===n)return{original:e,x:t.x,y:e.y};throw new Error("unexpected dockingDirection: <"+n+">")}function vr(e){return e.reduce((function(t,n,i){var o=t[t.length-1],r=e[i+1];return(0,q.ZS)(o,r,n,0)||t.push(n),t}),[])}var yr={top:"bottom","top-right":"bottom-left","top-left":"bottom-right",right:"left",bottom:"top","bottom-right":"top-left","bottom-left":"top-right",left:"right"},gr={top:"t",right:"r",bottom:"b",left:"l"};function xr(){}function br(e,t){return(0,d.is)(t,"bpmn:Participant")?"source":(0,d.is)(e,"bpmn:Participant")?"target":Sr(t)?"source":Sr(e)||(0,d.is)(t,"bpmn:Event")?"target":(0,d.is)(e,"bpmn:Event")?"source":null}function Er(e){return Sr(e)?"target":"source"}function wr(e,t){return e?e.original||e:(0,r.wS)(t)}function _r(e,t){return(0,d.is)(t,"bpmn:Activity")&&(0,d.is)(e,"bpmn:BoundaryEvent")&&t.businessObject.isForCompensation}function Sr(e){return(0,d.is)(e,"bpmn:SubProcess")&&(0,w.ul)(e)}function kr(e,t){return e===t}function Rr(e){var t=/right|left/.exec(e);return t&&t[0]}function jr(e){var t=/top|bottom/.exec(e);return t&&t[0]}function Pr(e){return"right"===e||"left"===e}function Mr(e,t){var n=t.waypoints,i=n&&n.length&&(0,r.T8)(n[0],e);return"top"===i?["t:r"]:"right"===i?["r:b"]:"left"===i?["l:t"]:["b:l"]}function Br(e,t,n){var i,o,a=(0,r.wS)(e),c=(0,r.wS)(t),s=(o=(i=e).host,(0,r.T8)((0,r.wS)(i),o,-10)),u=kr(e.host,t),l=-1!==["top","right","bottom","left"].indexOf(s),p=(0,r.T8)(c,a,{x:e.width/2+t.width/2,y:e.height/2+t.height/2});return u?function(e,t,n,i,o){var r=t?e:jr(e);return[gr[r]+":"+(t?Pr(e)?Tr("y",n,i,o)?"h":"b":Tr("x",n,i,o)?"v":"l":"v")]}(s,l,e,t,n):[function(e,t,n){return n?gr[e]:kr(jr(e),jr(t))||(i=Rr(e),o=Rr(t),yr[i]===o)?gr[jr(e)]:gr[Rr(e)];var i,o}(s,p,l)+":"+function(e,t,n){return n?Pr(e)?(i=t,o=Rr(e),r=yr[o],-1!==i.indexOf(r)||kr(e,t)?"h":"v"):function(e,t){var n=jr(e),i=yr[n];return-1!==t.indexOf(i)}(e,t)||kr(e,t)?"v":"h":Pr(t)||kr(jr(e),jr(t))&&Rr(t)?"h":"v";var i,o,r}(s,p,l)]}function Tr(e,t,n,i){return!(Dr(e,i,n,40)||Dr(e,i,{x:n.x+n.width,y:n.y+n.height},40)||Dr(e,i,(0,r.wS)(t),40))}function Dr(e,t,n,i){return Math.abs(t[e]-n[e])<i}function Cr(e){return(0,s.f0)({original:e.point.original||e.point},e.actual)}function Ar(e,t){this._elementRegistry=e,this._graphicsFactory=t}o()(xr,rr),xr.prototype.layoutConnection=function(e,t){t||(t={});var n,i,o=t.source||e.source,r=t.target||e.target,a=t.waypoints||e.waypoints,c=t.connectionStart,u=t.connectionEnd;return c||(c=wr(a&&a[0],o)),u||(u=wr(a&&a[a.length-1],r)),((0,d.is)(e,"bpmn:Association")||(0,d.is)(e,"bpmn:DataAssociation"))&&a&&!_r(o,r)?[].concat([c],a.slice(1,-1),[u]):((0,d.is)(e,"bpmn:MessageFlow")?n=function(e,t){return{preferredLayouts:["straight","v:v"],preserveDocking:br(e,t)}}(o,r):((0,d.is)(e,"bpmn:SequenceFlow")||_r(o,r))&&(n=o===r?{preferredLayouts:Mr(o,e)}:(0,d.is)(o,"bpmn:BoundaryEvent")?{preferredLayouts:Br(o,r,u)}:Sr(o)||Sr(r)?function(e){return{preferredLayouts:["straight","h:h"],preserveDocking:Er(e)}}(o):(0,d.is)(o,"bpmn:Gateway")?{preferredLayouts:["v:h"]}:(0,d.is)(r,"bpmn:Gateway")?{preferredLayouts:["h:v"]}:{preferredLayouts:["h:h"]}),n&&(i=vr(pr(o,r,c,u,a,n=(0,s.f0)(n,t)))),i||[c,u])},Ar.$inject=["elementRegistry","graphicsFactory"],Ar.prototype.getCroppedWaypoints=function(e,t,n){t=t||e.source,n=n||e.target;var i=this.getDockingPoint(e,t,!0),o=this.getDockingPoint(e,n),r=e.waypoints.slice(i.idx+1,o.idx);return r.unshift(Cr(i)),r.push(Cr(o)),r},Ar.prototype.getDockingPoint=function(e,t,n){var i,o,r=e.waypoints;return{point:o=r[i=n?0:r.length-1],actual:this._getIntersection(t,e,n)||o,idx:i}},Ar.prototype._getIntersection=function(e,t,n){var i=this._getShapePath(e),o=this._getConnectionPath(t);return(0,r.Hz)(i,o,n)},Ar.prototype._getConnectionPath=function(e){return this._graphicsFactory.getConnectionPath(e)},Ar.prototype._getShapePath=function(e){return this._graphicsFactory.getShapePath(e)},Ar.prototype._getGfx=function(e){return this._elementRegistry.getGraphics(e)};const Or={__init__:["modeling","bpmnUpdater"],__depends__:[xt,tn,rn,un,li,hi,di.Z,yi,Ei,vn.Z,_i,Hi],bpmnFactory:["type",Zi],bpmnUpdater:["type",Ui],elementFactory:["type",qi],modeling:["type",or],layouter:["type",xr],connectionDocking:["type",Ar]}},517:(e,t,n)=>{n.d(t,{ul:()=>r,yU:()=>a,J5:()=>c,JG:()=>s,sm:()=>u,wQ:()=>l,_Z:()=>p});var i=n(252),o=n(670);function r(e){return!(0,i.is)(e,"bpmn:CallActivity")&&((0,i.is)(e,"bpmn:SubProcess")?(0,i.S)(e).di&&!!(0,i.S)(e).di.isExpanded:!(0,i.is)(e,"bpmn:Participant")||!!(0,i.S)(e).processRef)}function a(e){return e&&!1!==(0,i.S)(e).isInterrupting}function c(e){return e&&!!(0,i.S)(e).triggeredByEvent}function s(e,t){var n=(0,i.S)(e),r=!1;return n.eventDefinitions&&(0,o.Ed)(n.eventDefinitions,(function(e){(0,i.is)(e,t)&&(r=!0)})),r}function u(e){return s(e,"bpmn:ErrorEventDefinition")}function l(e){return s(e,"bpmn:EscalationEventDefinition")}function p(e){return s(e,"bpmn:CompensateEventDefinition")}},507:(e,t,n)=>{n.d(t,{DN:()=>r,ly:()=>a,fF:()=>c,qe:()=>s,lq:()=>u,j_:()=>l});var i=n(670),o=n(252),r={width:90,height:20};function a(e){return(0,o.is)(e,"bpmn:Event")||(0,o.is)(e,"bpmn:Gateway")||(0,o.is)(e,"bpmn:DataStoreReference")||(0,o.is)(e,"bpmn:DataObjectReference")||(0,o.is)(e,"bpmn:DataInput")||(0,o.is)(e,"bpmn:DataOutput")||(0,o.is)(e,"bpmn:SequenceFlow")||(0,o.is)(e,"bpmn:MessageFlow")||(0,o.is)(e,"bpmn:Group")}function c(e){return l(e.label)}function s(e){return e.waypoints?(t=e.waypoints,n=t.length/2-1,i=t[Math.floor(n)],a=t[Math.ceil(n+.01)],c=function(e){var t=e.length/2-1,n=e[Math.floor(t)],i=e[Math.ceil(t+.01)];return{x:n.x+(i.x-n.x)/2,y:n.y+(i.y-n.y)/2}}(t),s=Math.atan((a.y-i.y)/(a.x-i.x)),u=c.x,l=c.y,Math.abs(s)<Math.PI/2?l-=15:u+=15,{x:u,y:l}):(0,o.is)(e,"bpmn:Group")?{x:e.x+e.width/2,y:e.y+r.height/2}:{x:e.x+e.width/2,y:e.y+e.height+r.height/2};var t,n,i,a,c,s,u,l}function u(e,t){var n,o,a,c=e.di.label;return c&&c.bounds?(a=c.bounds,o={width:Math.max(r.width,a.width),height:a.height},n={x:a.x+a.width/2,y:a.y+a.height/2}):(n=s(t),o=r),(0,i.f0)({x:n.x-o.width/2,y:n.y-o.height/2},o)}function l(e){return e&&!!e.labelTarget}},252:(e,t,n)=>{function i(e,t){var n=o(e);return n&&"function"==typeof n.$instanceOf&&n.$instanceOf(t)}function o(e){return e&&e.businessObject||e}n.d(t,{is:()=>i,S:()=>o})},411:(e,t,n)=>{n.d(t,{Z:()=>E});var i=n(670),o=n(674),r=n(157),a=n(487),c=n(230);function s(e){return!0}function u(e){return(0,r.Id)(e)||(0,r.L7)(e)}function l(e,t,n){var l=this;function p(n,i,o){var a,c;(function(e,t){return!(m[e]||r.Id)(t)})(n,i)||(o?c=t.getGraphics(o):(a=i.delegateTarget||i.target)&&(c=a,o=t.get(c)),c&&o&&!1===e.fire(n,{element:o,gfx:c,originalEvent:i})&&(i.stopPropagation(),i.preventDefault()))}var h={};function d(e){return h[e]}var f={click:"element.click",contextmenu:"element.contextmenu",dblclick:"element.dblclick",mousedown:"element.mousedown",mousemove:"element.mousemove",mouseover:"element.hover",mouseout:"element.out",mouseup:"element.mouseup"},m={"element.contextmenu":s,"element.mousedown":u,"element.mouseup":u,"element.click":u,"element.dblclick":u};function v(e,t,n,i){var r=h[n]=function(e){p(n,e)};i&&(m[n]=i),r.$delegate=o.cl.bind(e,"svg, .djs-element",t,r)}function y(e,t,n){var i=d(n);i&&o.cl.unbind(e,t,i.$delegate)}e.on("canvas.destroy",(function(e){var t;t=e.svg,(0,i.Ed)(f,(function(e,n){y(t,n,e)}))})),e.on("canvas.init",(function(e){var t;t=e.svg,(0,i.Ed)(f,(function(e,n){v(t,n,e)}))})),e.on(["shape.added","connection.added"],(function(t){var n=t.element,i=t.gfx;e.fire("interactionEvents.createHit",{element:n,gfx:i})})),e.on(["shape.changed","connection.changed"],500,(function(t){var n=t.element,i=t.gfx;e.fire("interactionEvents.updateHit",{element:n,gfx:i})})),e.on("interactionEvents.createHit",500,(function(e){var t=e.element,n=e.gfx;l.createDefaultHit(t,n)})),e.on("interactionEvents.updateHit",(function(e){var t=e.element,n=e.gfx;l.updateDefaultHit(t,n)}));var g=E("djs-hit djs-hit-stroke"),x=E("djs-hit djs-hit-click-stroke"),b={all:E("djs-hit djs-hit-all"),"click-stroke":x,stroke:g};function E(e,t){return t=(0,i.f0)({stroke:"white",strokeWidth:15},t||{}),n.cls(e,["no-fill","no-border"],t)}function w(e,t){var n=b[t];if(!n)throw new Error("invalid hit type <"+t+">");return(0,a.Lj)(e,n),e}function _(e,t){(0,a.R3)(e,t)}this.removeHits=function(e){var t=(0,o.Kt)(".djs-hit",e);(0,i.Ed)(t,a.Od)},this.createDefaultHit=function(e,t){var n,i=e.waypoints,o=e.isFrame;return i?this.createWaypointsHit(t,i):(n=o?"stroke":"all",this.createBoxHit(t,n,{width:e.width,height:e.height}))},this.createWaypointsHit=function(e,t){var n=(0,c.W5)(t);return w(n,"stroke"),_(e,n),n},this.createBoxHit=function(e,t,n){n=(0,i.f0)({x:0,y:0},n);var o=(0,a.Ue)("rect");return w(o,t),(0,a.Lj)(o,n),_(e,o),o},this.updateDefaultHit=function(e,t){var n=(0,o.IO)(".djs-hit",t);if(n)return e.waypoints?(0,c.cq)(n,e.waypoints):(0,a.Lj)(n,{width:e.width,height:e.height}),n},this.fire=p,this.triggerMouseEvent=function(e,t,n){var i=f[e];if(!i)throw new Error("unmapped DOM event name <"+e+">");return p(i,t,n)},this.mouseHandler=d,this.registerEvent=v,this.unregisterEvent=y}l.$inject=["eventBus","elementRegistry","styles"];const p={__init__:["interactionEvents"],interactionEvents:["type",l]};var h=n(490);function d(e,t,n){this.offset=6;var r=t.cls("djs-outline",["no-fill"]),c=this;function s(e,t){var n=(0,a.Ue)("rect");return(0,a.Lj)(n,(0,i.f0)({x:10,y:10,width:100,height:100},r)),(0,a.R3)(e,n),n}e.on(["shape.added","shape.changed"],500,(function(e){var t=e.element,n=e.gfx,i=(0,o.IO)(".djs-outline",n);i||(i=s(n)),c.updateShapeOutline(i,t)})),e.on(["connection.added","connection.changed"],(function(e){var t=e.element,n=e.gfx,i=(0,o.IO)(".djs-outline",n);i||(i=s(n)),c.updateConnectionOutline(i,t)}))}d.prototype.updateShapeOutline=function(e,t){(0,a.Lj)(e,{x:-this.offset,y:-this.offset,width:t.width+2*this.offset,height:t.height+2*this.offset})},d.prototype.updateConnectionOutline=function(e,t){var n=(0,h.jY)(t);(0,a.Lj)(e,{x:n.x-this.offset,y:n.y-this.offset,width:n.width+2*this.offset,height:n.height+2*this.offset})},d.$inject=["eventBus","styles","elementRegistry"];const f={__init__:["outline"],outline:["type",d]};function m(e){this._eventBus=e,this._selectedElements=[];var t=this;e.on(["shape.remove","connection.remove"],(function(e){var n=e.element;t.deselect(n)})),e.on(["diagram.clear"],(function(e){t.select(null)}))}m.$inject=["eventBus"],m.prototype.deselect=function(e){var t=this._selectedElements,n=t.indexOf(e);if(-1!==n){var i=t.slice();t.splice(n,1),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:t})}},m.prototype.get=function(){return this._selectedElements},m.prototype.isSelected=function(e){return-1!==this._selectedElements.indexOf(e)},m.prototype.select=function(e,t){var n=this._selectedElements,o=n.slice();(0,i.kJ)(e)||(e=e?[e]:[]),t?(0,i.Ed)(e,(function(e){-1===n.indexOf(e)&&n.push(e)})):this._selectedElements=n=e.slice(),this._eventBus.fire("selection.changed",{oldSelection:o,newSelection:n})};var v="hover",y="selected";function g(e,t,n,o){function r(e,n){t.addMarker(e,n)}function a(e,n){t.removeMarker(e,n)}this._multiSelectionBox=null,e.on("element.hover",(function(e){r(e.element,v)})),e.on("element.out",(function(e){a(e.element,v)})),e.on("selection.changed",(function(e){var t=e.oldSelection,n=e.newSelection;(0,i.Ed)(t,(function(e){-1===n.indexOf(e)&&a(e,y)})),(0,i.Ed)(n,(function(e){-1===t.indexOf(e)&&r(e,y)}))}))}function x(e,t,n,o){e.on("create.end",500,(function(e){var n=e.context,o=n.canExecute,r=n.elements,a=(n.hints||{}).autoSelect;if(o){if(!1===a)return;(0,i.kJ)(a)?t.select(a):t.select(r.filter(b))}})),e.on("connect.end",500,(function(e){var n=e.context,i=n.canExecute,o=n.hover;i&&o&&t.select(o)})),e.on("shape.move.end",500,(function(e){var n=e.previousSelection||[],r=o.get(e.context.shape.id);(0,i.sE)(n,(function(e){return r.id===e.id}))||t.select(r)})),e.on("element.click",(function(e){if((0,r.Id)(e)){var i=e.element;i===n.getRootElement()&&(i=null);var o=t.isSelected(i),a=t.get().length>1,c=(0,r.RJ)(e)||(0,r.Dw)(e);if(o&&a)return c?t.deselect(i):t.select(i);o?t.deselect(i):t.select(i,c)}}))}function b(e){return!e.hidden}g.$inject=["eventBus","canvas","selection","styles"],x.$inject=["eventBus","selection","canvas","elementRegistry"];const E={__init__:["selectionVisuals","selectionBehavior"],__depends__:[p,f],selection:["type",m],selectionVisuals:["type",g],selectionBehavior:["type",x]}},842:(e,t,n)=>{n.d(t,{Z:()=>u});var i=n(670),o=n(674),r=new(n(237).Z)("tt");function a(e,t){e.style.display=!1===t?"none":""}var c=".djs-tooltip";function s(e,t){var n,i;this._eventBus=e,this._canvas=t,this._ids=r,this._tooltipDefaults={show:{minZoom:.7,maxZoom:5}},this._tooltips={},this._tooltipRoot=(n=t.getContainer(),i=(0,o.H6)('<div class="djs-tooltip-container" style="position: absolute; width: 0; height: 0;" />'),n.insertBefore(i,n.firstChild),i);var a=this;o.cl.bind(this._tooltipRoot,c,"mousedown",(function(e){e.stopPropagation()})),o.cl.bind(this._tooltipRoot,c,"mouseover",(function(e){a.trigger("mouseover",e)})),o.cl.bind(this._tooltipRoot,c,"mouseout",(function(e){a.trigger("mouseout",e)})),this._init()}s.$inject=["eventBus","canvas"],s.prototype.add=function(e){if(!e.position)throw new Error("must specifiy tooltip position");if(!e.html)throw new Error("must specifiy tooltip html");var t=this._ids.next();return e=(0,i.f0)({},this._tooltipDefaults,e,{id:t}),this._addTooltip(e),e.timeout&&this.setTimeout(e),t},s.prototype.trigger=function(e,t){var n=t.delegateTarget||t.target,i=this.get((0,o.Lj)(n,"data-tooltip-id"));i&&("mouseover"===e&&i.timeout&&this.clearTimeout(i),"mouseout"===e&&i.timeout&&(i.timeout=1e3,this.setTimeout(i)))},s.prototype.get=function(e){return"string"!=typeof e&&(e=e.id),this._tooltips[e]},s.prototype.clearTimeout=function(e){if(e=this.get(e)){var t=e.removeTimer;t&&(clearTimeout(t),e.removeTimer=null)}},s.prototype.setTimeout=function(e){if(e=this.get(e)){this.clearTimeout(e);var t=this;e.removeTimer=setTimeout((function(){t.remove(e)}),e.timeout)}},s.prototype.remove=function(e){var t=this.get(e);t&&((0,o.Od)(t.html),(0,o.Od)(t.htmlContainer),delete t.htmlContainer,delete this._tooltips[t.id])},s.prototype.show=function(){a(this._tooltipRoot)},s.prototype.hide=function(){a(this._tooltipRoot,!1)},s.prototype._updateRoot=function(e){var t=e.scale||1,n=e.scale||1,i="matrix("+t+",0,0,"+n+","+-1*e.x*t+","+-1*e.y*n+")";this._tooltipRoot.style.transform=i,this._tooltipRoot.style["-ms-transform"]=i},s.prototype._addTooltip=function(e){var t,n=e.id,r=e.html,a=this._tooltipRoot;r.get&&r.constructor.prototype.jquery&&(r=r.get(0)),(0,i.HD)(r)&&(r=(0,o.H6)(r)),(t=(0,o.H6)('<div data-tooltip-id="'+n+'" class="djs-tooltip" style="position: absolute">')).appendChild(r),e.type&&(0,o.Sh)(t).add("djs-tooltip-"+e.type),e.className&&(0,o.Sh)(t).add(e.className),e.htmlContainer=t,a.appendChild(t),this._tooltips[n]=e,this._updateTooltip(e)},s.prototype._updateTooltip=function(e){var t,n,o,r=e.position;t=e.htmlContainer,n=r.x,o=r.y,(0,i.f0)(t.style,{left:n+"px",top:o+"px"})},s.prototype._updateTooltipVisibilty=function(e){(0,i.Ed)(this._tooltips,(function(t){var n=t.show,i=t.htmlContainer,o=!0;n&&((n.minZoom>e.scale||n.maxZoom<e.scale)&&(o=!1),a(i,o))}))},s.prototype._init=function(){var e=this;this._eventBus.on("canvas.viewbox.changing",(function(t){e.hide()})),this._eventBus.on("canvas.viewbox.changed",(function(t){var n;n=t.viewbox,e._updateRoot(n),e._updateTooltipVisibilty(n),e.show()}))};const u={__init__:["tooltips"],tooltips:["type",s]}},805:(e,t,n)=>{n.d(t,{Z:()=>i});const i={translate:["value",function(e,t){return t=t||{},e.replace(/{([^}]+)}/g,(function(e,n){return t[n]||"{"+n+"}"}))}]}},53:(e,t,n)=>{function i(e,t){function n(){return!1}return t=t||"element.click",e.once(t,5e3,n),function(){e.off(t,n)}}n.d(t,{N:()=>i})},422:(e,t,n)=>{n.d(t,{t8:()=>r,zN:()=>a});var i=n(674),o=/^djs-cursor-.*$/;function r(e){var t=(0,i.Sh)(document.body);t.removeMatching(o),e&&t.add("djs-cursor-"+e)}function a(){r(null)}},752:(e,t,n)=>{function i(e){e&&"function"==typeof e.stopPropagation&&e.stopPropagation()}function o(e){return e.originalEvent||e.srcEvent}function r(e,t){i(e),i(o(e))}function a(e){return e.pointers&&e.pointers.length&&(e=e.pointers[0]),e.touches&&e.touches.length&&(e=e.touches[0]),e?{x:e.clientX,y:e.clientY}:null}n.d(t,{Ku:()=>o,UW:()=>r,jt:()=>a})},237:(e,t,n)=>{function i(e){this._counter=0,this._prefix=(e?e+"-":"")+Math.floor(1e9*Math.random())+"-"}n.d(t,{Z:()=>i}),i.prototype.next=function(){return this._prefix+ ++this._counter}},157:(e,t,n)=>{n.d(t,{RJ:()=>c,Dw:()=>s,L7:()=>a,Id:()=>r});var i=n(752);function o(e,t){return((0,i.Ku)(e)||e).button===t}function r(e){return o(e,0)}function a(e){return o(e,1)}function c(e){var t=(0,i.Ku)(e)||e;return!!r(e)&&(/mac/i.test(navigator.platform)?t.metaKey:t.ctrlKey)}function s(e){var t=(0,i.Ku)(e)||e;return r(e)&&t.shiftKey}},419:(e,t,n)=>{function i(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}function o(e,t){return{x:e.x-t.x,y:e.y-t.y}}n.d(t,{b:()=>i,p:()=>o})}}]);